<objdefs appVersion="1.0.12">
   <obj.normal id="diodeDist" uuid="e71706ac-01d6-495f-8438-c5c4d04595a0">
      <license>GPL</license>
      <inlets>
         <frac32buffer name="in"/>
      </inlets>
      <outlets>
         <frac32buffer name="out"/>
      </outlets>
      <displays/>
      <params/>
      <attribs/>
      <code.declaration><![CDATA[float lutDiodeDist[256] = {
   0.0000, 0.0816, 0.1631, 0.2445, 0.3255, 0.4061, 0.4857, 0.5638, 0.6392, 
   0.7106, 0.7765, 0.8356, 0.8874, 0.9321, 0.9704, 1.0034, 1.0320, 1.0570, 
   1.0791, 1.0987, 1.1164, 1.1323, 1.1469, 1.1602, 1.1725, 1.1839, 1.1945, 
   1.2044, 1.2138, 1.2225, 1.2308, 1.2387, 1.2461, 1.2532, 1.2600, 1.2664, 
   1.2726, 1.2785, 1.2842, 1.2897, 1.2950, 1.3001, 1.3050, 1.3097, 1.3143, 
   1.3187, 1.3231, 1.3272, 1.3313, 1.3352, 1.3391, 1.3428, 1.3465, 1.3500, 
   1.3535, 1.3568, 1.3601, 1.3634, 1.3665, 1.3696, 1.3726, 1.3755, 1.3784, 
   1.3813, 1.3840, 1.3867, 1.3894, 1.3920, 1.3946, 1.3971, 1.3996, 1.4020, 
   1.4044, 1.4067, 1.4090, 1.4113, 1.4135, 1.4157, 1.4179, 1.4200, 1.4221, 
   1.4242, 1.4262, 1.4282, 1.4302, 1.4321, 1.4340, 1.4359, 1.4378, 1.4396, 
   1.4414, 1.4432, 1.4450, 1.4468, 1.4485, 1.4502, 1.4519, 1.4535, 1.4552, 
   1.4568, 1.4584, 1.4600, 1.4615, 1.4631, 1.4646, 1.4661, 1.4676, 1.4691, 
   1.4706, 1.4720, 1.4735, 1.4749, 1.4763, 1.4777, 1.4790, 1.4804, 1.4818, 
   1.4831, 1.4844, 1.4857, 1.4870, 1.4883, 1.4896, 1.4908, 1.4921, 1.4933, 
   1.4945, 1.4958, 1.4970, 1.4982, 1.4993, 1.5005, 1.5017, 1.5028, 1.5040, 
   1.5051, 1.5062, 1.5074, 1.5085, 1.5096, 1.5106, 1.5117, 1.5128, 1.5139, 
   1.5149, 1.5160, 1.5170, 1.5180, 1.5191, 1.5201, 1.5211, 1.5221, 1.5231, 
   1.5241, 1.5250, 1.5260, 1.5270, 1.5279, 1.5289, 1.5298, 1.5308, 1.5317, 
   1.5326, 1.5335, 1.5344, 1.5353, 1.5362, 1.5371, 1.5380, 1.5389, 1.5398, 
   1.5407, 1.5415, 1.5424, 1.5432, 1.5441, 1.5449, 1.5458, 1.5466, 1.5474, 
   1.5483, 1.5491, 1.5499, 1.5507, 1.5515, 1.5523, 1.5531, 1.5539, 1.5547, 
   1.5554, 1.5562, 1.5570, 1.5578, 1.5585, 1.5593, 1.5600, 1.5608, 1.5615, 
   1.5623, 1.5630, 1.5637, 1.5645, 1.5652, 1.5659, 1.5666, 1.5673, 1.5681, 
   1.5688, 1.5695, 1.5702, 1.5709, 1.5716, 1.5722, 1.5729, 1.5736, 1.5743, 
   1.5750, 1.5756, 1.5763, 1.5770, 1.5776, 1.5783, 1.5789, 1.5796, 1.5802, 
   1.5809, 1.5815, 1.5822, 1.5828, 1.5834, 1.5841, 1.5847, 1.5853, 1.5859, 
   1.5866, 1.5872, 1.5878, 1.5884, 1.5890, 1.5896, 1.5902, 1.5908, 1.5914, 
   1.5920, 1.5926, 1.5932, 1.5938, 1.5944, 1.5949, 1.5955, 1.5961, 1.5967, 
   1.5972, 1.5978, 1.5984, 1.5989
};

int counter;]]></code.declaration>
      <code.init><![CDATA[counter = 0;]]></code.init>
      <code.srate><![CDATA[// convert samples to corresponding voltage in the circuit
float input = (float) inlet_in / (31<<21);
bool invert;

invert = (input <= 0.0);

float index = (invert?-input:input) * 256.0; // lut maximum is 1V
if (index > 254.0)
	index = 254.0; // make sure index+1 is still a valid index in the table
int integral = trunc(index);
float fractional = index - integral;
float output = lutDiodeDist[integral] * (1.0 - fractional) + lutDiodeDist[integral+1]*fractional;
outlet_out = (invert?-output:output) * (float) (31<<21);]]></code.srate>
   </obj.normal>
</objdefs>