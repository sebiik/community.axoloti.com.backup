<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/connecting-the-lkm1638-board/1242?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jul 2023 04:24:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Connecting the LKM1638 board - Hardware - Axoloti Community</title>
    <meta name="description" content="Now that I&amp;#39;ve finished writing my book, it&amp;#39;s time for me to build some actual instruments with Axoloti. I&amp;#39;ll use this topic to document the process of connecting the LKM1638 board, so you have a starting point if you are&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="12424658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Connecting the LKM1638 board&#39;" href="1242.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/uploads/default/optimized/2X/8/876579da82dd1aca7a708a908bcb1f1cdbeecc4c_1_690x328.jpg" />
<meta property="og:image" content="http://community.axoloti.com/uploads/default/optimized/2X/8/876579da82dd1aca7a708a908bcb1f1cdbeecc4c_1_690x328.jpg" />
<meta property="og:url" content="http://community.axoloti.com/t/connecting-the-lkm1638-board/1242?page=2" />
<meta name="twitter:url" content="http://community.axoloti.com/t/connecting-the-lkm1638-board/1242?page=2" />
<meta property="og:title" content="Connecting the LKM1638 board" />
<meta name="twitter:title" content="Connecting the LKM1638 board" />
<meta property="og:description" content="Don&#39;t think that will be possible. These board use the SPI protocol for communication. On the Axoloti, this protocol is implemented using the 4 gpio I&#39;ve used here." />
<meta name="twitter:description" content="Don&#39;t think that will be possible. These board use the SPI protocol for communication. On the Axoloti, this protocol is implemented using the 4 gpio I&#39;ve used here." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="5 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="22 ‚ù§" />

      <link rel="prev" href="1242.html">

  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="1242.html">Connecting the LKM1638 board</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/hardware.html" itemprop="url">
        <span itemprop="title">Hardware</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/janvantomme.html'><b itemprop='author'>janvantomme</b></a>
           
           <time datetime='2019-01-24T13:44:25Z' itemprop='datePublished'>
             2019-01-24 13:44:25 UTC
           </time>
        </span>
        <span itemprop='position'>#21</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Don't think that will be possible. These board use the SPI protocol for communication. On the Axoloti, this protocol is implemented using the 4 gpio I've used here.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Connecting the LKM1638 board'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Mindsetup.html'><b itemprop='author'>Mindsetup</b></a>
           
           <time datetime='2019-01-24T13:49:08Z' itemprop='datePublished'>
             2019-01-24 13:49:08 UTC
           </time>
        </span>
        <span itemprop='position'>#22</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Okay, so not possible to use to of these chips. I might have to do an 8 step sequencer then. Or find some hacky way to use the 8 as 16. Or maybe its easy to just patch so i can have 16 step pattern i can browse with the 8 steps.</p>

<p>Thanks for your help. I had a year long pause from axoloti and now excited again to find some time to create something awesome.<br>Have you continued making the guide btw?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Connecting the LKM1638 board'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/AndrewChi.html'><b itemprop='author'>AndrewChi</b></a>
           
           <time datetime='2019-08-29T11:58:25Z' itemprop='datePublished'>
             2019-08-29 11:58:25 UTC
           </time>
        </span>
        <span itemprop='position'>#23</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi <a class="mention" href="../../u/aslanov.html">@aslanov</a>,<br>Thanks so much for your object and <a class="mention" href="../../u/janvantomme.html">@janvantomme</a> for the original ones.</p>

<p>I found a very simple solution for the update display problem:<br>I used a pulse/lfsburst4 object to trigger the update input and it works. No cpu spikes whatsoever!<br>I guess 'normal' triggers were too long...</p>

<p>Has anyone experienced that LED 8 is lighting up when sending update display messages?<br>My LKM board is slightly different (also very cheap and only red LEDs). I guess it's the board's design? Or could I perhaps change something in the code to change this behaviour? I'm just starting out with code so any help/insight would be really great! Thanks.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Connecting the LKM1638 board'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/AndrewChi.html'><b itemprop='author'>AndrewChi</b></a>
           
           <time datetime='2019-08-29T15:00:44Z' itemprop='datePublished'>
             2019-08-29 15:00:44 UTC
           </time>
        </span>
        <span itemprop='position'>#24</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Okay, I was a bit fast...<br>When the patch became a bit more complex it didnt work anymore with the pulse object as described above.</p>

<p>I figured out the CPU spike when updating the display was actually caused by the Sleep command in the code.<br>I commented out all chThdSleepMilliseconds in the <em>//update text</em> in the K-rate  code of the object.</p>

<p>I now use a timer/delayed pulse object to update the display to keep the update rate slow, and this seems to work, when the delay is set above 100ms.</p>

<p>Could maybe be of help for someone who is experimenting with the LKM board too.</p>

<p>Happy patching!</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Connecting the LKM1638 board'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kaos.html'><b itemprop='author'>kaos</b></a>
           
           <time datetime='2020-10-29T09:21:30Z' itemprop='datePublished'>
             2020-10-29 09:21:30 UTC
           </time>
        </span>
        <span itemprop='position'>#25</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>HI I just hooked up my LKM1638 board I had lying around to my axo. It randomly crashes, sometimes before I update the text on the display. I'm using the adaptations <a class="mention" href="../../u/andrewchi-2.html">@AndrewChi</a> suggested. </p>

<p><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/384943188571939f75ee256ec563a47c5a27f8bc" href="../../uploads/default/original/2X/3/384943188571939f75ee256ec563a47c5a27f8bc.jpg" class="lightbox" title="image.jpg"><img src="../../uploads/default/optimized/2X/3/384943188571939f75ee256ec563a47c5a27f8bc_1_375x500.jpg" width="375" height="500"><div class="meta">
<span class="filename">image.jpg</span><span class="informations">759x1012 286 KB</span><span class="expand"></span>
</div></a></div></p>

<p>I'm trying to have it display the current patchname and would love to have the buttons switch presets inside each patch.<br>I succeed sometimes in switching patch, sometimes it updates the name, sometimes not.</p>

<p>The AXO log just says </p>

<p>"Disconnect request"</p>

<p>and the axo becomes unresponsive until reset</p>

<p><img src="../../uploads/default/original/2X/9/97497fed365755703f8aceb1acfce6518633fc1d.png" width="607" height="347"></p>

<p>I tried adding various delays, pulselengths etc... all crashes.</p>

<p>Even if I do not "use" the object, but just let it sit in the patch, it crashes, also when completely unconnected.<br>When I remove the object all is fine...</p>

<p>I'm using the lkm1638_full but I've had similar problems with the other object, and in that case axo was also logging some other SPI related errors, like:</p>

<blockquote><pre><code>&gt; Error: object "spi.begin_1" attribute "clock_polarity", value "0 when idle" unmatched
&gt; Error: object "spi.begin_1" attribute "clock_phase", value "first clock transition is the first data capture edge" unmatched</code></pre></blockquote>

<p>not in the case of lkm1638_full</p>

<p>any hints?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Connecting the LKM1638 board'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kaos.html'><b itemprop='author'>kaos</b></a>
           
           <time datetime='2020-10-29T09:59:58Z' itemprop='datePublished'>
             2020-10-29 09:59:58 UTC
           </time>
        </span>
        <span itemprop='position'>#26</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>my gut feeling says the board needs a "reset" or a "clear" either before a new patch load trigger is sent or as a reset before running any of the LKM1638 object code.</p>

<p>the reason that I think it is this is that I can always run a patch the first time it loads. This is the only reproducable pattern I can find...<br>so:<br>1. reset axo (usb cable out/in) flash patch running has got nothing to do with LKM1638<br>2. load a patch setting the display using <a class="mention" href="../../u/janvantomme.html">@janvantomme</a>'s  lkm1638-display-toggle-leds<br>3. display shows nothing, is outlined above as a possible bug, the rest of the patch works fine<br>4. loading the </p>

<p><aside class="quote" data-post="14" data-topic="1242"><blockquote><p>axoloti/axoloti/blob/master/archive/tests/io/spi_lkm1638.axh</p></blockquote></aside></p>

<p>script, suddenly my text set in the previous patch pops up. This explains something is kept on the lkm1638 and transferred between patches, but it should be reset!<br>5. the patch works fine (buttons toggle LEDS, I can set them using the seq objects, but it should not display anything on the 7-segment display, yet it displays text from the first patch<br>6. load the first patch again.... no problem, I can switch back and forth between these two patches no problem at all<br>6. if I load <em>another</em> patch with different text in the  lkm1638-display-toggle-leds it crashes sometime, sometimes not... it becomes unstable...but it will crash after 2 or 3  display updates the latest</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Connecting the LKM1638 board'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/janvantomme.html'><b itemprop='author'>janvantomme</b></a>
           
           <time datetime='2020-11-05T09:40:28Z' itemprop='datePublished'>
             2020-11-05 09:40:28 UTC
           </time>
        </span>
        <span itemprop='position'>#27</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Just looked at the patches I used on my synth. I have a patch bank with a startup patch that contains the <strong>axoloti/axoloti/blob/master/archive/tests/io/spi_lkm1638.axh</strong> script object and SPI config. The patches I use for playing the synth with my objects are loaded with the <strong>patch/load i</strong> object.</p>

<p>As far as I can remember, the display object was not made to update frequently. I only use it to show the patch name when it becomes active.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Connecting the LKM1638 board'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kaos.html'><b itemprop='author'>kaos</b></a>
           
           <time datetime='2020-11-05T10:16:06Z' itemprop='datePublished'>
             2020-11-05 10:16:06 UTC
           </time>
        </span>
        <span itemprop='position'>#28</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I used the exact same strategy...You never had crashes?<br>I only update the name/display on patch load, making sure I cannot really quickly load another patch (eg. by accidentaly not debouncing my switch)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Connecting the LKM1638 board'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/janvantomme.html'><b itemprop='author'>janvantomme</b></a>
           
           <time datetime='2020-11-05T13:32:25Z' itemprop='datePublished'>
             2020-11-05 13:32:25 UTC
           </time>
        </span>
        <span itemprop='position'>#29</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>It's been a while since I've used the board. Think I did have some crashes during development, but that's was a long time ago.</p>

<p>I also have the SPI errors in the console when opening patches with my objects. Not sure how to fix those, as the firmware is not documented that well.</p>

<p>The original patch by Johannes is based on some code from a Raspberry Pi library, but don't know if it was really optimised to run on Axoloti. It was mainly a quick example on how to use SPI.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Connecting the LKM1638 board'>
      <hr>
  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement'>
      <span itemprop='url'><a rel="prev" itemprop="name" href="1242.html">‚Üê previous page</a></span>
  </div>





    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/connecting-the-lkm1638-board/1242?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jul 2023 04:24:24 GMT -->
</html>
