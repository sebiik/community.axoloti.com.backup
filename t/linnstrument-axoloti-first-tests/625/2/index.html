<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Linnstrument + Axoloti first tests - Hardware - Axoloti Community</title>
    <meta name="description" content="Just got my Axoloti board (Yeah !!) 

I just tried it with the Linnstrument and I&amp;#39;m getting a lot of clicks and issues with it.  I guess the Linnstrument&amp;#39;s data rate via Axolotl&amp;#39;s host port is too high.... Using the late&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.8.0.beta7 - https://github.com/discourse/discourse version 8cbfa24ca215fb1a598b36956ab768fa1c5412ff">
<link rel="icon" type="image/png" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="http://community.axoloti.com/t/linnstrument-axoloti-first-tests/625" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="http://community.axoloti.com/opensearch.xml" title="Axoloti Community Search">

        <link href="/stylesheets/desktop_8962493bdc6b4bdf244e8ddf502ce5153b1c6917.css?__ws=community.axoloti.com" media="all" rel="stylesheet" />
      
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Linnstrument + Axoloti first tests&#39;" href="http://community.axoloti.com/t/linnstrument-axoloti-first-tests/625.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/user_avatar/community.axoloti.com/johannes/200/8_1.png" />
<meta property="og:image" content="http://community.axoloti.com/user_avatar/community.axoloti.com/johannes/200/8_1.png" />
<meta property="og:url" content="http://community.axoloti.com/t/linnstrument-axoloti-first-tests/625/2" />
<meta name="twitter:url" content="http://community.axoloti.com/t/linnstrument-axoloti-first-tests/625/2" />
<meta property="og:title" content="Linnstrument + Axoloti first tests" />
<meta name="twitter:title" content="Linnstrument + Axoloti first tests" />
<meta property="og:description" content="What&#39;s the reported dsp load of your patch?" />
<meta name="twitter:description" content="What&#39;s the reported dsp load of your patch?" />

      <link rel="next" href="/t/linnstrument-axoloti-first-tests/625?page=2">

  </head>
  <body class="crawler">
      
    <header>
      <a href="/"><img src="/uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="/t/linnstrument-axoloti-first-tests/625">Linnstrument + Axoloti first tests</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="/c/hardware" itemprop="url">
        <span itemprop="title">Hardware</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-08T17:39:58Z' itemprop='datePublished'>
             2015-11-08 17:39:58 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Just got my Axoloti board (Yeah !!)</p>

<p>I just tried it with the Linnstrument and I'm getting a lot of clicks and issues with it.  I guess the Linnstrument's data rate via Axolotl's host port is too high....<br>Using the latest firmware of the Linnstrument I can decrease the data rate which seems to help but it's still not 100% reliable.  Any other things I could change to help out ? (I tried both MPE examples)</p>

<p>Thanks !</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/johannes'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2015-11-08T17:46:19Z' itemprop='datePublished'>
             2015-11-08 17:46:19 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>What's the reported dsp load of your patch?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-08T17:52:04Z' itemprop='datePublished'>
             2015-11-08 17:52:04 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>51%<br>I'm using the mpe/simple.axp example.<br>If I set the Linnstrument to it's default data rate, nothing seems to be sent/processed.<br>At 512ms (the highest settings) it seems to work decently.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/johannes'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2015-11-08T18:23:56Z' itemprop='datePublished'>
             2015-11-08 18:23:56 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>At 51% dsp load there should be plenty cpu time left to process incoming midi. <br>The setting you adjusted, is that this one?</p>

<pre><code>Hold MIDI I/O to view the delay time (in microseconds) that is added 
between sent MIDI bytes. Swipe left or right to change the value. 
Default is 0 (no delay). As a point of reference, a value of 300 slows 
it down to the speed of the MIDI jacks, and a value of 600 slows it down
 to half the speed of the MIDI jacks.</code></pre>

<p>This is confusing me, usb-midi does not transmit individual bytes like din midi does.</p>

<p>It is difficult to understand what is going on, I do not have a linnstrument available. Could you maybe share a video or sound recording of the clicks you're getting?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-08T20:23:06Z' itemprop='datePublished'>
             2015-11-08 20:23:06 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yup, that's the setting I'm changing.<br>Here are 2 videos, the first one is with the Strings patch and the second one is with MPE simple.  Problem seems to be either no notes, stuck notes or chords playing.<br></p><div class="lazyYT" data-youtube-id="QHXrenGAPxc" data-youtube-title="Axoloti + Linnstrument problem Strings" data-width="480" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque"></div><br><div class="lazyYT" data-youtube-id="LnLSzgjE4uE" data-youtube-title="Axoloti Linnstrument + MPE" data-width="480" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque"></div>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/johannes'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2015-11-09T16:38:20Z' itemprop='datePublished'>
             2015-11-09 16:38:20 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thanks for the video. It looks like the linnstrument is overflowing the usb-host-midi input buffer. I haven't seen midi input overflows, but I do not have access to any polyphonic expression controller. </p>

<p>It would be interesting to eliminate inefficience of the midi handling through the Axoloti USB host port: Could you record some MIDI with your computer from your linnstrument (without axoloti involved), and then play it back from your computer to Axoloti through the Axoloti USB MIDI device?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:2'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-09T18:08:11Z' itemprop='datePublished'>
             2015-11-09 18:08:11 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yes, will try this tonight and report back !</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/anon5189335'><b itemprop='author'>anon5189335</b></a>
           
           <time datetime='2015-11-09T20:43:11Z' itemprop='datePublished'>
             2015-11-09 20:43:11 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="/users/thetechnobear">@thetechnobear</a> has got an expressive instrument......... I think.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-10T03:00:40Z' itemprop='datePublished'>
             2015-11-10 03:00:40 UTC
           </time>
        </span>
        <span itemprop='position'>#9</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="/users/johannes">@johannes</a><br>I did some tests, I recorded the Linnstrument's MIDI in reaper and played it back on the Axolotl and it works fine.  I also tried piping the midi from the linnstrument to the axolotl in Max/MSP (using a midiin --&gt; midiout) and it also works without adding latency.  So it seems like the problem is specifically with the host port.<br>Let me know if I can help with more tests !</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/thetechnobear'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2015-11-10T10:20:51Z' itemprop='datePublished'>
             2015-11-10 10:20:51 UTC
           </time>
        </span>
        <span itemprop='position'>#10</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Sorry, Im taking a break from forums etc to focus more on music making <img src="/images/emoji/emoji_one/smile.png?v=0" title=":smile:" class="emoji" alt=":smile:"></p>

<p>yes, the issue will be the 'usb host firmware' , and there are a few potential places it could be failing.</p>

<p>the first step would be to use the latest version of the firmware, either by it being released by Johannes, or by compiling it from source from github. Ive made quite a few changes in it, and since its been a long time since the last release, Im a little unsure what is it 1.0.3 and what is not.<br>(EDIT: seems 1.04 is released, so you can try that first)</p>

<p>one thing it will do is give a little more info about the usb interface which possibly will hint at the issue. but you could also get this if you connected your linnstrument to linux and used 'lsusb'. In particular id need to see the interfaces it presents, and the size of the buffers.</p>

<p>my suspicion is, its down to the frequency of the data... as with the soundplane/eigenharp I came in though the usb device via the mac.</p>

<p>most likely (randomly without seeing any info) is</p>

<ul>
<li><p>the input buffer size of the linnstrument exceeds the max we allow, this is a simple define to change, but causes an issue if its too big since its statically allocated, and so reduces memory for everyone. (default 64 bytes)</p></li>
<li><p>polling, there is a minimum polling time, can't remember default off top of my head (possibly 1ms?), this may not be fast enough.</p></li>
</ul>

<p>(this is where the interface description will help diagnose the issue) </p>

<p>as such I don't think there is anything wrong with the usb host code,  just its not configured for this much and frequent data. its pretty easy to change its in usbh_midi_core.c/h</p>

<p>(the other possible issue, but I doubt is threading between the host port and the control thread, unlikely and a more tricky thing to solve especially without introducing latency and more memory overhead)</p>

<p>unfortunately, I can't connect my eigenharp or soundplane directly (and even if I could they use iso transfers and not midi... a smart move!) so can't generate the amount of data required to test the above with, so think you will have to 'give it a go'</p>

<p>hope this gives you something to go on.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:3'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-10T13:43:51Z' itemprop='datePublished'>
             2015-11-10 13:43:51 UTC
           </time>
        </span>
        <span itemprop='position'>#11</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thanks, I'll try connecting it to Linux to see the buffer sizes.<br>I'll also have a look at the Linnstrument's code (since it's  open source) to see if the buffers are defined there.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-11T04:20:19Z' itemprop='datePublished'>
             2015-11-11 04:20:19 UTC
           </time>
        </span>
        <span itemprop='position'>#12</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="/users/thetechnobear">@thetechnobear</a><br>here's the output of lsusb, let me know if I can provide more info...<br><a href="http://pastie.org/10549756" class="onebox" target="_blank" rel="nofollow">http://pastie.org/10549756</a></p>

<p>Thanks !</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-12T02:31:30Z' itemprop='datePublished'>
             2015-11-12 02:31:30 UTC
           </time>
        </span>
        <span itemprop='position'>#13</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="/users/thetechnobear">@thetechnobear</a><br>Hi Mark,</p>

<p>Just tried tonight with 1.04 and it actually seems worse than with 1.03.  With the Linnstruments at 512 microseconds I seem to get strange notes triggering, seemed better with 1.03.<br>Let me know what kind of debug I can do !<br>Thanks !</p>

<p>Edit: It seems that if I set the linnstrument to 512 then press the live button it doesn't glitch, but within the same session if I change de linnstrument's delay then it'll start glitching until I toggle the live button again.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-12T02:35:19Z' itemprop='datePublished'>
             2015-11-12 02:35:19 UTC
           </time>
        </span>
        <span itemprop='position'>#14</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Here's the output of the Axolotl window:</p>

<p></p><pre><code class="lang-auto">USB device found
connected
Authentic Axoloti Core
Axoloti says: USB Device Attached
Axoloti says: PID: 69h
Axoloti says: VID: F055h
Axoloti says: Address (#1) assigned.
Axoloti says: Manufacturer : Roger Linn Design
Axoloti says: Product : LinnStrument MIDI
Axoloti says: Serial Number : N/A
Axoloti says: Enumeration done.
Axoloti says: This device has only 1 configuration.
Axoloti says: Default configuration set.
Axoloti says: Switching to Interface (#1)
Axoloti says: Class    : 1h
Axoloti says: SubClass : 3h
Axoloti says: Protocol : 0h
Axoloti says: fakemalloc: already taken...
Axoloti says: USB Host Output size requests : 40
Axoloti says: USB Host Input size requests : 40
Axoloti says: USB Host Output connected to 1 : 1
Axoloti says: USB Host Input connected to 1 : 82
Axoloti says: MID class started.
Firmware version: 1.0.0.1, crc=0xA4AA9FE1, entrypoint=0x20011000
Generate code complete
Start compiling patch
Compiling patch... with /Applications/Axoloti.app/Contents/Java/firmware
BDIR = /Users/Nat/Documents/axoloti/build
FIRMWARE = .
RM
rm -f /Users/Nat/Documents/axoloti/build/xpatch.o /Users/Nat/Documents/axoloti/build/xpatch.elf /Users/Nat/Documents/axoloti/build/xpatch.bin /Users/Nat/Documents/axoloti/build/xpatch.d /Users/Nat/Documents/axoloti/build/xpatch.map /Users/Nat/Documents/axoloti/build/xpatch.lst
APP
arm-none-eabi-g++ -nostdlib -fno-exceptions -fno-rtti -mcpu=cortex-m4 -O3 -fomit-frame-pointer -falign-functions=16 -mfloat-abi=hard -mfpu=fpv4-sp-d16 -fsingle-precision-constant -Wunused-parameter -DCORTEX_USE_FPU=TRUE -DTHUMB_PRESENT -mno-thumb-interwork -DTHUMB_NO_INTERWORKING -mthumb -DTHUMB -std=c++11 -DARM_MATH_CM4 -D__FPU_PRESENT -H -I/Applications/Axoloti.app/Contents/Java/CMSIS/Include -I/Applications/Axoloti.app/Contents/Java/chibios/os/ports/common/ARMCMx/CMSIS/include -I/Applications/Axoloti.app/Contents/Java/chibios/os/ports/common/ARMCMx -I/Applications/Axoloti.app/Contents/Java/chibios/os/ports/GCC/ARMCMx -I/Applications/Axoloti.app/Contents/Java/chibios/os/ports/GCC/ARMCMx/STM32F4xx -I/Applications/Axoloti.app/Contents/Java/chibios/os/kernel/include -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/include -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32F4xx -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/GPIOv2 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/I2Cv1 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/OTGv1 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/RTCv2 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/SPIv1 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/TIMv1 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/USARTv1 -I/Applications/Axoloti.app/Contents/Java/chibios/boards/ST_STM32F4_DISCOVERY -I/Applications/Axoloti.app/Contents/Java/chibios/ext/fatfs/src -I. -Winvalid-pch -MD -MP --include /Users/Nat/Documents/axoloti/build/xpatch.h -c /Users/Nat/Documents/axoloti/build/xpatch.cpp -o /Users/Nat/Documents/axoloti/build/xpatch.o 
! /Users/Nat/Documents/axoloti/build/xpatch.h.gch
LINK
arm-none-eabi-gcc -nostartfiles -Tramlink.ld -mcpu=cortex-m4 -mfloat-abi=hard -mfpu=fpv4-sp-d16 -mthumb  -mno-thumb-interwork /Users/Nat/Documents/axoloti/build/xpatch.o -Wl,-Map=/Users/Nat/Documents/axoloti/build/xpatch.map,--cref,--just-symbols=./build/axoloti.elf -o /Users/Nat/Documents/axoloti/build/xpatch.elf
BIN
arm-none-eabi-objcopy -O binary /Users/Nat/Documents/axoloti/build/xpatch.elf /Users/Nat/Documents/axoloti/build/xpatch.bin
Done compiling patch
Start uploading patch
bin path: /Users/Nat/Documents/axoloti/build/xpatch.bin
block uploaded @ 0x20011000 length 12044
Done uploading patch
Start starting patch
Done starting patch
Start locking
Done locking</code></pre>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/thetechnobear'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2015-11-14T14:22:14Z' itemprop='datePublished'>
             2015-11-14 14:22:14 UTC
           </time>
        </span>
        <span itemprop='position'>#15</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>hmm, 1.03 to 1.04.. I quickly looked over changes, nothing really stood out that should make it worst, as it appears my changes were related to midi output.. not too surprising as I was stabilising the work I was doing on the Push 1 display which was causing me issues...</p>

<p>console, nothing unexpected there... correctly picked up sizes, <br>one slight oddity, is that it uses endpoints 1 and 82 , usually you would expect 1 and 81... but this is consistent with your lsusb output, so just a bit strange, and the axoloti firmware doesn't care.</p>

<p>another oddity, is you should be getting a line with host interval e.g.<br>USB Host Input interval : 0<br>the only reason this 'concerns' me, is i wonder if this means your not getting other logging.</p>

<p>anyways no matter....<br>the way to proceed is to build a new firmware....</p>

<p>you can either do this by using a github build<br>OR<br>by copying the firmware source (you will find it inside the axoloti app) to a new (writeable) directory<br>then changing the preferences to point to this directory</p>

<p>you will then find new menu options for flashing 'user firmware'<br>compile it, and check it works first...</p>

<p>then in usbh_conf.h you will find USBH_DEBUG_LEVEL, change this to 3 (from 2) <br>this will log more info.</p>

<p>In particular I think we are interested in seeing if the usb goes into a 'unusual state' that perhaps its not recovering from. <br>(it should be relatively obvious from the console when you get errors)</p>

<p>try running this, but send as little data as possible, as too much logging WILL break the connection.<br>basically the watchdog will terminate as it takes too much time to do the login. this is NOT an error condition... </p>

<p>you can comment out a few of the USBH_DbgLog lines in usbh_midi_core.c, if this proves difficult/excessive, but i think for input its ok.</p>

<p>the other thing to try<br>in usbh_midi_core.c. change MIDI_MIN_READ_POLL to 0, this will mean it will process messages every time chibios wakes it up.... Im not sure what this will do to overall performance, so initially test with a simple patch, and again initially try to not send too much data...</p>

<p>have a go with this, and see if this gives us some more info</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:3'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-14T21:11:42Z' itemprop='datePublished'>
             2015-11-14 21:11:42 UTC
           </time>
        </span>
        <span itemprop='position'>#16</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="/users/thetechnobear">@thetechnobear</a><br>I pulled the sources from Github and pointed to the firmware folder in Axoloti's preferences.  I compiled and uploaded a new firmware.<br>Whenever I try to press the live button I get this error:</p>

<p></p><pre><code class="lang-auto">Generate code complete
Start compiling patch
Compiling patch... with /Users/Nat/Source/axoloti/firmware
BDIR = /Users/Nat/Documents/axoloti/build
FIRMWARE = .
RM
rm -f /Users/Nat/Documents/axoloti/build/xpatch.o /Users/Nat/Documents/axoloti/build/xpatch.elf /Users/Nat/Documents/axoloti/build/xpatch.bin /Users/Nat/Documents/axoloti/build/xpatch.d /Users/Nat/Documents/axoloti/build/xpatch.map /Users/Nat/Documents/axoloti/build/xpatch.lst
APP
arm-none-eabi-g++ -nostdlib -fno-exceptions -fno-rtti -mcpu=cortex-m4 -O3 -fomit-frame-pointer -falign-functions=16 -mfloat-abi=hard -mfpu=fpv4-sp-d16 -fsingle-precision-constant -Wunused-parameter -DCORTEX_USE_FPU=TRUE -DTHUMB_PRESENT -mno-thumb-interwork -DTHUMB_NO_INTERWORKING -mthumb -DTHUMB -std=c++11 -DARM_MATH_CM4 -D__FPU_PRESENT -H -I/Applications/Axoloti.app/Contents/Java/CMSIS/Include -I/Applications/Axoloti.app/Contents/Java/chibios/os/ports/common/ARMCMx/CMSIS/include -I/Applications/Axoloti.app/Contents/Java/chibios/os/ports/common/ARMCMx -I/Applications/Axoloti.app/Contents/Java/chibios/os/ports/GCC/ARMCMx -I/Applications/Axoloti.app/Contents/Java/chibios/os/ports/GCC/ARMCMx/STM32F4xx -I/Applications/Axoloti.app/Contents/Java/chibios/os/kernel/include -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/include -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32F4xx -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/GPIOv2 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/I2Cv1 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/OTGv1 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/RTCv2 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/SPIv1 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/TIMv1 -I/Applications/Axoloti.app/Contents/Java/chibios/os/hal/platforms/STM32/USARTv1 -I/Applications/Axoloti.app/Contents/Java/chibios/boards/ST_STM32F4_DISCOVERY -I/Applications/Axoloti.app/Contents/Java/chibios/ext/fatfs/src -I. -I/Applications/Axoloti.app/Contents/Java/chibios -Winvalid-pch -MD -MP --include /Users/Nat/Documents/axoloti/build/xpatch.h -c /Users/Nat/Documents/axoloti/build/xpatch.cpp -o /Users/Nat/Documents/axoloti/build/xpatch.o 
! /Users/Nat/Documents/axoloti/build/xpatch.h.gch
/Users/Nat/Documents/axoloti/build/xpatch.cpp: In member function 'void rootc::instancesimple__v__1::Init(rootc*)':
/Users/Nat/Documents/axoloti/build/xpatch.cpp:862:32: error: 'struct PExModulationTarget_t' has no member named 'PEx'
     PExModulationSources[i][j].PEx = 0;
                                ^
/Users/Nat/Documents/axoloti/build/xpatch.cpp: In member function 'void rootc::Init()':
/Users/Nat/Documents/axoloti/build/xpatch.cpp:1392:32: error: 'struct PExModulationTarget_t' has no member named 'PEx'
     PExModulationSources[i][j].PEx = 0;
                                ^
make: *** [/Users/Nat/Documents/axoloti/build/xpatch.bin] Error 1
shell task failed, exit value: 2
Compiling patch failed ( /Applications/Axoloti.app/Contents/Java/patches/demos/synth/mpe/simple.axp )</code></pre>

<p>Any ideas ?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:2'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-14T21:25:04Z' itemprop='datePublished'>
             2015-11-14 21:25:04 UTC
           </time>
        </span>
        <span itemprop='position'>#17</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>(In the meantime I tried the same thing by copying the firmware from the 1.04 release and it doesn't do the error, I assume the error comes from the fact some files are newer on github...)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/johannes'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2015-11-14T21:32:21Z' itemprop='datePublished'>
             2015-11-14 21:32:21 UTC
           </time>
        </span>
        <span itemprop='position'>#18</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>If you use code from git, use both the GUI and firmware. The error you are seeing is the result of a change in the interface between gui and firmware.</p>

<aside class="quote" data-post="15" data-topic="625"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/user_avatar/community.axoloti.com/thetechnobear/40/6_1.png" class="avatar">thetechnobear:</div>
<blockquote><p>one slight oddity, is that it uses endpoints 1 and 82 , usually you would expect 1 and 81... but this is consistent with your lsusb output, so just a bit strange, and the axoloti firmware doesn't care.</p></blockquote></aside>

<p>But it may generate an IRQ storm.<br>I do recall needing to modify the ST USB host code long time ago, because it was causing an IRQ storm out of the box, resulting in choppy audio performance. <br>But this is just a wild guess.</p>

<p>Polling time may be relevant. But I'd hope Linnstrument to accumulate multiple midi commands into one transaction if it isn't polled as frequently as it requested. </p>

<p>Logging USB with a USB analyzer between Linnstrument and axoloti would reveal a lot, but I have no Linnstrument...</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/natcl'><b itemprop='author'>natcl</b></a>
           
           <time datetime='2015-11-14T21:40:40Z' itemprop='datePublished'>
             2015-11-14 21:40:40 UTC
           </time>
        </span>
        <span itemprop='position'>#19</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="15" data-topic="625"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/user_avatar/community.axoloti.com/thetechnobear/40/6_1.png" class="avatar">thetechnobear:</div>
<blockquote><p>then in usbh_conf.h you will find USBH_DEBUG_LEVEL, change this to 3 (from 2) this will log more info.</p></blockquote></aside>

<p>Here's the result of the output with more debugging.  This is at Linnstrument's default setting of 0 microseconds between each message.  I tapped a pad quickly 3 times:<br><a href="http://pastie.org/10557257" class="onebox" target="_blank" rel="nofollow">http://pastie.org/10557257</a></p>

<p>No sound was audible from Axoloti.</p>

<p>Here's the same test at 512 microseconds with 3 taps on the same pad:</p>

<p><a href="http://pastie.org/10557259" class="onebox" target="_blank" rel="nofollow">http://pastie.org/10557259</a></p>

<p>This time sound can be heard from axoloti.</p>

<p>I also tried changing <br></p>

<p></p><pre><code class="lang-auto">#define MIDI_MIN_POLL 3</code></pre>

<p>to<br></p>

<p></p><pre><code class="lang-auto">#define MIDI_MIN_POLL 0</code></pre>

<p>But I can't seem to see any difference.</p>

<p>Let me know if this can help, otherwise I'll be glad to run more complicated tests...</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/users/Rimwolf'><b itemprop='author'>Rimwolf</b></a>
           
           <time datetime='2015-12-05T18:49:24Z' itemprop='datePublished'>
             2015-12-05 18:49:24 UTC
           </time>
        </span>
        <span itemprop='position'>#20</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Has there been any progress on this issue? I have a LinnStrument and a couple of Axoloti boards, and I would love to be able to use them together.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Linnstrument + Axoloti first tests'>
      <hr>
  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement'>
      <span itemprop='url'><b><a rel="next" itemprop="name" href="/t/linnstrument-axoloti-first-tests/625?page=2">next page â†’</a></b></span>
  </div>





    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='/'>Home</a>
        <a href="/categories">Categories</a>
        <a href="/guidelines">FAQ/Guidelines</a>
        <a href="/tos">Terms of Service</a>
        <a href="/privacy">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="http://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
      
  </body>
  
</html>
