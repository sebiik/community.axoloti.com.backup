<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/midi-controller-values-incorrect-when-starting-up-axoloti/4915 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:30:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Midi controller values incorrect when starting up axoloti - Helpdesk - Axoloti Community</title>
    <meta name="description" content="Hello, I&amp;#39;ve connected a midi controller to my axoloti using the 5pin midi input pins but when I start up the axoloti the values of each knob on the controller are all incorrect.... 

If I fiddle with each knob (there are&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="4915.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Midi controller values incorrect when starting up axoloti&#39;" href="4915.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:image" content="http://community.axoloti.com/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:url" content="http://community.axoloti.com/t/midi-controller-values-incorrect-when-starting-up-axoloti/4915" />
<meta name="twitter:url" content="http://community.axoloti.com/t/midi-controller-values-incorrect-when-starting-up-axoloti/4915" />
<meta property="og:title" content="Midi controller values incorrect when starting up axoloti" />
<meta name="twitter:title" content="Midi controller values incorrect when starting up axoloti" />
<meta property="og:description" content="Hello, I&#39;ve connected a midi controller to my axoloti using the 5pin midi input pins but when I start up the axoloti the values of each knob on the controller are all incorrect....   If I fiddle with each knob (there are 12) they immediately correct themselves right away but it&#39;s a huge pain in the butt...especially annoying if the settings were recently set to something I liked..   Is there any way to configure the axoloti to read the values of the midi controller on startup automatically?" />
<meta name="twitter:description" content="Hello, I&#39;ve connected a midi controller to my axoloti using the 5pin midi input pins but when I start up the axoloti the values of each knob on the controller are all incorrect....   If I fiddle with each knob (there are 12) they immediately correct themselves right away but it&#39;s a huge pain in the butt...especially annoying if the settings were recently set to something I liked..   Is there any way to configure the axoloti to read the values of the midi controller on startup automatically?" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="6 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="1 ❤" />

      <link rel="next" href="49154658.html?page=2">

  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="4915.html">Midi controller values incorrect when starting up axoloti</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/helpdesk.html" itemprop="url">
        <span itemprop="title">Helpdesk</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Androoclops.html'><b itemprop='author'>Androoclops</b></a>
           
           <time datetime='2018-08-28T00:23:25Z' itemprop='datePublished'>
             2018-08-28 00:23:25 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hello, I've connected a midi controller to my axoloti using the 5pin midi input pins but when I start up the axoloti the values of each knob on the controller are all incorrect....</p>

<p>If I fiddle with each knob (there are 12) they immediately correct themselves right away but it's a huge pain in the butt...especially annoying if the settings were recently set to something I liked..</p>

<p>Is there any way to configure the axoloti to read the values of the midi controller on startup automatically?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/igel.html'><b itemprop='author'>igel</b></a>
           
           <time datetime='2018-08-28T07:30:53Z' itemprop='datePublished'>
             2018-08-28 07:30:53 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hey,<br>What midi controller is it you are using?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Androoclops.html'><b itemprop='author'>Androoclops</b></a>
           
           <time datetime='2018-08-28T15:10:52Z' itemprop='datePublished'>
             2018-08-28 15:10:52 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>A diy arduino one <br>here's a link to the code if you think it might be at fault...<br><a href="https://drive.google.com/file/d/0BwnVMB_6yujwR1dydVJ6MHJib2M/view" class="onebox" target="_blank" rel="nofollow noopener">https://drive.google.com/file/d/0BwnVMB_6yujwR1dydVJ6MHJib2M/view</a></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/igel.html'><b itemprop='author'>igel</b></a>
           
           <time datetime='2018-08-28T15:40:55Z' itemprop='datePublished'>
             2018-08-28 15:40:55 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I can't tell you what is wrong with your code. Your first initialization could  b triggered from your midi device. A loadbang first shoots a message to Midi telling it to send all cc values at once.<br>Another way would be looking into presets. <br>I'm sure there are better solutions.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kx3.html'><b itemprop='author'>kx3</b></a>
           
           <time datetime='2018-08-30T18:21:08Z' itemprop='datePublished'>
             2018-08-30 18:21:08 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>There's no way for Axoloti to know the position of a controller plugged into DIN5 unless you send the current state from the controller to the Axoloti.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Androoclops.html'><b itemprop='author'>Androoclops</b></a>
           
           <time datetime='2018-08-30T20:08:47Z' itemprop='datePublished'>
             2018-08-30 20:08:47 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Ahh so I need to change the code of my midi controller so it sends the values of each potentiometers when it starts up...hmm</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Androoclops.html'><b itemprop='author'>Androoclops</b></a>
           
           <time datetime='2018-09-02T03:50:35Z' itemprop='datePublished'>
             2018-09-02 03:50:35 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>How do I do a loadbang?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/igel.html'><b itemprop='author'>igel</b></a>
           
           <time datetime='2018-09-03T02:34:25Z' itemprop='datePublished'>
             2018-09-03 02:34:25 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="../../u/rbrt.html">@rbrt</a>  has a loadbang in his repository. It works just like it works in pure data.<br>It emits a pulse/ trigger as soon as the patch starts. You take that to initialize all values that your midi controller currently has. You can send the trigger to a cc and your midi script execute a block of code (send all current cc values). With that you initialise the midi cc to to the board every time you restart the patch. Anyone could correct me if I'm wrong. </p>

<p>Good luck.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/lokki.html'><b itemprop='author'>lokki</b></a>
           
           <time datetime='2018-09-03T21:21:53Z' itemprop='datePublished'>
             2018-09-03 21:21:53 UTC
           </time>
        </span>
        <span itemprop='position'>#9</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i looked at the arduino code briefly, can you post your actual code? i think you posted the sketch you started with. there are no buttons or pots defined in this code (everything is set to zero)</p>

<p>however it should be a simple matter of moving those lines:</p>

<p><code><br> if (NUMBER_BUTTONS != 0) updateButtons();<br>  if (NUMBER_POTS != 0) updatePots();<br>  if (NUMBER_MUX_BUTTONS != 0) updateMuxButtons();<br>  if (NUMBER_MUX_POTS != 0) updateMuxPots();<br></code></p>

<p>into the setup function like so:</p>

<p><code><br>void setup() {<br>  MIDI.begin(MIDI_CHANNEL_OFF);<br>   if (NUMBER_BUTTONS != 0) updateButtons();<br>  if (NUMBER_POTS != 0) updatePots();<br>  if (NUMBER_MUX_BUTTONS != 0) updateMuxButtons();<br>  if (NUMBER_MUX_POTS != 0) updateMuxPots();<br>}<br></code></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Androoclops.html'><b itemprop='author'>Androoclops</b></a>
           
           <time datetime='2018-09-03T22:27:32Z' itemprop='datePublished'>
             2018-09-03 22:27:32 UTC
           </time>
        </span>
        <span itemprop='position'>#10</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Here's what my code ended up looking like in the end</p>

<pre><code>#include &lt;MIDI.h&gt;
#include "Controller.h"

/*************************************************************
  MIDI CONTROLLER

  by Notes and Volts
  www.notesandvolts.com

  Version 1.2 **Arduino UNO ONLY!**
 *************************************************************/

MIDI_CREATE_DEFAULT_INSTANCE();

//************************************************************
//***SET THE NUMBER OF CONTROLS USED**************************
//************************************************************
//---How many buttons are connected directly to pins?---------
byte NUMBER_BUTTONS = 0;
//---How many potentiometers are connected directly to pins?--
byte NUMBER_POTS = 0;
//---How many buttons are connected to a multiplexer?---------
byte NUMBER_MUX_BUTTONS = 6;
//---How many potentiometers are connected to a multiplexer?--
byte NUMBER_MUX_POTS = 12;
//************************************************************

//***ANY MULTIPLEXERS? (74HC4067)************************************
//MUX address pins must be connected to Arduino UNO pins 2,3,4,5
//A0 = PIN2, A1 = PIN3, A2 = PIN4, A3 = PIN5
//*******************************************************************
//Mux NAME (OUTPUT PIN, , How Many Mux Pins?(8 or 16) , Is It Analog?);


Mux M1(10, 16, false); //Digital multiplexer on Arduino pin 10
Mux M2(A5, 16, true); //Analog multiplexer on Arduino analog pin A0
//*******************************************************************


//***DEFINE DIRECTLY CONNECTED POTENTIOMETERS************************
//Pot (Pin Number, Command, CC Control, Channel Number)
//**Command parameter is for future use**

//Pot PO1(A0, 0, 1, 1);
//Pot PO2(A1, 0, 10, 1);
//Pot PO3(A2, 0, 22, 1);
//Pot PO4(A3, 0, 118, 1);
//Pot PO5(A4, 0, 30, 1);
//Pot PO6(A5, 0, 31, 1);
//*******************************************************************
//Add pots used to array below like this-&gt;  Pot *POTS[] {&amp;PO1, &amp;PO2, &amp;PO3, &amp;PO4, &amp;PO5, &amp;PO6};
Pot *POTS[] {};
//*******************************************************************


//***DEFINE DIRECTLY CONNECTED BUTTONS*******************************
//Button (Pin Number, Command, Note Number, Channel, Debounce Time)
//** Command parameter 0=NOTE  1=CC  2=Toggle CC **

//Button BU1(2, 0, 60, 1, 5 );
//Button BU2(3, 0, 61, 1, 5 );
//Button BU3(4, 0, 62, 1, 5 );
//Button BU4(5, 0, 63, 1, 5 );
//Button BU5(6, 0, 64, 1, 5 );
//Button BU6(7, 0, 65, 1, 5 );
//Button BU7(8, 1, 64, 1, 5 );
//Button BU8(9, 2, 64, 1, 5 );
//*******************************************************************
//Add buttons used to array below like this-&gt;  Button *BUTTONS[] {&amp;BU1, &amp;BU2, &amp;BU3, &amp;BU4, &amp;BU5, &amp;BU6, &amp;BU7, &amp;BU8};
Button *BUTTONS[] {};
//*******************************************************************


//***DEFINE BUTTONS CONNECTED TO MULTIPLEXER*************************
//Button::Button(Mux mux, byte muxpin, byte command, byte value, byte channel, byte debounce)
//** Command parameter 0=NOTE  1=CC  2=Toggle CC **

Button MBU1(M1, 0, 0, 70, 1, 5);
Button MBU2(M1, 1, 1, 71, 1, 5);
Button MBU3(M1, 2, 2, 72, 1, 5);
Button MBU4(M1, 3, 0, 73, 1, 5);
Button MBU5(M1, 4, 0, 74, 1, 5);
Button MBU6(M1, 5, 0, 75, 1, 5);
//Button MBU7(M1, 6, 0, 76, 1, 5);
//Button MBU8(M1, 7, 0, 77, 1, 5);
//Button MBU9(M1, 8, 0, 78, 1, 5);
//Button MBU10(M1, 9, 0, 79, 1, 5);
//Button MBU11(M1, 10, 0, 80, 1, 5);
//Button MBU12(M1, 11, 0, 81, 1, 5);
//Button MBU13(M1, 12, 0, 82, 1, 5);
//Button MBU14(M1, 13, 0, 83, 1, 5);
//Button MBU15(M1, 14, 0, 84, 1, 5);
//Button MBU16(M1, 15, 0, 85, 1, 5);
//*******************************************************************
////Add multiplexed buttons used to array below like this-&gt;  Button *MUXBUTTONS[] {&amp;MBU1, &amp;MBU2, &amp;MBU3, &amp;MBU4, &amp;MBU5, &amp;MBU6.....};
Button *MUXBUTTONS[] {&amp;MBU1, &amp;MBU2, &amp;MBU3, &amp;MBU4, &amp;MBU5, &amp;MBU6};

//*******************************************************************


//***DEFINE POTENTIOMETERS CONNECTED TO MULTIPLEXER*******************
//Pot::Pot(Mux mux, byte muxpin, byte command, byte control, byte channel)
//**Command parameter is for future use**

Pot MPO1(M2, 0, 0, 100, 1);
Pot MPO2(M2, 1, 0, 101, 1);
Pot MPO3(M2, 2, 0, 102, 1);
Pot MPO4(M2, 3, 0, 103, 1);
Pot MPO5(M2, 4, 0, 104, 1);
Pot MPO6(M2, 5, 0, 105, 1);
Pot MPO7(M2, 6, 0, 106, 1);
Pot MPO8(M2, 7, 0, 107, 1);
Pot MPO9(M2, 8, 0, 108, 1);
Pot MPO10(M2, 9, 0, 109, 1);
Pot MPO11(M2, 10, 0, 110, 1);
Pot MPO12(M2, 11, 0, 111, 1);
//Pot MPO13(M2, 12, 0, 50, 1);
//Pot MPO14(M2, 13, 0, 55, 2);
//Pot MPO15(M2, 14, 0, 50, 1);
//Pot MPO16(M2, 15, 0, 55, 2);
//*******************************************************************
//Add multiplexed pots used to array below like this-&gt;  Pot *MUXPOTS[] {&amp;MPO1, &amp;MPO2, &amp;MPO3, &amp;MPO4, &amp;MPO5, &amp;MPO6.....};
Pot *MUXPOTS[] {&amp;MPO1, &amp;MPO2, &amp;MPO3, &amp;MPO4, &amp;MPO5, &amp;MPO6, &amp;MPO7, &amp;MPO8, &amp;MPO9, &amp;MPO10, &amp;MPO11, &amp;MPO12};
//*******************************************************************


void setup() {
  MIDI.begin(MIDI_CHANNEL_OFF);
}

void loop() {
  if (NUMBER_BUTTONS != 0) updateButtons();
  if (NUMBER_POTS != 0) updatePots();
  if (NUMBER_MUX_BUTTONS != 0) updateMuxButtons();
  if (NUMBER_MUX_POTS != 0) updateMuxPots();
}


//*****************************************************************
void updateButtons() {

  // Cycle through Button array
  for (int i = 0; i &lt; NUMBER_BUTTONS; i = i + 1) {
    byte message = BUTTONS[i]-&gt;getValue();

    //  Button is pressed
    if (message == 0) {
      switch (BUTTONS[i]-&gt;Bcommand) {
        case 0: //Note
          MIDI.sendNoteOn(BUTTONS[i]-&gt;Bvalue, 127, BUTTONS[i]-&gt;Bchannel);
          break;
        case 1: //CC
          MIDI.sendControlChange(BUTTONS[i]-&gt;Bvalue, 127, BUTTONS[i]-&gt;Bchannel);
          break;
        case 2: //Toggle
          if (BUTTONS[i]-&gt;Btoggle == 0) {
            MIDI.sendControlChange(BUTTONS[i]-&gt;Bvalue, 127, BUTTONS[i]-&gt;Bchannel);
            BUTTONS[i]-&gt;Btoggle = 1;
          }
          else if (BUTTONS[i]-&gt;Btoggle == 1) {
            MIDI.sendControlChange(BUTTONS[i]-&gt;Bvalue, 0, BUTTONS[i]-&gt;Bchannel);
            BUTTONS[i]-&gt;Btoggle = 0;
          }
          break;
      }
    }

    //  Button is not pressed
    if (message == 1) {
      switch (BUTTONS[i]-&gt;Bcommand) {
        case 0:
          MIDI.sendNoteOff(BUTTONS[i]-&gt;Bvalue, 0, BUTTONS[i]-&gt;Bchannel);
          break;
        case 1:
          MIDI.sendControlChange(BUTTONS[i]-&gt;Bvalue, 0, BUTTONS[i]-&gt;Bchannel);
          break;
      }
    }
  }
}
//*******************************************************************
void updateMuxButtons() {

  // Cycle through Mux Button array
  for (int i = 0; i &lt; NUMBER_MUX_BUTTONS; i = i + 1) {

    MUXBUTTONS[i]-&gt;muxUpdate();
    byte message = MUXBUTTONS[i]-&gt;getValue();

    //  Button is pressed
    if (message == 0) {
      switch (MUXBUTTONS[i]-&gt;Bcommand) {
        case 0: //Note
          MIDI.sendNoteOn(MUXBUTTONS[i]-&gt;Bvalue, 127, MUXBUTTONS[i]-&gt;Bchannel);
          break;
        case 1: //CC
          MIDI.sendControlChange(MUXBUTTONS[i]-&gt;Bvalue, 127, MUXBUTTONS[i]-&gt;Bchannel);
          break;
        case 2: //Toggle
          if (MUXBUTTONS[i]-&gt;Btoggle == 0) {
            MIDI.sendControlChange(MUXBUTTONS[i]-&gt;Bvalue, 127, MUXBUTTONS[i]-&gt;Bchannel);
            MUXBUTTONS[i]-&gt;Btoggle = 1;
          }
          else if (MUXBUTTONS[i]-&gt;Btoggle == 1) {
            MIDI.sendControlChange(MUXBUTTONS[i]-&gt;Bvalue, 0, MUXBUTTONS[i]-&gt;Bchannel);
            MUXBUTTONS[i]-&gt;Btoggle = 0;
          }
          break;
      }
    }
    //  Button is not pressed
    if (message == 1) {
      switch (MUXBUTTONS[i]-&gt;Bcommand) {
        case 0:
          MIDI.sendNoteOff(MUXBUTTONS[i]-&gt;Bvalue, 0, MUXBUTTONS[i]-&gt;Bchannel);
          break;
        case 1:
          MIDI.sendControlChange(MUXBUTTONS[i]-&gt;Bvalue, 0, MUXBUTTONS[i]-&gt;Bchannel);
          break;
      }
    }
  }
}
//***********************************************************************
void updatePots() {
  for (int i = 0; i &lt; NUMBER_POTS; i = i + 1) {
    byte potmessage = POTS[i]-&gt;getValue();
    if (potmessage != 255) MIDI.sendControlChange(POTS[i]-&gt;Pcontrol, potmessage, POTS[i]-&gt;Pchannel);
  }
}
//***********************************************************************
void updateMuxPots() {
  for (int i = 0; i &lt; NUMBER_MUX_POTS; i = i + 1) {
    MUXPOTS[i]-&gt;muxUpdate();
    byte potmessage = MUXPOTS[i]-&gt;getValue();
    if (potmessage != 255) MIDI.sendControlChange(MUXPOTS[i]-&gt;Pcontrol, potmessage, MUXPOTS[i]-&gt;Pchannel);
  }
}</code></pre>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/lokki.html'><b itemprop='author'>lokki</b></a>
           
           <time datetime='2018-09-04T06:39:44Z' itemprop='datePublished'>
             2018-09-04 06:39:44 UTC
           </time>
        </span>
        <span itemprop='position'>#11</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ok, have you tried my suggestion of copying the code into the setup part? (but leave the code in the loop untouched)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Androoclops.html'><b itemprop='author'>Androoclops</b></a>
           
           <time datetime='2018-09-04T16:34:32Z' itemprop='datePublished'>
             2018-09-04 16:34:32 UTC
           </time>
        </span>
        <span itemprop='position'>#12</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Just tried it now. First I tried moving the lines by cutting the "if" lines of code and pasting them into the setup function but doing that resulted in the controller not working at all...I then tried copying and pasting the "if" lines into the setup function instead and the controller worked but did not send the values on start up...I also tried both of these options with and without the loadbang object but had the same results either way. Blarrg <img src="../../images/emoji/twitter/frowningae52.png?v=5" title=":frowning:" class="emoji" alt=":frowning:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/lokki.html'><b itemprop='author'>lokki</b></a>
           
           <time datetime='2018-09-04T21:36:55Z' itemprop='datePublished'>
             2018-09-04 21:36:55 UTC
           </time>
        </span>
        <span itemprop='position'>#13</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ok, well definitely leave it in the loop, or it will not run after setup (as you found out)</p>

<p>had another look at the code, the problem is, that it only sends midi out, when the pots are turned (otherwise it would send midi messages all the time)</p>

<p>you basically have to write additional functions that make sure the pots are read on init (even though they did not move)</p>

<p>what about the switches? are those toggles or momentary switches? what do you change with them?</p>

<p>but let's first take care of the pots:</p>

<p>add these lines to the very end of the arduino sketch:</p>

<pre><code>void updateMuxPotsInit() {
  for (int i = 0; i &lt; NUMBER_MUX_POTS; i = i + 1) {
    MUXPOTS[i]-&gt;muxUpdate();
    byte potmessage = MUXPOTS[i]-&gt;getValueInit();
    if (potmessage != 255) MIDI.sendControlChange(MUXPOTS[i]-&gt;Pcontrol, potmessage, MUXPOTS[i]-&gt;Pchannel);
  }</code></pre>

<p>}</p>

<p>the void setup() should look like this:</p>

<pre><code>void setup() {
  MIDI.begin(MIDI_CHANNEL_OFF);
  if (NUMBER_MUX_POTS != 0) updateMuxPotsInit();
}</code></pre>

<p>then also add this function to the Controller.cpp file (after line 156):</p>

<pre><code>byte Pot::getValueInit()
{
  _value = analogRead(_pin);
    return _value &gt;&gt; 3;
}</code></pre>

<p>and add to Controller.h, after line 53:</p>

<p><code>byte getValueInit();</code></p>

<p>that should/could do it.</p>

<p>unfortunately i cannot test this, but let me know if it works <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Androoclops.html'><b itemprop='author'>Androoclops</b></a>
           
           <time datetime='2018-09-04T22:01:45Z' itemprop='datePublished'>
             2018-09-04 22:01:45 UTC
           </time>
        </span>
        <span itemprop='position'>#14</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Sweeeeet, I'll give this a shot asap. Hopefully tomorrow morning!</p>

<p>I have a bunch of switches I'm using right now. I'll be using them to turn various things on/off as well as switching between thing (like choosing between trip,saw,square waveforms) ......I'm guessing they need to be toggle switches that turn on midi cc notes...when those notes are active/inactive I can set up my patch to toggle things on/off</p>

<p>Edit for clarification: the switches I'm using are all toggle switches.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/lokki.html'><b itemprop='author'>lokki</b></a>
           
           <time datetime='2018-09-05T07:29:10Z' itemprop='datePublished'>
             2018-09-05 07:29:10 UTC
           </time>
        </span>
        <span itemprop='position'>#15</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="14" data-topic="4915"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/androoclops/40/4538_1.jpg" class="avatar">Androoclops:</div>
<blockquote><p>switching between thing (like choosing between trip,saw,square waveforms)</p></blockquote></aside>

<p>how are you planing on switching more then two states with a toggle switch? or more precisely, how do you expect to sync the controller and the axoloti in that regard on startup? because the switch has only two states, there is no way for the arduino to know which waveform should be choosen on the axoloti on startup. unless you move the whole switching logic to the arduino and send a different value of the same cc message for each waveform:</p>

<p>sine: cc20 value 1<br>tri: cc20 value 2 etc.</p>

<p>but then you will have to save the state of the switch in eeprom on the arduino, and recall it on boot up. you will also need some kind of display for the buttons (leds or similar) otherwise you will not be able to see which waveform you have selected.</p>

<p>all in all, maybe it would be easier to use a rotary switch for the waveform choosing, you will need additional digital ins, but i think you have them available on the uno or your multiplexer.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Androoclops.html'><b itemprop='author'>Androoclops</b></a>
           
           <time datetime='2018-09-05T14:09:30Z' itemprop='datePublished'>
             2018-09-05 14:09:30 UTC
           </time>
        </span>
        <span itemprop='position'>#16</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I'm using a rotary switch but in the Arduino code the mode would be set to toggle...or would that have to be set to momentary?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:2'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Androoclops.html'><b itemprop='author'>Androoclops</b></a>
           
           <time datetime='2018-09-05T14:14:20Z' itemprop='datePublished'>
             2018-09-05 14:14:20 UTC
           </time>
        </span>
        <span itemprop='position'>#17</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>And for the other switches to switch between say two different options I'm just using spdt switches with the + in on the middle pole and the others go to resistors going to ground/a digital multiplexer that sends it's signals to the Arduino pin number 10... also for things that are on/off, rather than using resistors im using leds.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Androoclops.html'><b itemprop='author'>Androoclops</b></a>
           
           <time datetime='2018-09-05T14:44:57Z' itemprop='datePublished'>
             2018-09-05 14:44:57 UTC
           </time>
        </span>
        <span itemprop='position'>#18</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>alrighty, tried it out, didnt work but on start up but the controller still functions. I wish I knew how to code, I seem to understand the problem, that the controlleris waiting for the value for the pot to change before it would send the first value to the controller axoloti. I guess the solution would be to have it get current values of the pots on startup and send them to the controller, then begin its loop where it sends midi notes when changed...</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/lokki.html'><b itemprop='author'>lokki</b></a>
           
           <time datetime='2018-09-05T15:09:58Z' itemprop='datePublished'>
             2018-09-05 15:09:58 UTC
           </time>
        </span>
        <span itemprop='position'>#19</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ok, well the problem is at least twofold:</p>

<p>1) the controller has to send all the pot positions on startup (of the controller) so that the axoloti patch matches the pot positions<br>2) the controller has to be powered on after the axoloti (and the patch is loaded) so that the axoloti is ready to receive all this midi info and adjust the patch accordingly.</p>

<p>since midi is a one way protocol, there is no way for your controller to know when the axoloti is ready...</p>

<p>for 1)</p>

<p>at this point please check if the arduino sends midi on startup by connecting it to a pc and a midi monitoring program. </p>

<p>for 2)</p>

<p>i don't know about this in your setup, so leave that uncommented</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/lokki.html'><b itemprop='author'>lokki</b></a>
           
           <time datetime='2018-09-05T15:13:50Z' itemprop='datePublished'>
             2018-09-05 15:13:50 UTC
           </time>
        </span>
        <span itemprop='position'>#20</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="16" data-topic="4915" data-full="true"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/androoclops/40/4538_1.jpg" class="avatar">Androoclops:</div>
<blockquote><p>I'm using a rotary switch but in the Arduino code the mode would be set to toggle...or would that have to be set to momentary?</p></blockquote></aside>

<p>you would need multiple inputs for one rotary switch (or one analog input and some resistors)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi controller values incorrect when starting up axoloti'>
      <hr>
  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement'>
      <span itemprop='url'><b><a rel="next" itemprop="name" href="49154658.html?page=2">next page →</a></b></span>
  </div>





    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/midi-controller-values-incorrect-when-starting-up-axoloti/4915 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:30:57 GMT -->
</html>
