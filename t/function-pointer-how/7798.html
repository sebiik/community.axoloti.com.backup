<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/function-pointer-how/7798 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jul 2023 03:03:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Function pointer, how? - AxoObject coding - Axoloti Community</title>
    <meta name="description" content="I&amp;#39;m creating a multi-pole morphing multimode filter which uses some internal non-linearity shapers. Thing is, after adding a &amp;quot;switch&amp;quot; function to select between the different shaping types, it suddenly asked way more the&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="7798.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://sebiik.github.io/community.axoloti.com.backup","potentialAction":{"@type":"SearchAction","target":"https://sebiik.github.io/community.axoloti.com.backup/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Function pointer, how?&#39;" href="7798.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:image" content="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/function-pointer-how/7798" />
<meta name="twitter:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/function-pointer-how/7798" />
<meta property="og:title" content="Function pointer, how?" />
<meta name="twitter:title" content="Function pointer, how?" />
<meta property="og:description" content="I&#39;m creating a multi-pole morphing multimode filter which uses some internal non-linearity shapers. Thing is, after adding a &quot;switch&quot; function to select between the different shaping types, it suddenly asked way more then it should (when using the same &quot;default&quot;, previously used shape, it asked 5% more than before.. does the switch-function really adds so much cpu usage??)   So, instead of this, I thought it might be a good idea to use a function-pointer, that&#39;s being used within the filter-obje..." />
<meta name="twitter:description" content="I&#39;m creating a multi-pole morphing multimode filter which uses some internal non-linearity shapers. Thing is, after adding a &quot;switch&quot; function to select between the different shaping types, it suddenly asked way more then it should (when using the same &quot;default&quot;, previously used shape, it asked 5% more than before.. does the switch-function really adds so much cpu usage??)   So, instead of this, I thought it might be a good idea to use a function-pointer, that&#39;s being used within the filter-obje..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins ðŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="5 â¤" />


  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="7798.html">Function pointer, how?</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/axoobject-code.html" itemprop="url">
        <span itemprop="title">AxoObject coding</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/SirSickSik.html'><b itemprop='author'>SirSickSik</b></a>
           
           <time datetime='2022-09-24T13:31:23Z' itemprop='datePublished'>
             2022-09-24 13:31:23 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I'm creating a multi-pole morphing multimode filter which uses some internal non-linearity shapers.<br>Thing is, after adding a "switch" function to select between the different shaping types, it suddenly asked way more then it should (when using the same "default", previously used shape, it asked 5% more than before.. does the switch-function really adds so much cpu usage??)</p>

<p>So, instead of this, I thought it might be a good idea to use a function-pointer, that's being used within the filter-objects, but to which I can assign a certain function when the selector changes.</p>

<p>I'm trying my best to find out how to do this on the internet, but all the examples I run into are way more complex than I need, containing all kinds of extra code of the threat starters, making it pretty hard to see what is the basic "build up" of a function-pointer. So could someone help me out on this and show me how to make a simple function-pointer?</p>

<p>The basic functions I'm using are build like this:</p>

<p>int32_t SIN(  int32_t in  )   //just a single input<br>{<br>       SINE2TINTERP(  in  ,  in  ) //some kind of math function<br>       return in;      //returning the result<br>}<br>int32_t COS(  int32_t in  )   //just a single input<br>{<br>       SINE2TINTERP(  in + (1&lt;&lt;30)   ,  in  ) //some kind of math function<br>       return in;      //returning the result<br>}<br>for a start, I'ld like to have a function pointer that I could embed in a filter like  *SHAPE(....) </p>

<p>int32_t *SHAPE() and int32_t FILTER() would be put in the local data and *SHAPE() should be pointed to some function in the krate code along this line (though this seems to be the wrong way..)</p>

<p>if(param_shape==0)<br>{<br>  SHAPE()=&amp;SIN();<br>}</p>

<p>int32_t FILTER(  int32_t *in,  int32_t *val,  int32_t f  )<br>{<br>    *val  =  ___SMMLA(  *SHAPE(  *in  )  -  *SHAPE(  *val  )  &lt;&lt;1  ,  f,  *val  )  ;<br>    *in  =  *val;<br>}</p>

<p>So can someone tell me the right syntax to do this?? Or point me to an axoloti object that uses int32_t function-pointers, so I can find out myself?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Function pointer, how?'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/SirSickSik.html'><b itemprop='author'>SirSickSik</b></a>
           
           <time datetime='2022-09-24T13:39:57Z' itemprop='datePublished'>
             2022-09-24 13:39:57 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ps, the filter is really nice and creamy and I'll share it once it's done.<br>It's like a 4-pole ladder filter, but instead of switching filter-types, it's able to morph between LOWPASS-ALLPASS-HIGHPASS while the resonance stays pretty stable and uses seperate cutoff frequencies for each pole, so it almost works like an equaliser all on it's own. Thanks to the non-linearities, you can really push the resonance over the top and make it scream, while at lower resonance settings it sounds really nice and pingy. Formant filtering is a breeze, put a saw into it and you have yourself a didgeridoo!</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:2'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Function pointer, how?'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jcgriggs.html'><b itemprop='author'>jcgriggs</b></a>
           
           <time datetime='2022-09-25T20:53:21Z' itemprop='datePublished'>
             2022-09-25 20:53:21 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>It's been a while but I believe if you have:<br>int32_t SIN(int32_t in) { //code }<br>and<br>int32_t COS(int32_t in) { //code }<br>you can do:<br>int32_t (*SHAPE)(int32_t) { nullptr }; // defer assignment, start with null</p>

<p>if (param_shape == 0)<br>{ <br>  SHAPE = &amp;SIN;<br>}<br>else<br>{<br>  SHAPE = &amp;COS;<br>}<br>SHAPE(param_val);  // Note: this will be bad is SHAPE is still null</p>

<p>The syntax to declare a function pointer in C++ is ugly:<br>return_type (*var_name)([arg_type, ...]) { initial_value };</p>

<p>Where return_type is the return type for the functions to be pointed to<br>  var_name is the variable name<br>  [arg_type, ...] is the list of argument types for the functions to be pointed at, which may be empty<br>  initial_value is the initial value for the variable var_name, can be nullptr or an actual function address</p>

<p>You can assign just using the address dereference operator ("&amp;") before the name of the function.  Both the return type and the number and types of arguments must match between pointer and function for the assignment to be valid, I think. </p>

<p>More typical than declaring function pointers directly, in my experience anyway, is to use a typedef:</p>

<p>#typedef ShapePtr int32_t (*)(int32_t);</p>

<p>ShapePtr Shape;</p>

<p>Shape = &amp;SIN;</p>

<p>Hope this helps,<br>  John</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Function pointer, how?'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/SirSickSik.html'><b itemprop='author'>SirSickSik</b></a>
           
           <time datetime='2022-09-26T16:57:12Z' itemprop='datePublished'>
             2022-09-26 16:57:12 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>should the part </p>

<p> <span class="hashtag">#typedef</span> ShapePtr int32_t (*)(int32_t);</p>

<p>already work on it's own without errors? (either with or without the "#")</p>

<p>As it's telling me:</p>

<p>C:\Users\SIRSIC~1\DOCUME~1\axoloti/build/xpatch.cpp:72:9: error: 'ShapePtr' does not name a type<br> typedef ShapePtr int32_t (*)(int32_t);</p>

<p>or</p>

<p>C:\Users\SIRSIC~1\DOCUME~1\axoloti/build/xpatch.cpp:72:2: error: invalid preprocessing directive <span class="hashtag">#typedef</span><br> <span class="hashtag">#typedef</span> ShapePtr int32_t (*)(int32_t);</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Function pointer, how?'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jcgriggs.html'><b itemprop='author'>jcgriggs</b></a>
           
           <time datetime='2022-09-27T14:07:15Z' itemprop='datePublished'>
             2022-09-27 14:07:15 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Sorry - I should definitely not try to remember syntax for stuff I haven't used in years - looking it up is much safer.  The syntax should be:</p>

<p>typedef int32_t (*)(int32_t) ShapePtr;</p>

<p>It's not a preprocessor directive (so no leading #) and I got the type and name bits backwards.  Sorry about that.<br>Regards,<br>   John</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Function pointer, how?'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/SirSickSik.html'><b itemprop='author'>SirSickSik</b></a>
           
           <time datetime='2022-09-27T21:50:47Z' itemprop='datePublished'>
             2022-09-27 21:50:47 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ok, so this isn't working either...now it gave me these errors:</p>

<p>C:\Users\SIRSIC~1\DOCUME~1\axoloti/build/xpatch.cpp:40:19: error: expected unqualified-id before ')' token<br> typedef int32_t (*)(int32_t) ShapePtr;<br>                   ^<br>C:\Users\SIRSIC~1\DOCUME~1\axoloti/build/xpatch.cpp:40:28: error: expected ';' at end of member declaration<br> typedef int32_t (*)(int32_t) ShapePtr;<br>                            ^<br>C:\Users\SIRSIC~1\DOCUME~1\axoloti/build/xpatch.cpp:40:30: error: 'ShapePtr' does not name a type<br> typedef int32_t (*)(int32_t) ShapePtr;</p>

<p>when I changed it to this, it didn't give me any errors anymore. </p>

<p>typedef int32_t (*ShapePtr)(int32_t) ;</p>

<p>But when I try to do:<br>ShapePtr=&amp;sin;<br>then it gives me the error:</p>

<p>C:\Users\SIRSIC~1\DOCUME~1\axoloti/build/xpatch.cpp:62:4: error: expected unqualified-id before '=' token</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Function pointer, how?'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jcgriggs.html'><b itemprop='author'>jcgriggs</b></a>
           
           <time datetime='2022-09-28T14:19:51Z' itemprop='datePublished'>
             2022-09-28 14:19:51 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Sorry for messing the syntax up YET AGAIN!.  Your final version is correct:</p>

<p>typedef int32_t (*ShapePtr)(int32_t);</p>

<p>The issue is that ShapePtr now names a TYPE, not a variable.  You need to do:</p>

<p>ShapePtr shape = &amp;sin;</p>

<p>Then "shape" is the actual pointer and can be used:</p>

<p>int32_t rtn = shape(param_val);</p>

<p>Sorry for the goose chase to get here, but I think this is now all correct.</p>

<p>Regards,<br>   John</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Function pointer, how?'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/SirSickSik.html'><b itemprop='author'>SirSickSik</b></a>
           
           <time datetime='2022-09-28T22:15:29Z' itemprop='datePublished'>
             2022-09-28 22:15:29 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ah yes of course, it's first setting/creating the type and then I still need to declare something being that type</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Function pointer, how?'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/SirSickSik.html'><b itemprop='author'>SirSickSik</b></a>
           
           <time datetime='2022-09-28T22:22:46Z' itemprop='datePublished'>
             2022-09-28 22:22:46 UTC
           </time>
        </span>
        <span itemprop='position'>#9</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>thanks! I got it working!</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Function pointer, how?'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/SirSickSik.html'><b itemprop='author'>SirSickSik</b></a>
           
           <time datetime='2022-09-28T23:23:53Z' itemprop='datePublished'>
             2022-09-28 23:23:53 UTC
           </time>
        </span>
        <span itemprop='position'>#10</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>hmm, too bad.. not a big change in cpu load for the filter as far as I can see. That's a shame.. it's still on the heavy side  (between 17% and 27%) which quite limits it's usage in bigger patches. So I'll need to try to get it down another way..</p>

<p>But it's good to finally understand how to make function-pointers! I ran into that problem several times in previous projects..</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Function pointer, how?'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jcgriggs.html'><b itemprop='author'>jcgriggs</b></a>
           
           <time datetime='2022-09-29T00:51:10Z' itemprop='datePublished'>
             2022-09-29 00:51:10 UTC
           </time>
        </span>
        <span itemprop='position'>#11</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Glad to hear you got it working!  Sorry again for my issues with getting the ugly c++ function pointer syntax integrated with the typedef syntax.  It's been years since I've used this stuff and then the idea was to hide all the ugly function pointer declarations with typedefs and forget about it (which I obviously did!)</p>

<p>Regards,<br>   John</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Function pointer, how?'>
      <hr>
  </div>






    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/function-pointer-how/7798 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jul 2023 03:03:06 GMT -->
</html>
