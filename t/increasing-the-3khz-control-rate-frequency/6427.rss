<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Increasing the 3khz control rate frequency</title>
    <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427</link>
    <description>Hey people,
I want to use the axoloti to control the following 40Channel DAC board.
https://www.analog.com/en/design-center/evaluation-hardware-and-software/evaluation-boards-kits/eval-ad5370.html#eb-overview
https://www.analog.com/media/en/technical-documentation/evaluation-documentation/EVAL-AD5370_5372_5373EB.pdf
https://www.analog.com/media/en/technical-documentation/data-sheets/AD5370.pdf

As i plan to use the axoloti mainly for controlling those channels I am wondering if there is a way to increase the control rate frequency from 3khz to for example 48 khz or 24khz.
I read the following topic and wanted to implement the spi communication similarily but I think that the script objects loop function is called at a rate of 3khz only, isnt it?
Or is there a better way to implement that spi code as a pseudo audio object or with a totally different approach which gives even better performance?
https://www.analog.com/en/design-center/evaluation-hardware-and-software/evaluation-boards-kits/eval-ad5370.html#eb-overview

Thanks in advance,
Florian</description>
    
    <lastBuildDate>Wed, 22 Apr 2020 08:07:29 +0000</lastBuildDate>
    <category>Hardware</category>
    <atom:link href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Sebo Sebastian Cordoves]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/sebo">@Sebo</a> wrote:</p>
          <blockquote>
              <p>I think you mean if I'm using the DACs or the PWM outs to output CV. I'm using both (and also I'm using the ADCs to input CV).<br>I'm using the 2 DACs plus 2 PWM outs, and I regret not having used more PWM outs, as they work very well.<br>Here, I let you a link to a post with what I did:<br><aside class="quote" data-post="1" data-topic="4229">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/community.axoloti.com/sebo/40/4466_1.png" class="avatar">
    <a href="//community.axoloti.com/t/axoloti-as-a-5u-module/4229?source_topic_id=6427" rel="nofollow noopener">Axoloti as a 5U Module</a> <a class="badge-wrapper  bullet" href="/c/hardware"><span class="badge-category-bg" style="background-color: #AB9364;"></span><span style="color: #FFFFFF;" class="badge-category clear-badge" title="This category is intended for discussion about the Axoloti hardware and connecting to other hardware, including , connecting midi controllers and other hardware, related hardware projects.">Hardware</span></a>
  </div>
  <blockquote>
    Hi all: I did a module with Axoloti for my 5U modular. The module have: 

4 CV inputs (CV control + CV Atenautor) connected to PA0 to PA3. 1 Digital Input (with voltaje protection) connected to PB0. 2 CV outputs (0 to 10V) connected to PA4 and PA5 DAC outputs. 2 CV outputs (0 to 10V) connected to PA6 and PA7 using PWM at 10KHz. 6 Digital outputs connected to PC0 to PC5. 1 LED connected to PB1. 

 <a href="//community.axoloti.com/uploads/default/original/2X/0/04e1df4620f3f5ae4b668320a8180de3d7a3cdd9.jpg" class="lightbox" title="Modular.jpg" rel="nofollow noopener">[image]</a> <a href="//community.axoloti.com/uploads/default/original/2X/c/cb60fc04203aa6b759c9f7a8f098b09be959eaf5.png" class="lightbox" title="Sebo Axoloti Shield V4 - Schematic.png" rel="nofollow noopener">[image]</a>

Notes: I used MCP6002 (not MCP602), just didn't have a library for the MCP6002 in Eâ€¦
  </blockquote>
</aside>
</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/32">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/32</link>
        <pubDate>Wed, 22 Apr 2020 08:07:29 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-32</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Blindsmyth Simon]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/blindsmyth">@Blindsmyth</a> wrote:</p>
          <blockquote>
              <p>ok thanks. I would really love to have one more mono out to use as an fx send...</p>

<p>Are you using that adc in the end or do you use the pwm pins directly for cv control?</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/31">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/31</link>
        <pubDate>Tue, 21 Apr 2020 16:37:45 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-31</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Sebo Sebastian Cordoves]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/sebo">@Sebo</a> wrote:</p>
          <blockquote>
              <p>Short answer: NO.</p>

<p>There is another thread were Johannes explain how to do it but is very complicated, I think nobody tried...<br>I modified the code to get good CV control out of the PWM outs, but not audio (well I mange to get audio, but it sounded horrible).</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/30">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/30</link>
        <pubDate>Tue, 21 Apr 2020 14:57:10 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-30</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Blindsmyth Simon]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/blindsmyth">@Blindsmyth</a> wrote:</p>
          <blockquote>
              <p>Hey there, very interesting project! Could you get it to work properly in the end?</p>

<p>I was wondering: could this be used to achieve very lo fi extra audio out (with everything cut above 3k)</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/29">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/29</link>
        <pubDate>Mon, 20 Apr 2020 21:27:05 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-29</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Flub Flo]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/flub">@Flub</a> wrote:</p>
          <blockquote>
              <p>This is the working patch now:<br><a class="attachment" href="//community.axoloti.com/uploads/default/original/2X/3/3eb7327ab6efddfaff5ef968ac26d5bf72876893.axp">basic_setting.axp</a> (8.5 KB)<br>For anyone who wants to use that 40Ch 16 bit DAC Board too: It only worked reliably on Clockarte FPCLK/4 when i put 10 Ohm termination resistors on the axoloti boards CLK and MOSI.</p>

<p>It is just working fine except two problems. <br>The first problem is actually the reason why i started this thread. The control rate of 3khz is not ideal for smooth sweeps. A sine Lfo cannot be used in higher Frequencies as it is a strange staircase then.<br>The second problem is that the patcher or actually my hole OS freezes when constantly turn the dial around for 20 seconds in the patch "basic_setting.axp". My mouse is not visible anymore and nothing interacts. So I have to reboot.<br>Has anyone an idea what the reason for this is? I am using windows 10 at the moment and the axoloti patchers version is:<br>Build Version: 1.0.12-2-0-g60a2f99<br>Build Date: 08/04/2018 20:20:07 CEST<br>Java version: 1.8.0_161</p>

<p>I could not find a log file which is telling me what happened thats why I am kind of clueless...<br>- Flub</p>

<p>--- EDIT<br>The problem only occurs when i have multiple DAC output objects at the same time.</p>

<pre><code>attr_table.array[attr_channel] = inlet_i1 &gt;&gt; 11;</code></pre>

<p>I think somehow it is problematic to write to multiple keys of the array from many "patcher/object" objects at the same time... Is that possible?</p>

<p>in my DAC controller object i call this at k-rate:</p>

<pre><code>for (uint8_t i = 0; i &lt; 40; i++) {
	if (attr_table.array[i] != DACLevels[i]) {
		setDAC(i, X, attr_table.array[i]);
		DACLevels[i] = attr_table.array[i];
	}
}
pulseLDAC();`</code></pre>

<p>__EDIT: <br>I just realized it is not freezing anymore when i set FPCLK/8 instead of FPCLK/4. Can it be that there is somekind of problem with the SPI library?</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/28">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/28</link>
        <pubDate>Thu, 05 Mar 2020 08:34:01 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-28</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@ricard Ricard Wanderlof]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/ricard">@ricard</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="25" data-topic="6427" data-full="true"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/letter_avatar_proxy/v2/letter/f/4af34b/40.png" class="avatar">Flub:</div>
<blockquote><p>Then there is actually no reason to use the patch/object for me anymore. I thought it is not editable anymore then.</p></blockquote></aside>

<p>As you've noted there shouldn't be a difference in performance, it all ends up in one big function when the patch is compiled anyway.</p>

<p>I find patcher objects handy when developing objects as it means both the object and the surrounding patch are saved together and it's not necessary to keep the files for the patch and separate object that you are working on in sync.</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/27">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/27</link>
        <pubDate>Mon, 24 Feb 2020 05:07:29 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-27</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@tele_player]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/tele_player">@tele_player</a> wrote:</p>
          <blockquote>
              <p>The limit you're hitting isn't caused by the 3khz K-rate. You're being limited by the actual speed of the SPI link. Observe the DSP load %, running with FPCLK/4, FPCLK/8, FPCLK/16. And the square LFOs are probably reducing the number of SPI writes.<br>Note also - the SPI writes are synchronous, nothing else gets done while bits are in motion on the SPI.</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/26">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/26</link>
        <pubDate>Mon, 24 Feb 2020 04:36:00 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-26</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Flub Flo]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/flub">@Flub</a> wrote:</p>
          <blockquote>
              <p><a class="mention" href="/u/jaffasplaffa">@jaffasplaffa</a> They are just there to test the performance of different amounts of DAC Channels to be updated in a k-cycle. <br>The Data is only sent when it changed. <br>Cool, thats what I did not know. Then there is actually no reason to use the patch/object for me anymore. I thought it is not editable anymore then.</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/25">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/25</link>
        <pubDate>Sun, 23 Feb 2020 18:27:13 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-25</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@jaffasplaffa Mr. Grimm]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/jaffasplaffa">@jaffasplaffa</a> wrote:</p>
          <blockquote>
              <p>And yeah if you make it into a an object and save it to the library, its easier, cause you dont have to copy all the object over and over again every time you made a change in one of them. You just save the object and all of them will be changed right away.</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/24">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/24</link>
        <pubDate>Sun, 23 Feb 2020 18:25:35 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-24</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@jaffasplaffa Mr. Grimm]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/jaffasplaffa">@jaffasplaffa</a> wrote:</p>
          <blockquote>
              <p>If you build the lfo into the object, you have saved 80 inlet/outlets. I think that's worth considering.</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/23">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/23</link>
        <pubDate>Sun, 23 Feb 2020 18:23:33 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-23</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Flub Flo]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/flub">@Flub</a> wrote:</p>
          <blockquote>
              <p>Here is a the working AD5370 Patch:<a class="attachment" href="//community.axoloti.com/uploads/default/original/2X/b/bd0dfd19465801fdcf6a753b9c7bd2eb1f13bdf4.axp">eval_board-control_dev_18_40_squares_test.axp</a> (53.5 KB)</p>

<p>I did not use a subpatch i think. But i used this "patch/object" object to put my code for the DAC somewhere. I dont know if that will benefit from being an object like the ones which i can select from the objects list when i double click.<br>__ EDIT __ <br>I just found out that the file menu of the object editor offers the option "copy to library" I did it and it did not change the performance.</p>

<p>So actually the main question is actually. Is there any way to output data faster than 3khz .</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/22">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/22</link>
        <pubDate>Sun, 23 Feb 2020 18:15:44 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-22</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@jaffasplaffa Mr. Grimm]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/jaffasplaffa">@jaffasplaffa</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="20" data-topic="6427"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/letter_avatar_proxy/v2/letter/f/4af34b/40.png" class="avatar">Flub:</div>
<blockquote><p>I now implement the code in a patch/object. Is it somehow more perfomant to export it as a real object somehow?</p></blockquote></aside>

<p>If you want to make an object instead of a subpatch I think there is something to gain. All the inlets uses ram. So ilets sat you have 10 objects inside a subpatch and they are all connected via in/outlets and you code the 10 objects in one single object, you don't have all those inlets/outlets anymore and you can save the memory used in the subpatch.</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/21">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/21</link>
        <pubDate>Sun, 23 Feb 2020 17:43:49 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-21</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Flub Flo]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/flub">@Flub</a> wrote:</p>
          <blockquote>
              <p>Ah now I get it. Thats a nice trick and good to know : ) <br>I think I am gonna do it with a table and a kind of helper object where you can select the table index you want to control. so I can put the inlets for the DAC outputs speperated anywhere in the patch.</p>

<p>Another question:<br>I now implement the code in a patch/object. Is it somehow more perfomant to export it as a real object somehow? I dont know how to do it, but I am curious if it is worth trying out.</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/20">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/20</link>
        <pubDate>Sun, 23 Feb 2020 17:23:05 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-20</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@jaffasplaffa Mr. Grimm]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/jaffasplaffa">@jaffasplaffa</a> wrote:</p>
          <blockquote>
              <p>See here how you get the values in. If you don't need many inlets, this is probably not the best solution. But if you do it's a lot easier.</p>

<p><img src="//community.axoloti.com/uploads/default/original/2X/5/56c817911d56d9ed4319c8a2aaf0ebb59d4e3a06.png" width="690" height="436"></p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/19">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/19</link>
        <pubDate>Sun, 23 Feb 2020 17:20:07 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-19</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Flub Flo]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/flub">@Flub</a> wrote:</p>
          <blockquote>
              <p>Cool thank you! I just wanted to test it out, but i could not connect more than one blue line to the red input. How is that possible?<br>Anyways i think I will take that array approach so i can also check if the value changed before sending it to the DAC to save performance. When I send all of them it takes 60% of the cpu.</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/18">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/18</link>
        <pubDate>Sun, 23 Feb 2020 17:16:03 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-18</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@jaffasplaffa Mr. Grimm]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/jaffasplaffa">@jaffasplaffa</a> wrote:</p>
          <blockquote>
              <p>You could just put the inlets into an array, like this:</p>

<p>int a[3]={inlet_i1,inlet_i2,inlet_i3};</p>

<p>And then use a variable to select which slot of the array you want to select:</p>

<p>outlet_l = a[param_sel];</p>

<p>Another way is to take advantage of srate inlets. If you are using many inlets, this is going to be the easiest way I think. If you are routing tons of cables, using this method can make bi patches a little bit easier to comprehed and work with.</p>

<p>If you make srate inlets, the red ones, but put the code into krate fan, you can actually route 16 krate signals through a srate inlet. Krate is 3000 srate is 48000, so 48000/3000=16.....</p>

<p>Something like this image below. Here I have ONE single srate inlet and then I use inlet[0], inlet[1], inlet[2], etc. to display each value from each of the parts of the inlets.</p>

<p><img src="//community.axoloti.com/uploads/default/original/2X/8/826e693d0486cab0f31dc7874afb0f2d4bcd9223.png" width="641" height="417"></p>

<p>You can simply use:</p>

<p>inlet_i[set number here]</p>

<p>to select one of the 16 inlet_i[x]</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/17">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/17</link>
        <pubDate>Sun, 23 Feb 2020 16:57:31 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-17</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Flub Flo]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/flub">@Flub</a> wrote:</p>
          <blockquote>
              <p>I am not sure yet. I want to make possible as much as possible so actually 48khz would be awesome to have. But I would just be fine with 3000 for a beginning.</p>

<p>I ve got a quick question about dynamically reading the inlet values.</p>

<pre><code>disp_d1 = inlet_i1 &gt;&gt; 11; 
//setDAC(1, X, (inlet_i2 &gt;&gt; 11));
for (uint8_t i = 0; i &lt; 40; i++) {
   setDAC(i, X, inlet_i??? &gt;&gt; 11));	
}
pulseLDAC();</code></pre>

<p>I think you see what the problem is. Do you know how it is done to dynamically compose those constant names ?</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/16">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/16</link>
        <pubDate>Sun, 23 Feb 2020 16:18:16 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-16</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@tele_player]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/tele_player">@tele_player</a> wrote:</p>
          <blockquote>
              <p><a class="mention" href="/u/flub">@Flub</a> - what is the maximum frequency you want to send using these DACs?</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/15">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/15</link>
        <pubDate>Sat, 22 Feb 2020 23:34:11 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-15</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@weasel79 blender]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/weasel79">@weasel79</a> wrote:</p>
          <blockquote>
              <p>Wow thanks <a class="mention" href="/u/ricard">@ricard</a> for the thorough explanation i finally understood a lot of issues i was running into recently. You should copy this into a user guide thread...</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/14">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/14</link>
        <pubDate>Sat, 22 Feb 2020 16:49:52 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-14</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Flub Flo]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/flub">@Flub</a> wrote:</p>
          <blockquote>
              <p>Alright, thank you for that! So I could somehow think about using a 16 x 16bit buffer/shift register which is clocked out with the samplerate and loaded on each k-rate.<br>Perhaps K-rate is also enough. I just recognized that it is a bigger problem that my midi controller "akai midimix" cannot send NRPN cc messages. I mean that i can only get 0-127 steps from the faders which is not perfect. But it might be also okay when i use a smooth object in between the midi values and the "DAC object" input.</p>

<p>Anyways, if 3000Hz is not enough, is it possible to setup an extra timer + interrupt routine which is running faster?</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/13">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/13</link>
        <pubDate>Sat, 22 Feb 2020 14:29:57 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-13</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@ricard Ricard Wanderlof]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/ricard">@ricard</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="11" data-topic="6427" data-full="true"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/letter_avatar_proxy/v2/letter/f/4af34b/40.png" class="avatar">Flub:</div>
<blockquote>
<p><a class="mention" href="/u/ricard">@ricard</a> Thank you for that hint. I am not sure if I understood it correctly. What you described would happen if i put the spiSend function inside the S-Rate code tab? </p>
<p>Is there a way to execute my code 48000 times per second?</p>
</blockquote></aside>

<p>If you put code inside the K-rate tab, it will be executed 3000 times per second, at roughly equal intervals (1/3000 s = 0.333 ms). The exact time at with the code is executed (relative to the 3000 Hz K-rate 'tick') depends on where the patcher actually places your code relative to the code for all the other modules. The higher up and further to the left in the patcher GUI you place a module, the closer to the 3000 Hz K-rate 'tick' it will be executed. Most often, modules take about the same amount of time to execute each time, so your code will get called fairly regularly at 0.333 ms intervals wherever in the physical patcher GUI space it is locaed.</p>

<p>If you put code inside the S-rate tab, the patcher puts a 16 times loop around it, and executes the loop at the K-rate of 3000 Hz. Thus, your code will be executed 48000 times a second (16 x 3000 Hz), but the interval between each time your code is called will not be 1/48000 = 20.833 Âµs. Rather, every 0.333 ms, your code will be called 16 times in quick succession. This means that if you're driving, say, an external DAC directly, and want to supply data (samples) every 20.833 Âµs (corresponding to 48000 Hz), it won't work, as you'll get a significantly shorter sample interval during the 16 times loop, and then a significantly longer (essentially, 0.333 ms minus the time it took the loop to run) time before the next burst of 16 samples.</p>

<p>But let's assume that the DAC has an internal FIFO that is at least 16 samples deep, and that the DAC consumes one sample from the FIFO per sampling interval (i.e. 20.833 Âµs @ 48000 kHz). In that case you could fire off 16 samples from the (implied loop in the) S-rate code, and the DAC would take care of them at the proper sampling interval, operating on one sample per sampling interval from the FIFO.</p>

<p>The point here is that if you want to precisely fire off a hardware event at a determined and constant interval, it won't work with S-rate code. Even K-rate code is dodgy, as the exact interval depends on the execution time of all the modules preceding your module. In some cases, like driving an external shift register to increase the number of GPIOs, when the exact interval is not important, it can be perfectly fine. But if you want drive a DAC to generate a stream of samples you want a very precise interval between the sample output.</p>

<p>(This raises the question of how the Axoloti handles the ADC and DAC in the ADAU1961 codec on the Axoloti board. The answer is that the codec is set up to generate and receive one sample per 48000 kHz sampling interval. The samples are sent using an I2S serial communications line which communicates with an I2S transceiver in the Axoloti. The I2S transceiver is in turn configured to continually send and receive a circular buffer of 32 samples for the DAC and 32 samples for the ADC, and generate an interrupt to the Axoloti firmware every 16 samples. This is what generates the K-rate sampling interval. At every K-rate interrupt, the Axoloti framework switches which half of the 32 sample in- and output buffers which is connected to the input and output modules, respectively. </p>

<p>Essentially, 16 samples from the ADC are accumulated in the input buffer, at the S-rate, which at the next K-rate interrupt are made available for the input module, and processed using the active patch, which in turn writes samples to the output buffer. At the same time, 16 samples from the previous run of the patch are being sent to the DAC. So the patch is constantly working on the 16 samples from the ADC from the previous K-rate interval, and writing 16 samples which will be sent to the DAC at the next K-rate interval.</p>

<p>Technically, the K-rate could be the same as the S-rate. However, this would mean that all processing for a single sample would need to take place at a 20.833 Âµs interval rather than a 0.333 ms interval. There are two reasons why this is not practical. First of all, there is an overhead setting up inputs and outputs etc for all modules, which then occurs for each sample, and not every 16 samples. Secondly, in order to optimze the DSP code, certain parameters are assumed to be constant during a K-rate interval. The resonance parameter for a filter is a good example of this. Limiting the resonance to be constant during a K-rate interval makes it possible to optimize the DSP code for the filter, leading to shorter overall execution times. Also, many processors, although I'm not sure about the ARM Cortex-M4F in the Axoloti, have instructions which can execute several trivial operations in one cycle (SIMD instructions) which can be used to optimize DSP code. Many CPUs have caches which speed up code execution, but they become really useful first when there are (tight) loops in the code. As far as I know though, the Cortex-M4F used in the Axoloti has no cache so this is not relevant.</p>

<p>So all in all, running DSP code in a K-rate vs S-rate environment allows significant optimizations of the code, which one wouldn't get with code processing individual samples all the way at the S-rate.</p>

<p>In fact, the K-rate used in the Axoloti is rather fast. In many DSP systems it can be a factor of 64 slower than the S-rate, or even slower, to minimize overhead, at the cost of increased latency. Indeed, the Axoloti system, with its 3 kHz K-rate, as an end-to-end (analog in to analog out) latency of about 0.333 ms * 2 = 0.667 ms, i.e. significantly less than a millisecond. That's about the same time it takes to transmit two MIDI bytes, of for a sound wave in air to travel about 20 cm.</p>

<p>Sorry for the long winded explanation... )</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/12">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/12</link>
        <pubDate>Sat, 22 Feb 2020 11:05:30 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-12</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@Flub Flo]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/flub">@Flub</a> wrote:</p>
          <blockquote>
              <p><a class="mention" href="/u/weasel79">@weasel79</a> <br>Ah, these are interesting modules. If i would have known that before buying the alfa chips in DIP-14 Housing I would have thinked about buying these instead. But they are also a little more expensive.</p>

<p><a class="mention" href="/u/ricard">@ricard</a> Thank you for that hint. I am not sure if I understood it correctly. What you described would happen if i put the spiSend function inside the S-Rate code tab? <br>Is it possible to rename the thread to "AD5370 16bit 40 Channel DAC"?</p>

<p>Is there a way to execute my code 48000 times per second?<br>Here is the first working version:</p>

<p><a class="attachment" href="//community.axoloti.com/uploads/default/original/2X/3/33b5fc75479b250e84eaed19bf7cc634cf98b154.axp">eval_board-control_dev_11.axp</a> (8.7 KB)</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/11">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/11</link>
        <pubDate>Sat, 22 Feb 2020 09:22:23 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-11</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@jaffasplaffa Mr. Grimm]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/jaffasplaffa">@jaffasplaffa</a> wrote:</p>
          <blockquote>
              <p>Thank you for the clarification, didn't know that <img src="//community.axoloti.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/10">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/10</link>
        <pubDate>Sat, 22 Feb 2020 06:02:21 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-10</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@ricard Ricard Wanderlof]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/ricard">@ricard</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="2" data-topic="6427" data-full="true"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/user_avatar/community.axoloti.com/jaffasplaffa/40/5808_1.png" class="avatar">jaffasplaffa:</div>
<blockquote>
<p>Axoloti editor has 2 fans for  putting code for objects into, one for K-rate, which is 3khz and one for S-rate, which is 48khz.</p>
<p>You can probably just put the code in the 48khz fan and it will be updated at 48khz?</p>
</blockquote></aside>

<p>No, what happens is that the Axoloti framwork puts a 16 times loop around the S-rate code, and runs the whole loop at the K-rate. So the code in the loop will be executed 48000 times per second, but not in a uniform manner, rather, 3000 times per second it will execute 16 times in a row. For some applications this is fine, but it doesn't sound like it would be a good idea if outputting data to one ore more DACs which need a regular sample interval corresponding to 48000 Hz.</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/9">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/9</link>
        <pubDate>Fri, 21 Feb 2020 23:59:02 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-9</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
      <item>
        <title>Increasing the 3khz control rate frequency</title>
        <dc:creator><![CDATA[@weasel79 blender]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://community.axoloti.com/u/weasel79">@weasel79</a> wrote:</p>
          <blockquote>
              <p>thats exciting please keep us updated. maybe oyu wanna do another thread just for the DAC board driver though so its easier to find, since this current thread title is kind of misleading.</p>

<p>i thought you might be using the electro smith modules that also mostly utilize CEM chips:<br><a href="https://www.electro-smith.com/electro-boards" class="onebox" target="_blank" rel="nofollow noopener">https://www.electro-smith.com/electro-boards</a><br>they have a VCO, VCF, VCA and the FV-1 multieffect, all in very basic but super convenient "developement boards". i got a couple of them around and was gonna do something similar to what you're doing i think, use the axoloti as a controller, for UI, LFOs, envelopes etc and just send CVs to the analog submodules. But it looks like the stuff you're using is very similar.</p>
          </blockquote>
          <p><a href="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/8">Read full topic</a></p>
        ]]></description>
        <link>http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427/8</link>
        <pubDate>Fri, 21 Feb 2020 15:49:18 +0000</pubDate>
        <guid isPermaLink="false">community.axoloti.com-post-6427-8</guid>
        <source url="http://community.axoloti.com/t/increasing-the-3khz-control-rate-frequency/6427.rss">Increasing the 3khz control rate frequency</source>
      </item>
  </channel>
</rss>
