<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/midi-to-float-frequency-cenversation-using-mtofextended/6977/5 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jul 2023 03:14:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Midi to (float) frequency cenversation using mtofextended - AxoObject coding - Axoloti Community</title>
    <meta name="description" content="Hi, For some kind of thesis I&amp;#39;m currently working on physical modelling algorithms (mainly Digital Waveguide) and I&amp;#39;m trying to implement some of this on a Axoloti board. It works quite well so far but since I code every&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="../6977.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://sebiik.github.io/community.axoloti.com.backup","potentialAction":{"@type":"SearchAction","target":"https://sebiik.github.io/community.axoloti.com.backup/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Midi to (float) frequency cenversation using mtofextended&#39;" href="../6977.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://sebiik.github.io/community.axoloti.com.backup/user_avatar/community.axoloti.com/lokki/200/5157_1.png" />
<meta property="og:image" content="https://sebiik.github.io/community.axoloti.com.backup/user_avatar/community.axoloti.com/lokki/200/5157_1.png" />
<meta property="og:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/midi-to-float-frequency-cenversation-using-mtofextended/6977/5" />
<meta name="twitter:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/midi-to-float-frequency-cenversation-using-mtofextended/6977/5" />
<meta property="og:title" content="Midi to (float) frequency cenversation using mtofextended" />
<meta name="twitter:title" content="Midi to (float) frequency cenversation using mtofextended" />
<meta property="og:description" content="great! glad you got it sorted. yeah fixed point numbers can be a pain sometimes, and documentation is sparse... maybe here: https://sebiik.github.io/community.axoloti.com.backup/t/coding-axoloti-objects/2606   also, do you plan to release your axoloti work as objects?" />
<meta name="twitter:description" content="great! glad you got it sorted. yeah fixed point numbers can be a pain sometimes, and documentation is sparse... maybe here: https://sebiik.github.io/community.axoloti.com.backup/t/coding-axoloti-objects/2606   also, do you plan to release your axoloti work as objects?" />


  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html"><img src="../../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="../6977.html">Midi to (float) frequency cenversation using mtofextended</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../../c/axoobject-code.html" itemprop="url">
        <span itemprop="title">AxoObject coding</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/lol3000.html'><b itemprop='author'>lol3000</b></a>
           
           <time datetime='2020-12-01T17:56:47Z' itemprop='datePublished'>
             2020-12-01 17:56:47 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi,<br>For some kind of thesis I'm currently working on physical modelling algorithms (mainly Digital Waveguide) and I'm trying to implement some of this on a Axoloti board. It works quite well so far but since I code everything in float, I sometimes struggle with conversions to fixed point.<br>Basically I want to convert a pitch parameter (which should be a midi note) to the corresponding frequency in float. I want to use MTOFEXTENDED() for that to avoid a power calculation but I wasn't able to get good results there. Here is my piece of code: </p>

<p><code>uint32_t p = midi_note*(1&lt;&lt;27);<br>MTOFEXTENDED(p, freq);<br>freq_float = freq*(float)(1.0f/(1&lt;&lt;27))*sample_rate;<br>LogTextMessage("freq = %f \n", freq_float);</code> </p>

<p>So in the first line I want to convert a midi note (integer range 0 to 127) to q5.27 fixed point, then I call mtofextended and in the third line I convert to float and multiply with the sampling frequency to get from a phase increment to an actual frequency. As an output I just get super high numbers, which don't make sense at all. Can anyone tell me what I'm getting wrong here? Is mtofextended probably expecting an other fixed point format than q5.27?<br>Thanks in advance for your help!<br>Best, Flori</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi to (float) frequency cenversation using mtofextended'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/Nosnibor-2.html'><b itemprop='author'>Nosnibor</b></a>
           
           <time datetime='2020-12-01T22:40:22Z' itemprop='datePublished'>
             2020-12-01 22:40:22 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I'd expect the phase increment to be q0.32, i.e. a phase increment of 0x80000000 means half the sample rate. Are your numbers 32 times too high?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi to (float) frequency cenversation using mtofextended'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/lol3000.html'><b itemprop='author'>lol3000</b></a>
           
           <time datetime='2020-12-03T10:19:32Z' itemprop='datePublished'>
             2020-12-03 10:19:32 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hey, thanks for your reply. When I divide the result by 32 I get numbers between 0 an 24000, what makes kind of sense, so the output seems to be q0.32. But it doesn't represent the numbers of the input midi notes at all, so the input seems to be not q5.27 but something different. I will probably try some formats till it works, thanks for your help so far!<br>Is there actually some kind of documentation for built-in functions like mtof and others including input and output datatypes? I couldn't find anything like this.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi to (float) frequency cenversation using mtofextended'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/lol3000.html'><b itemprop='author'>lol3000</b></a>
           
           <time datetime='2020-12-03T11:15:08Z' itemprop='datePublished'>
             2020-12-03 11:15:08 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I solved it! <br>MTOFEXTENDED() seems to expect signed q11.21 values with an offset of 64. So here is my piece of code converting a midi note to a float frequency. </p>

<p><code>uint32_t p = (midi_note - 64)*(1&lt;&lt;21);<br>MTOFEXTENDED(p, freq);<br>freq_float = freq*(1.f/(4*(float)(1&lt;&lt;30)))*sample_rate;</code></p>

<p>Thanks for your advice again with the q0.32 output, it helped a lot. Still there is my question if there is some kind of documentation for these functions? Probably it is also because I did not work a lot with fixed point math so far, but it would be great not to guess all parameter formats <img src="../../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi to (float) frequency cenversation using mtofextended'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/lokki.html'><b itemprop='author'>lokki</b></a>
           
           <time datetime='2020-12-03T12:59:59Z' itemprop='datePublished'>
             2020-12-03 12:59:59 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>great! glad you got it sorted. yeah fixed point numbers can be a pain sometimes, and documentation is sparse... maybe here: <a href="../../coding-axoloti-objects/2606.html">https://sebiik.github.io/community.axoloti.com.backup/t/coding-axoloti-objects/2606</a></p>

<p>also, do you plan to release your axoloti work as objects?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi to (float) frequency cenversation using mtofextended'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/lol3000.html'><b itemprop='author'>lol3000</b></a>
           
           <time datetime='2020-12-03T13:34:23Z' itemprop='datePublished'>
             2020-12-03 13:34:23 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yes I found that post as well but it just mentioned some lookup-table functions without specifying their parameters. I thought there could be probably something a bit more detailed especially about the datatypes that are used internally.</p>

<p>Yes for sure I could release what I'm working on, if there would be an interest in the community <img src="../../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"> <br>How would that work?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Midi to (float) frequency cenversation using mtofextended'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/lokki.html'><b itemprop='author'>lokki</b></a>
           
           <time datetime='2020-12-03T20:37:12Z' itemprop='datePublished'>
             2020-12-03 20:37:12 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>unfortunately i don't think that exists, at least no resource that i would be aware of. for your mentioned problem i would have probably looked at some midi in objects code to see how incoming midi notes are converted, and since you can see (with a disp/dial or similar) what range midi notes cover (-64 to 63) you can figure out the scaling and the math from there. at least this is how i did it. </p>

<p>as for releasing there are two ways i guess, the "better" approach would be to become a contributor and upload your stuff: <a href="../../contributor-access/1039.html">https://sebiik.github.io/community.axoloti.com.backup/t/contributor-access/1039</a></p>

<p>it may take some time until you get the access, so the second way would be to just embed your objects into patches and share the patch in a forum post. if you use includes though, that won't work...</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Midi to (float) frequency cenversation using mtofextended'>
      <hr>
  </div>






    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../../index.html'>Home</a>
        <a href="../../../categories.html">Categories</a>
        <a href="../../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../../tos.html">Terms of Service</a>
        <a href="../../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/midi-to-float-frequency-cenversation-using-mtofextended/6977/5 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jul 2023 03:14:36 GMT -->
</html>
