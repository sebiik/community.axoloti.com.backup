<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/zoom-r16-24-support-in-experimental-branch/4050 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:03:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>ZOOM R16/24 support in experimental branch - Developer - Axoloti Community</title>
    <meta name="description" content="Hi, 

I am trying to include ZOOM R16/24 USB host support for axoloti experimental branch. Object file can be build, but I think it is not linked. Which switch do I need to enable during build to have HAL_USE_USBH := TRU&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="4050.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;ZOOM R16/24 support in experimental branch&#39;" href="4050.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:image" content="http://community.axoloti.com/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:url" content="http://community.axoloti.com/t/zoom-r16-24-support-in-experimental-branch/4050" />
<meta name="twitter:url" content="http://community.axoloti.com/t/zoom-r16-24-support-in-experimental-branch/4050" />
<meta property="og:title" content="ZOOM R16/24 support in experimental branch" />
<meta name="twitter:title" content="ZOOM R16/24 support in experimental branch" />
<meta property="og:description" content="Hi,   I am trying to include ZOOM R16/24 USB host support for axoloti experimental branch. Object file can be build, but I think it is not linked. Which switch do I need to enable during build to have HAL_USE_USBH := TRUE and HAL_USBH_USE_ADDITIONAL_CLASS_DRIVERS := TRUE? The changes in firmware/axoloti_defines.h doesn&#39;t seems to work. What am I doing wrong?   I have done the following changes:   firmware/Makefile: --- a/firmware/Makefile +++ b/firmware/Makefile @@ -234,6 +234,7 @@ CSRC = $(STAR..." />
<meta name="twitter:description" content="Hi,   I am trying to include ZOOM R16/24 USB host support for axoloti experimental branch. Object file can be build, but I think it is not linked. Which switch do I need to enable during build to have HAL_USE_USBH := TRUE and HAL_USBH_USE_ADDITIONAL_CLASS_DRIVERS := TRUE? The changes in firmware/axoloti_defines.h doesn&#39;t seems to work. What am I doing wrong?   I have done the following changes:   firmware/Makefile: --- a/firmware/Makefile +++ b/firmware/Makefile @@ -234,6 +234,7 @@ CSRC = $(STAR..." />


  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="4050.html">ZOOM R16/24 support in experimental branch</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/developer.html" itemprop="url">
        <span itemprop="title">Developer</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Ch1r0n.html'><b itemprop='author'>Ch1r0n</b></a>
           
           <time datetime='2017-12-21T17:42:08Z' itemprop='datePublished'>
             2017-12-21 17:42:08 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi,</p>

<p>I am trying to include ZOOM R16/24 USB host support for axoloti experimental branch.<br>Object file can be build, but I think it is not linked.<br>Which switch do I need to enable during build to have HAL_USE_USBH := TRUE and HAL_USBH_USE_ADDITIONAL_CLASS_DRIVERS := TRUE?<br>The changes in firmware/axoloti_defines.h doesn't seems to work.<br>What am I doing wrong?</p>

<p>I have done the following changes:</p>

<p>firmware/Makefile:<br>--- a/firmware/Makefile<br>+++ b/firmware/Makefile<br>@@ -234,6 +234,7 @@ CSRC = $(STARTUPSRC) \<br>        ${FIRMWARE}/STM32F4xx_HAL_Driver/Src/stm32f4xx_hal_i2c.c \<br>        ${FIRMWARE}/usbh_midi_class.c \<br>        ${FIRMWARE}/usbh_virus_class.c \<br>+       ${FIRMWARE}/usbh_zoom_class.c \<br>        ${FIRMWARE}/usbh_conf.c \<br>        ${FIRMWARE}/serial_midi.c \<br>        ${FIRMWARE}/spilink.c \<br>~</p>

<hr>

<p>firmware/axoloti_defines.h<br>--- a/firmware/axoloti_defines.h                                                                                                                                                                                                          <br>+++ b/firmware/axoloti_defines.h                                                                                                                                                                                                          <br>@@ -34,4 +34,7 @@ typedef int32_t int32buffer[BUFSIZE];<br> <span class="hashtag">#define</span> FWVERSION3 0<br> <span class="hashtag">#define</span> FWVERSION4 1</p>

<p>+#define HAL_USE_USBH TRUE<br>+#define HAL_USBH_USE_ADDITIONAL_CLASS_DRIVERS TRUE<br>+<br> <span class="hashtag">#endif</span></p>

<hr>

<p>firmware/usbh_additional_class_drivers.h<br>--- a/firmware/usbh_additional_class_drivers.h<br>+++ b/firmware/usbh_additional_class_drivers.h<br>@@ -18,19 +18,20 @@<br> <span class="hashtag">#include</span> "hal_usbh.h"<br> <span class="hashtag">#include</span> "usbh_midi_class.h"</p>

<p>-#if HAL_USE_USBH &amp;&amp; HAL_USBH_USE_ADDITIONAL_CLASS_DRIVERS<br>+/*#if HAL_USE_USBH &amp;&amp; HAL_USBH_USE_ADDITIONAL_CLASS_DRIVERS*/</p>

<p> /* Declarations */<br> extern const usbh_classdriverinfo_t usbhMidiClassDriverInfo;<br> extern const usbh_classdriverinfo_t usbhVirusClassDriverInfo;<br>+extern const usbh_classdriverinfo_t usbhZoomClassDriverInfo;</p>

<p> /* Comma separated list of additional class drivers */<br> <span class="hashtag">#define</span> HAL_USBH_ADDITIONAL_CLASS_DRIVERS \<br>-       &amp;usbhMidiClassDriverInfo, &amp;usbhVirusClassDriverInfo, <br>+       &amp;usbhMidiClassDriverInfo, &amp;usbhVirusClassDriverInfo, &amp;usbhZoomClassDriverInfo, </p>

<p>-#endif<br>+/*#endif*/</p>

<p> <span class="hashtag">#endif</span> /* USBH_ADDITIONAL_H_ */</p>

<hr>

<p>and added<br>firmware/usbh_zoom_class.c<br>looks quite like the virus one.</p>

<p>Thanks.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='ZOOM R16/24 support in experimental branch'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2017-12-21T18:24:53Z' itemprop='datePublished'>
             2017-12-21 18:24:53 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>you dont need to define it, its already defined as true in halconf_community.h</p>

<p>note: ive not had time to spend on this recently, but back in September, I got the virus working successfully.<br>so id hope/assume that has not changed... i.e. you will not need to 'enable' anything, just add your class.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='ZOOM R16/24 support in experimental branch'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Ch1r0n.html'><b itemprop='author'>Ch1r0n</b></a>
           
           <time datetime='2017-12-21T18:30:21Z' itemprop='datePublished'>
             2017-12-21 18:30:21 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi <a class="mention" href="../../u/thetechnobear.html">@thetechnobear</a>,</p>

<p>thank you for fast reply. May be I am doing s.th. other wrong. Is there a kind of make menuconfig to configure Axoloti firmware?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='ZOOM R16/24 support in experimental branch'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2017-12-21T18:36:28Z' itemprop='datePublished'>
             2017-12-21 18:36:28 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="3" data-topic="4050"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../letter_avatar_proxy/v2/letter/c/3ec8ea/40.png" class="avatar">Ch1r0n:</div>
<blockquote><p>Is there a kind of make menuconfig to configure Axoloti firmware?</p></blockquote></aside>

<p>nope...</p>

<p>you should just need to add to the firmware makefile, then you add you 'driver class' to that list, then the load function gets called which provides the various ids to find the device.</p>

<p>what makes you think its not linked? <br>is your init/load not getting called? (that'd be the first thing id check) </p>

<p>sorry, cant get to a machine with axo at the moment.... but assuming nothing odd has change since when I last tried, it should be fairly straightforward (as far as i remember <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"> )</p>

<p>EDIT: just one important note... as you have seen the framework is completely different to 1.0.12, so dont assume because something worked in 1.0.12 it will work here... we actually found quite a few (low level) oddities back in September, which caused some odd issues with some devices, but others were perfectly fine.<br>I think in the end it was pretty stable, but it was not all plain sailing <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='ZOOM R16/24 support in experimental branch'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Ch1r0n.html'><b itemprop='author'>Ch1r0n</b></a>
           
           <time datetime='2017-12-21T18:44:00Z' itemprop='datePublished'>
             2017-12-21 18:44:00 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I added debug outputs in several stages, where I thought the code would be called. But nothing had been printed out.<br>To be able to build the code successfully it was a long way on Ubuntu Studio. I have to double check the compiler messages...</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='ZOOM R16/24 support in experimental branch'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2017-12-21T18:59:26Z' itemprop='datePublished'>
             2017-12-21 18:59:26 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>IIRC there were quite a few warnings. <br>What i would do first, is check the firmware is working as you expect with a usb class compliant device ..: just in case it’s something unrelated to your code<br>Are you using an stlink? It’s the most reliable way to get the trace output etc.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='ZOOM R16/24 support in experimental branch'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Ch1r0n.html'><b itemprop='author'>Ch1r0n</b></a>
           
           <time datetime='2017-12-21T19:09:22Z' itemprop='datePublished'>
             2017-12-21 19:09:22 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Unfortunately, I don't have access to a real debugger. I am using uinfof().</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='ZOOM R16/24 support in experimental branch'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2017-12-21T21:07:32Z' itemprop='datePublished'>
             2017-12-21 21:07:32 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>uinfof() is currently outputting in serial on gpio PA2, you need a TTL-serial cable to read it.<br>Modifying the usb-host code to dump diagnostics to the axoloti main window over USB is pretty high on my todo list.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='ZOOM R16/24 support in experimental branch'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Ch1r0n.html'><b itemprop='author'>Ch1r0n</b></a>
           
           <time datetime='2017-12-22T16:31:59Z' itemprop='datePublished'>
             2017-12-22 16:31:59 UTC
           </time>
        </span>
        <span itemprop='position'>#9</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Ah, that is why I can't see anything in axoloti main window. 115200 8N1 for serial communication?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='ZOOM R16/24 support in experimental branch'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2017-12-22T18:48:49Z' itemprop='datePublished'>
             2017-12-22 18:48:49 UTC
           </time>
        </span>
        <span itemprop='position'>#10</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>yes, 115200 8N1, transmitting on PA2</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='ZOOM R16/24 support in experimental branch'>
      <hr>
  </div>






    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/zoom-r16-24-support-in-experimental-branch/4050 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:03:37 GMT -->
</html>
