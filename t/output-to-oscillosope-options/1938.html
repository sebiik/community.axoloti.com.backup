<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/output-to-oscillosope-options/1938 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:05:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Output to Oscillosope options - Hardware - Axoloti Community</title>
    <meta name="description" content="All, Am looking for a way to be able to tap into sections of a patch in development as output to an external oscilloscope for viewing. My first thought was to use the 2 Analogue outputs that would even give a 2 channel v&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="1938.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Output to Oscillosope options&#39;" href="1938.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:image" content="http://community.axoloti.com/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:url" content="http://community.axoloti.com/t/output-to-oscillosope-options/1938" />
<meta name="twitter:url" content="http://community.axoloti.com/t/output-to-oscillosope-options/1938" />
<meta property="og:title" content="Output to Oscillosope options" />
<meta name="twitter:title" content="Output to Oscillosope options" />
<meta property="og:description" content="All, Am looking for a way to be able to tap into sections of a patch in development as output to an external oscilloscope for viewing. My first thought was to use the 2 Analogue outputs that would even give a 2 channel view, but based on what I have found on the forums, this will only transmit at 3kHZ which may not give a very effective resolution. The other option is to use the Audio outputs as mono&#39;s which is how I have it setup anyway, but this would only give me one channel, and will limit w..." />
<meta name="twitter:description" content="All, Am looking for a way to be able to tap into sections of a patch in development as output to an external oscilloscope for viewing. My first thought was to use the 2 Analogue outputs that would even give a 2 channel view, but based on what I have found on the forums, this will only transmit at 3kHZ which may not give a very effective resolution. The other option is to use the Audio outputs as mono&#39;s which is how I have it setup anyway, but this would only give me one channel, and will limit w..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="4 ❤" />


  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="1938.html">Output to Oscillosope options</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/hardware.html" itemprop="url">
        <span itemprop="title">Hardware</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Gavin.html'><b itemprop='author'>Gavin</b></a>
           
           <time datetime='2016-07-01T03:48:02Z' itemprop='datePublished'>
             2016-07-01 03:48:02 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>All, Am looking for a way to be able to tap into sections of a patch in development as output to an external oscilloscope for viewing.<br>My first thought was to use the 2 Analogue outputs that would even give a 2 channel view, but based on what I have found on the forums, this will only transmit at 3kHZ which may not give a very effective resolution.<br>The other option is to use the Audio outputs as mono's which is how I have it setup anyway, but this would only give me one channel, and will limit what I can do with the Audio path, or use the Headphone output, but this is limited to the position of the outputs in the Audio path as well and won't give the option of freely tapping into sections of the patch.<br>OR, am I completely misrepresenting what the Axo may have to offer here ?</p>

<p>P.S. Am learning look closer at the signal path, so as to learn more about what is happening as the signal is manipulated through the path. Seems to be a natural progression to understanding what the Axo can do.</p>

<p>Thanks..</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Output to Oscillosope options'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/the19thbear.html'><b itemprop='author'>the19thbear</b></a>
           
           <time datetime='2016-07-01T05:20:09Z' itemprop='datePublished'>
             2016-07-01 05:20:09 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Why not use the virtual scope? It's called scope:)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Output to Oscillosope options'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Gavin.html'><b itemprop='author'>Gavin</b></a>
           
           <time datetime='2016-07-01T07:02:43Z' itemprop='datePublished'>
             2016-07-01 07:02:43 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Because I get a lot more info from an oscilloscope.<br>And this is no complaints about it, its great, but because I play the base guitar I don't get much of the signal on the scope, plus I can use the spectrum analyzer also on the oscilloscope, but I have found the spectrum analyzer in a patch extremely useful, but takes up a lot of resources from the scope. So I just get worried about causing problems by putting to much load on the patch.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Output to Oscillosope options'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-07-01T09:55:01Z' itemprop='datePublished'>
             2016-07-01 09:55:01 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This is an interesting question... more broadly, how fast could the GPIO pins be driven?</p>

<p>Im assuming the 3kHz rate, is just quoted, as the control rate... but presumably this could be exceeded in the same way as audio is, i.e. you write to a buffer that is N bytes, giving you 3xN kHz.<br>so then the question is, <br>a) whats the limit from the STM32F4?<br>b) is there a way to get chibios to read this buffer, and write to the pins at a guaranteed rate?<br>I guess (b) is the problem area...</p>

<p>(a) could be found in the STM ref quite, (b) in the chibios documentation , though I guess <a class="mention" href="../../users/johannes.html">@johannes</a> already knows the answers <img src="../../images/emoji/emoji_one/slight_smile5e1f.png?v=2" title=":slight_smile:" class="emoji" alt=":slight_smile:"> </p>

<p>theres a few areas, Id like to go look at...<br>go check the current audio code, is it the responsibility of the codec to guarantee the timing of 16 byte buffer?) , how would things like usb audio, or audio via X3 work (I2S?) ... how do/would they reliably clock?<br>if this is controllable, then again, writing the gpio pins would seem possible in a similar way.<br>(and are easier(?) since your not caring about syncing any clocks, you just want steady timing)</p>

<p>as for the problem space...<br>if your using mono, can't you use the other channel as an data channel?<br>(unfortunately the headphone socket is hardwired to the audio output iirc, and the additional aux channel too)<br>on the other side, many signals on axoloti are control rate, so reporting at higher rates wont buy you anything, but I'm assuming your talking about audio rate signals.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Output to Oscillosope options'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-07-01T12:00:46Z' itemprop='datePublished'>
             2016-07-01 12:00:46 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Driving the <em>on-chip</em> DACs at audio rate is not implemented, and requires a substantial compromise, and ultimately I do not expect good audio quality.</p>

<p>(warning: deep tech talk ahead...)</p>

<p>Here are some pointers for anyone interested in implementing this. It goes quite deep as it involves combining SAI, DAC, GPIO, DMA, Timer, documented in STM32F4 reference manual DM00031020.pdf.</p>

<p><strong>Triggering</strong></p>

<p>The DAC's can be triggered (DM00031020.pdf section 14.3.6), but none of the possible trigger sources is already connected to the codec sample sync (PE4_SAI1_FS_A, available on X4). </p>

<ul>
<li>One way around is connecting PE4_SAI1_FS_A to PB9, which is configurable as a trigger source as "EXTI line9". </li>
<li>Another potential way is enabling codec sample sync output on PF9 (alternate function SAI1_FS_B), that's a free pad, and configuring that as a trigger source for "EXTI line9", but both SAI1A and SAI1B are in slave mode, SAI1B is configured to be synchronous to SAI1A ("SYNCEN"), and the documentation says, when synchronous it must be slave too. In slave mode, FS is an input, not an output. Maaaaybe it works as an output when configuring SAI1B as synchronized to SAI1A but in master mode, but the documentation does not specify, only says don't do it. </li>
<li>One of the on-chip Timers could be "softsynced" at audio buffer boundaries (SAI DMA interrupt) to generate something close to sample sync, and used as a trigger for the on-chip DAC.</li>
</ul>

<p><strong>Feeding data</strong></p>

<ul>
<li>The DMA1 streams 5 and 6 are the only ones that can be used for the on-chip DACs. They're currently configured to be used with I2C1, available on the Axoloti Core gpio pins, one DMA stream can not be used for two things at the same time. One workaround is moving I2C1 to use interrupts rather than DMA, freeing up DMA1 streams 5 and 6 for the DAC. Chibios 2.x does not support I2C via interrupts. Also I2C via interrupt is far less efficient than using DMA.</li>
<li>Alternative: using the DAC interrupt to feed it data, but that's far less efficient than using DMA.</li>
</ul>

<p>If someone wants to develop an implementation, I'd welcome such contribution, but since the DMA streams conflict with I2C1, I think it 'd be best if it's kept optional.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Output to Oscillosope options'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Reggie.html'><b itemprop='author'>Reggie</b></a>
           
           <time datetime='2016-07-28T23:08:01Z' itemprop='datePublished'>
             2016-07-28 23:08:01 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I don't have the coding skill but I've seen STM32 code for a pt8211 audio DAC chip using SPI that might be useful to someone, <a href="http://www.stm32duino.com/viewtopic.php?t=519" rel="nofollow">http://www.stm32duino.com/viewtopic.php?t=519</a> and <a href="https://forum.pjrc.com/threads/29284-Dual-channel-16bit-dac-PT8211" rel="nofollow">https://forum.pjrc.com/threads/29284-Dual-channel-16bit-dac-PT8211</a> for an i2s version of code.  The pt8211 chips are incredibly cheap as well, I picked up 20 for a few ££.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Output to Oscillosope options'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-07-31T13:38:27Z' itemprop='datePublished'>
             2016-07-31 13:38:27 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>About the PT8211: this is quite a bit more involved than copying some source code for pt8211, need to synchronize the sample clock, and buffer-timing to the on-board audio ADC/DAC. Looking at the datasheet, I expect disappointing sound quality from this chip as it does not have a reconstruction filter at all. It is possible to implement a reconstruction filter in firmware, and oversample the convertor at 8x normal sample rate. But that makes it more complicated to synchronize with the on-board audio ADC/DAC.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Output to Oscillosope options'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Reggie.html'><b itemprop='author'>Reggie</b></a>
           
           <time datetime='2016-07-31T13:47:35Z' itemprop='datePublished'>
             2016-07-31 13:47:35 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi <a class="mention" href="../../users/johannes.html">@johannes</a>  of course, I didn't necessarily expect it to be easy, I was just pointing out options where other work was being done, it's good to share ideas from time to time imho <img src="../../images/emoji/emoji_one/smile5e1f.png?v=2" title=":smile:" class="emoji" alt=":smile:">  I will take a look soon and see what the quality is like on a teensy board, I've got 20 of those chips to mess around with.</p>

<p>I'm quite interested in getting CV in/out of the axoloti, obviously one of these chips would be quite wasteful for that purpose but a 4/8 output dac would be very useful.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Output to Oscillosope options'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-07-31T13:58:45Z' itemprop='datePublished'>
             2016-07-31 13:58:45 UTC
           </time>
        </span>
        <span itemprop='position'>#9</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Perhaps check the MAX11300 chip and  MAX11300PMB1 evaluation board, more expensive than pt8211, and certainly not made for audio, but a huge number of CV in- and output channels. I have not tested this, but others have: <a href="../max11300-for-cv-in-and-cv-out/1568.html">http://community.axoloti.com/t/max11300-for-cv-in-and-cv-out/1568</a></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Output to Oscillosope options'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Reggie.html'><b itemprop='author'>Reggie</b></a>
           
           <time datetime='2016-07-31T14:07:23Z' itemprop='datePublished'>
             2016-07-31 14:07:23 UTC
           </time>
        </span>
        <span itemprop='position'>#10</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="../../users/johannes.html">@johannes</a> I've read that thread, I'm going to keep an eye on it, I'm hoping that someone might make a kit with a PCB and pre-programmed 11300 chip...</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Output to Oscillosope options'>
      <hr>
  </div>






    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/output-to-oscillosope-options/1938 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:05:54 GMT -->
</html>
