<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/fastest-way-to-convert-to-from-int32-and-float-in-0-1-range/1679/2 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:05:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Fastest way to convert to/from int32 and float in 0-1 range - AxoObject coding - Axoloti Community</title>
    <meta name="description" content="The question is in the title, really. I&amp;#39;d like it be able to convert an inlet value (int32) to a floating-point number in the range 0 &amp;gt; 1, then convert that back to an int32 in the correct range. 

Sorry if it&amp;#39;s a naive &amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="../1679.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Fastest way to convert to/from int32 and float in 0-1 range&#39;" href="../1679.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/user_avatar/community.axoloti.com/jeromeb/200/6792_1.png" />
<meta property="og:image" content="http://community.axoloti.com/user_avatar/community.axoloti.com/jeromeb/200/6792_1.png" />
<meta property="og:url" content="http://community.axoloti.com/t/fastest-way-to-convert-to-from-int32-and-float-in-0-1-range/1679/2" />
<meta name="twitter:url" content="http://community.axoloti.com/t/fastest-way-to-convert-to-from-int32-and-float-in-0-1-range/1679/2" />
<meta property="og:title" content="Fastest way to convert to/from int32 and float in 0-1 range" />
<meta name="twitter:title" content="Fastest way to convert to/from int32 and float in 0-1 range" />
<meta property="og:description" content="Can you please give an example you want to do this ?   Knowing that :       are you sure you need this ?   In C, with float to int32 conversion, you will loose the fractional part.   But maybe I did not understand the question. ðŸ™‚" />
<meta name="twitter:description" content="Can you please give an example you want to do this ?   Knowing that :       are you sure you need this ?   In C, with float to int32 conversion, you will loose the fractional part.   But maybe I did not understand the question. ðŸ™‚" />

      <link rel="next" href="../16794658.html?page=2">

  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html"><img src="../../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="../1679.html">Fastest way to convert to/from int32 and float in 0-1 range</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../../c/axoobject-code.html" itemprop="url">
        <span itemprop="title">AxoObject coding</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-05-12T10:46:28Z' itemprop='datePublished'>
             2016-05-12 10:46:28 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The question is in the title, really. I'd like it be able to convert an inlet value (int32) to a floating-point number in the range 0 &gt; 1, then convert that back to an int32 in the correct range.</p>

<p>Sorry if it's a naive question.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/JeromeB.html'><b itemprop='author'>JeromeB</b></a>
           
           <time datetime='2016-05-12T11:25:09Z' itemprop='datePublished'>
             2016-05-12 11:25:09 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Can you please give an example you want to do this ?</p>

<p>Knowing that : <br></p>

<aside class="quote" data-post="1" data-topic="800"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/community.axoloti.com/sonicdebris/40/1044_1.png" class="avatar"><a href="../../doubts-about-fixed-point-representation-and-operations/800/1.html">Doubts about fixed point representation and operations</a>
</div>
<blockquote><p>So, the [64.0,64.0[ range "behaves" as it is a [-1.0,1.0[ range.</p></blockquote></aside>

<p>are you sure you need this ?</p>

<p>In C, with float to int32 conversion, you will loose the fractional part.</p>

<p>But maybe I did not understand the question. <img src="../../../images/emoji/emoji_one/slight_smile5e1f.png?v=2" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
            <a href="../../load-floats-into-table-sdram-from-file-with-constant-multiplier/5060/2.html">Load floats into table(SDRAM) from file with constant multiplier</a>
            <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-05-12T11:54:18Z' itemprop='datePublished'>
             2016-05-12 11:54:18 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Something like this works:</p>

<pre><code>float in1f = inlet_inlet1*(float)(1.0f/(1&lt;&lt;27));
float out1f = in1f*in1f; // example : square function
outlet_outlet1 = (int)(out1f*(float)(1&lt;&lt;27));</code></pre>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-05-12T11:55:00Z' itemprop='datePublished'>
             2016-05-12 11:55:00 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi JeromeB,</p>

<p>thanks for getting back to me so quickly.</p>

<p>I have two things I want to use this for:</p>

<ol>
<li>Create an object that applies an exponential/pow interpolation with an adjustable exponent to the inlet value and sends it out the outlet</li>
<li>Create an envelope with variable curve attack/decay.</li>
</ol>

<p>I thought the exp/pow part might be more easily achieved in floating-point, but it would require converting all variables to fp in the 0 &gt; 1 range, hence my question.</p>

<p>I hope this makes sense. I'm used to working with floating-point values, but unfamiliar with fixed-point mathematics (and it's confusing the hell out of me, currently)...</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-05-12T12:08:23Z' itemprop='datePublished'>
             2016-05-12 12:08:23 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thank you, that's great!<br>I was aware of the 1/n method, but was wondering if there was a more efficient way to do it, avoiding division (which I vaguely understand is expensive).</p>

<p><a class="mention" href="../../../users/jeromeb.html">@JeromeB</a></p>

<p>This is what I had in mind.</p>

<p><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/1d806bc28643add4f13e55613d1984c545cc5a52" href="../../../uploads/default/original/2X/1/1d806bc28643add4f13e55613d1984c545cc5a52.png" class="lightbox" title="Screen Shot 2016-05-12 at 13.03.36.png"><img src="../../../uploads/default/optimized/2X/1/1d806bc28643add4f13e55613d1984c545cc5a52_1_635x499.png" width="635" height="499"><div class="meta">
<span class="filename">Screen Shot 2016-05-12 at 13.03.36.png</span><span class="informations">2454x1930 268 KB</span><span class="expand"></span>
</div></a></div><br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/2c34af77e51f0715bd812a2d10b7d341c5cc1797" href="../../../uploads/default/original/2X/2/2c34af77e51f0715bd812a2d10b7d341c5cc1797.png" class="lightbox" title="Screen Shot 2016-05-12 at 13.03.51.png"><img src="../../../uploads/default/optimized/2X/2/2c34af77e51f0715bd812a2d10b7d341c5cc1797_1_635x499.png" width="635" height="499"><div class="meta">
<span class="filename">Screen Shot 2016-05-12 at 13.03.51.png</span><span class="informations">2454x1930 255 KB</span><span class="expand"></span>
</div></a></div> <br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/b6a8781c974110a083fe623d59552dcc08e32f25" href="../../../uploads/default/original/2X/b/b6a8781c974110a083fe623d59552dcc08e32f25.png" class="lightbox" title="Screen Shot 2016-05-12 at 13.04.00.png"><img src="../../../uploads/default/optimized/2X/b/b6a8781c974110a083fe623d59552dcc08e32f25_1_635x499.png" width="635" height="499"><div class="meta">
<span class="filename">Screen Shot 2016-05-12 at 13.04.00.png</span><span class="informations">2454x1930 273 KB</span><span class="expand"></span>
</div></a></div></p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:2'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-05-12T12:15:00Z' itemprop='datePublished'>
             2016-05-12 12:15:00 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Not sure how smart the compiler is, the compiler can do fixed-float conversion to a single instruction<br><a href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0553a/CHDJAEDB.html" class="onebox" target="_blank" rel="nofollow">http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0553a/CHDJAEDB.html</a><br>Square should be fast, square root too, but I expect a powf(x,y) call to be expensive.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-05-12T13:04:15Z' itemprop='datePublished'>
             2016-05-12 13:04:15 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Do you think it would be cheaper to do some kind of fixed-point lookup-table based approximation of the top and bottom curves, then lerp between them?</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-05-12T13:51:47Z' itemprop='datePublished'>
             2016-05-12 13:51:47 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>A lookup table will be slower than a square, both in fixed or floating point.<br>For square root there is a cpu instruction for float, taking <a href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0553a/CIHJJEIH.html" rel="nofollow">14 cycles</a> rather than one. For fixed point this does not exist.<br>I'd suggest to interpolate between<br><code>y=2*x-x*x</code><br>and<br><code>y=x*x</code><br>avoiding a square root, but perhaps close enough<br>so <br><code>y=a*(2*x-x*x)+(1-a)(x*x)</code><br>or the equivalent<br><code>y=2*a*(x-x*x)+x*x</code></p>

<p><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/d98b395342114717bd1a14a641a46426e9d8667b" href="../../../uploads/default/original/2X/d/d98b395342114717bd1a14a641a46426e9d8667b.png" class="lightbox" title="Pasted image"><img src="../../../uploads/default/optimized/2X/d/d98b395342114717bd1a14a641a46426e9d8667b_1_690x388.png" width="690" height="388"><div class="meta">
<span class="filename">Pasted image</span><span class="informations">1676x943 186 KB</span><span class="expand"></span>
</div></a></div></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:2'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-05-12T14:15:27Z' itemprop='datePublished'>
             2016-05-12 14:15:27 UTC
           </time>
        </span>
        <span itemprop='position'>#9</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Cool, thank you very much, <a class="mention" href="../../../users/johannes.html">@johannes</a>. I'll give that a try and see how far I get.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-05-12T15:16:55Z' itemprop='datePublished'>
             2016-05-12 15:16:55 UTC
           </time>
        </span>
        <span itemprop='position'>#10</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Apparently, there's a builtin Cortex M4 floating point square root function.<br><a href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0553a/CHDHHAJF.html" class="onebox" target="_blank" rel="nofollow">http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0553a/CHDHHAJF.html</a><br>so I guess</p>

<p><code>(float)sqrt = __VSQRT(in);</code></p>

<p>would work.</p>

<p>I'd quite like to make the curves more extreme (i.e. cube/cube root), but I can't work out if there's a way of approximating a cube root without division, as you've done with square root.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-05-12T15:49:01Z' itemprop='datePublished'>
             2016-05-12 15:49:01 UTC
           </time>
        </span>
        <span itemprop='position'>#11</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="10" data-topic="1679"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/t/b9e5f3/40.png" class="avatar">toneburst:</div>
<blockquote><p>(float)sqrt = __VSQRT(in);</p></blockquote></aside>

<p>i thought with the compiler options we are using , you should be able to use math.h functions for these things... no?<br>(-mcpu=cortex-m4 -mfloat-abi=hard -mfpu=fpv4-sp-d16 -mthumb  ) </p>

<p>fyi: math/sqrt uses</p>

<pre><code> float aif = ai;
 aif *= (1&lt;&lt;27);
 aif = _VSQRTF(air);</code></pre>

<p>also for: </p>

<pre><code> float in1f = inlet_inlet1*(float)(1.0f/(1&lt;&lt;27));</code></pre>

<p>id assume the compiler will replace 1/ (1 &lt;&lt; 27) with a constant, so there wont be a division on execution just the multiplication.</p>

<p>or am i expecting too much of compilers  ?</p>

<p>EDIT: Im interested in this, as Ive been messing with the same thing today, also for looking a envelopes with adjustable curves.  I do like <a class="mention" href="../../../users/johannes.html">@johannes</a> solution... but yeah, would be nice to have more extreme curves.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-05-12T16:22:01Z' itemprop='datePublished'>
             2016-05-12 16:22:01 UTC
           </time>
        </span>
        <span itemprop='position'>#12</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="11" data-topic="1679"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/community.axoloti.com/thetechnobear/40/6_1.html" class="avatar">thetechnobear:</div>
<blockquote><p>EDIT: Im interested in this, as Ive been messing with the same thing today, also for looking a envelopes with adjustable curves.  I do like <a class="mention" href="../../../users/johannes.html">@johannes</a> solution... but yeah, would be nice to have more extreme curves.</p></blockquote></aside>

<p>Interesting. I Might just leave this to you, then, I'm sure you'll make a better job.</p>

<p>One thing that did occur to me is that if you were to add a trigger outlet to, for example, an AD envelope object, so it sent out a pulse when the envelope moved from Attack to Decay phase, you could then use that in combination with the linear &gt; exp interpolation object above and a multiplexer to have adjustable curves for the A and D stages of the envelope.</p>

<p>Even better, the envelope could send out an int value indicating the current envelope stage.</p>

<p>An envelope with integrated adjustable curves for each section would be neater, of course..</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-05-12T16:37:40Z' itemprop='datePublished'>
             2016-05-12 16:37:40 UTC
           </time>
        </span>
        <span itemprop='position'>#13</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="12" data-topic="1679"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/t/b9e5f3/40.png" class="avatar">toneburst:</div>
<blockquote><p>One thing that did occur to me is that if you were to add a trigger outlet to, for example, an AD envelope object, so it sent out a pulse when the envelope moved from Attack to Decay phase,</p></blockquote></aside>

<p>he, he... I think we have been on a very similar thought train today, spooky really...</p>

<p>basically, after doing the cycle ad object, Id thought about enhancing it, <br>and this led me to looking at the manuals for  make noise function and maths as inspiration...<br>so was looking at implementing these</p>

<p>yes, the function, has an EOR (end of rise) outlet, which is as you say a trigger at the end of the attack phase.</p>

<p>it also has a exp/lin knob which has exp to lin curve effect on the rise/fall.</p>

<p>and thats, what caught my eye here... as you were basically after the same thing.</p>

<p><a class="mention" href="../../../users/johannes.html">@johannes</a> , so when I started to look at this, I started looking at CMSIS (arm_math) for some interesting functions... but I noticed if I called arm_sqrt_f32, that it doesnt resolve sqrtf()... ok, i assume this is because we don't link in against the math lib... but actually it should not be trying to use sqrtf, it should be using  <em>_sqrtf  , <span class="bbcode-s">because we have an fpu, but this seems to mean that __ FPU _PRESENT should be defined. Ive no familiarity with CMSIS... but should we be defining this to ensure when CMSIS is used, its 'optimised' for fpu.</span>.. ok, noticed FPU</em>PRESENT is defined, different issue <img src="../../../images/emoji/emoji_one/slight_smile5e1f.png?v=2" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-05-12T17:17:51Z' itemprop='datePublished'>
             2016-05-12 17:17:51 UTC
           </time>
        </span>
        <span itemprop='position'>#14</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Good we're thinking along the same lines.</p>

<aside class="quote" data-post="13" data-topic="1679"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/community.axoloti.com/thetechnobear/40/6_1.html" class="avatar">thetechnobear:</div>
<blockquote><p>it also has a exp/lin knob which has exp to lin curve effect</p></blockquote></aside>

<p>Cool. I think what we both want is a log to exp control (with linear in the middle), though, which is quite rare in the synth hardware world, but nonetheless quite cool, particularly for percussion sounds. Having seperate curve controls for both rising and falling segments will be really handy too, I'm sure.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-05-12T18:38:52Z' itemprop='datePublished'>
             2016-05-12 18:38:52 UTC
           </time>
        </span>
        <span itemprop='position'>#15</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I made a "workbench patch" to measure cpu cycles consumed by various operations.<br>My observations so far:</p>

<ul>
<li>Explicitly calling the <code>VCVT</code> instruction saves cycles compared to "plain" c conversion.</li>
<li>
<code>powf()</code> is very expensive</li>
<li>
<code>f&gt;0?f:-f</code> is worse than <code>fabs(f)</code>
</li>
<li>
<code>fsinf(f)</code> is not very unreasonable at 71 cycles/call</li>
</ul>

<p>The workbench patch is in axoloti-contrib/patches/jt/devel/float_workbench.axp<br>Feel free to extend it, or question my observations.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-05-12T19:10:53Z' itemprop='datePublished'>
             2016-05-12 19:10:53 UTC
           </time>
        </span>
        <span itemprop='position'>#16</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>For more extreme curves, let me suggest<br><code>y=a*(x^3) + (1-a)*(1-(1-x)^3)</code><br>or<br><code>y=a*(x^4) + (1-a)*(1-(1-x)^4)</code></p>

<p>None of these will give you a vertical asymptote at x=0 like sqrt.<br>But all of them will give you a horizontal n-the degree continuity at x=1 (when a=1), that is a potentially desirable property for an attack curve.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:2'>
      <meta itemprop='interactionCount' content='UserComments:3'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/JeromeB.html'><b itemprop='author'>JeromeB</b></a>
           
           <time datetime='2016-05-12T19:42:16Z' itemprop='datePublished'>
             2016-05-12 19:42:16 UTC
           </time>
        </span>
        <span itemprop='position'>#17</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>That's what I thought : I did not understand ! <img src="../../../images/emoji/emoji_one/smile5e1f.png?v=2" title=":smile:" class="emoji" alt=":smile:"><br>Your int32 inlet is a fixed point number, not an integer, ok.<br>I think, you found the two best people to answer your question ! <img src="../../../images/emoji/emoji_one/wink5e1f.png?v=2" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-05-12T19:46:41Z' itemprop='datePublished'>
             2016-05-12 19:46:41 UTC
           </time>
        </span>
        <span itemprop='position'>#18</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="../../../users/jeromeb.html">@JeromeB</a> Hehe... Yep, fell on my feet, there...</p>

<p>I was under the impression that the inlets internally are integers, but are represented outside the object as fixed-point fractional numbers. I've been making that assumption so far, anyway, and it seems to have worked out ok...</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-05-12T20:23:56Z' itemprop='datePublished'>
             2016-05-12 20:23:56 UTC
           </time>
        </span>
        <span itemprop='position'>#19</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="16" data-topic="1679"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/community.axoloti.com/johannes/40/8_1.html" class="avatar">johannes:</div>
<blockquote><p>y=a*(x^3) + (1-a)*(1-(1-x)^3)</p></blockquote></aside>

<p><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/5b4de9354412d3d3636322b01530dc301d2e1527" href="../../../uploads/default/original/2X/5/5b4de9354412d3d3636322b01530dc301d2e1527.png" class="lightbox" title="Screen Shot 2016-05-12 at 21.21.42.png"><img src="../../../uploads/default/optimized/2X/5/5b4de9354412d3d3636322b01530dc301d2e1527_1_690x484.png" width="690" height="484"><div class="meta">
<span class="filename">Screen Shot 2016-05-12 at 21.21.42.png</span><span class="informations">1150x807 73 KB</span><span class="expand"></span>
</div></a></div><br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/a299268bf623f258b0712e6c294fd72435671e01" href="../../../uploads/default/original/2X/a/a299268bf623f258b0712e6c294fd72435671e01.png" class="lightbox" title="Screen Shot 2016-05-12 at 21.22.10.png"><img src="../../../uploads/default/optimized/2X/a/a299268bf623f258b0712e6c294fd72435671e01_1_690x484.png" width="690" height="484"><div class="meta">
<span class="filename">Screen Shot 2016-05-12 at 21.22.10.png</span><span class="informations">1150x807 72.4 KB</span><span class="expand"></span>
</div></a></div><br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/c95f6564760ddf3d7668241b6ecd9e66190a42df" href="../../../uploads/default/original/2X/c/c95f6564760ddf3d7668241b6ecd9e66190a42df.png" class="lightbox" title="Screen Shot 2016-05-12 at 21.22.22.png"><img src="../../../uploads/default/optimized/2X/c/c95f6564760ddf3d7668241b6ecd9e66190a42df_1_690x484.png" width="690" height="484"><div class="meta">
<span class="filename">Screen Shot 2016-05-12 at 21.22.22.png</span><span class="informations">1150x807 72.7 KB</span><span class="expand"></span>
</div></a></div></p>

<p>Gives a slight S-curve at an interpolation factor of 0.5.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-05-12T20:25:36Z' itemprop='datePublished'>
             2016-05-12 20:25:36 UTC
           </time>
        </span>
        <span itemprop='position'>#20</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="../../../users/johannes.html">@johannes</a> the reason sqrtf is not being converted to VSQRTF is because you need to set </p>

<pre><code> -fno-math-errno</code></pre>

<p>basically because the std maths functions set errno, which the VSQRTF (etc) would not, so are not 100% compatible, so you have to tell the compiler you dont need this... <br>I think we should do this for both the firmware and patch... any possible issues you can think of?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Fastest way to convert to/from int32 and float in 0-1 range'>
      <hr>
  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement'>
      <span itemprop='url'><b><a rel="next" itemprop="name" href="../16794658.html?page=2">next page â†’</a></b></span>
  </div>





    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../../index.html'>Home</a>
        <a href="../../../categories.html">Categories</a>
        <a href="../../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../../tos.html">Terms of Service</a>
        <a href="../../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/fastest-way-to-convert-to-from-int32-and-float-in-0-1-range/1679/2 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:05:56 GMT -->
</html>
