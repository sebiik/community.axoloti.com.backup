<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio, - AxoObject coding - Axoloti Community</title>
    <meta name="description" content="Hi, 

I am looking for some more information on the data types and conversions used when creating objects. 

 I have found some information in the user guide: in the &amp;quot;creating axo objects&amp;quot; part. Somewhere it was mentione&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="https://sebiik.github.io/community.axoloti.com.backup/t/documentation-on-data-types-and-conversions-for-int32buffer-frac32-frac32-s-map-ratio/1150" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://sebiik.github.io/community.axoloti.com.backup","potentialAction":{"@type":"SearchAction","target":"https://sebiik.github.io/community.axoloti.com.backup/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="https://sebiik.github.io/community.axoloti.com.backup/opensearch.xml" title="Axoloti Community Search">

        <link href="/stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,&#39;" href="https://sebiik.github.io/community.axoloti.com.backup/t/documentation-on-data-types-and-conversions-for-int32buffer-frac32-frac32-s-map-ratio/1150.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:image" content="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/documentation-on-data-types-and-conversions-for-int32buffer-frac32-frac32-s-map-ratio/1150" />
<meta name="twitter:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/documentation-on-data-types-and-conversions-for-int32buffer-frac32-frac32-s-map-ratio/1150" />
<meta property="og:title" content="Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio," />
<meta name="twitter:title" content="Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio," />
<meta property="og:description" content="Hi,   I am looking for some more information on the data types and conversions used when creating objects.    I have found some information in the user guide: in the &quot;creating axo objects&quot; part. Somewhere it was mentioned that -0x08000000 to 0x7FFFFFF  (-2^27 to 2^27-1) are used to represent -64.0 to 64.0 as frac32. Is this correct?   More concretely I have a problem when multiplying a window with a sample value. It would be helpful if someone could explain exactly what is happening in gain.axo: ..." />
<meta name="twitter:description" content="Hi,   I am looking for some more information on the data types and conversions used when creating objects.    I have found some information in the user guide: in the &quot;creating axo objects&quot; part. Somewhere it was mentioned that -0x08000000 to 0x7FFFFFF  (-2^27 to 2^27-1) are used to represent -64.0 to 64.0 as frac32. Is this correct?   More concretely I have a problem when multiplying a window with a sample value. It would be helpful if someone could explain exactly what is happening in gain.axo: ..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="3 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="18 ❤" />


  </head>
  <body class="crawler">
    
    <header>
      <a href="/"><img src="/uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="/t/documentation-on-data-types-and-conversions-for-int32buffer-frac32-frac32-s-map-ratio/1150">Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="/c/axoobject-code" itemprop="url">
        <span itemprop="title">AxoObject coding</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/Joren'><b itemprop='author'>Joren</b></a>
           
           <time datetime='2016-02-25T11:45:35Z' itemprop='datePublished'>
             2016-02-25 11:45:35 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi,</p>

<p>I am looking for some more information on the data types and conversions used when creating objects.</p>

<p> I have found some information in the user guide: in the "creating axo objects" part. Somewhere it was mentioned that -0x08000000 to 0x7FFFFFF  (-2^27 to 2^27-1) are used to represent -64.0 to 64.0 as frac32. Is this correct?</p>

<p>More concretely I have a problem when multiplying a window with a sample value. It would be helpful if someone could explain exactly what is happening in gain.axo:</p>

<pre><code>outlet_out= __SSAT(___SMMUL(param_amp,__SSAT(inlet_in,28)&lt;&lt;4)&lt;&lt;1,28);</code></pre>

<p>Even the basics are not clear to me: how are audio samples exactly encoded? It uses a int32buffer but how does this translate to hex? To put it in other words how can you convert an audio sample, encoded as a float (-1.0 to 1.0) to the correct (int16_t, int32_t) value?</p>

<p>Another mystery to me is how echo.axo is using a delay line defined as:</p>

<pre><code>int16_t delayline[attr_delaylength];</code></pre>

<p>Are the sample values not encodes as 32 bit integers (as the int32buffer seems to suggest) ? </p>

<p>Another issue is the definition of parameters like frac32.s.map.ratio. Are these all converted to a -2^27 to 2^27-1 range and is the distinction only for display purposes?</p>

<p>In short it would be helpful if there were a more detailed user guide detailing the exact formats used, which would make it more easy to port algorithms to objects. Especially for people like me with some c/c++ experience but not much low level bit-banging ARM optimization knowledge.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:5'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/thetechnobear'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-02-25T12:39:24Z' itemprop='datePublished'>
             2016-02-25 12:39:24 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ah, this is an area Ive grappled with a few times, each time thinking I must write it down, and then not getting around to it.</p>

<p>so I'll give what I can remember from last time I looked, as a discussion point, it may be slightly inaccurate, but hopefully will get the ball rolling</p>

<p>k-rate - integer : straight encoding <br>k-rate - string : need to check i guess 8 bit char<br>k-rate - fraction (bi and unipolar)  1&lt;&lt; 21, so +/-64 = 6 bits, so 4/5 bits headroom  (sign bit 31) </p>

<p>audio : 1 &lt;&lt; 27   so really +/- ~ 15.0 , so 4 bits 'headroom' (sign bit 31)</p>

<p>(with the k-rate fractions there are then various 'interpretations' e.g. linear frequency , pitch, phase) </p>

<p>the tricky bit, and Im only just now getting the feel for it.... is then shifting things into the right ranges, and often combining left and right shifts e.g.  (a &lt;&lt; 7 ) &gt;&gt;  2)  = a  &lt;&lt; 5, but with much less change of overflow.</p>

<p>audio encoding, there is no -1/+1 thats just a display representation,  the DAC is using signed 32 integer encoding.</p>

<p>int16_t delayline -  less precision, but longer delay line. convert by shifting appropriate number of bits.</p>

<p>when I come back to this , I just break out the disp/hex and start attaching dials, or looking at various 'simple' objects, though this time around Ive started creating some print objects in the community library, which I planned to have the various encodings for...<br>(e.g. there are certain conventions used for encoding pitch, frequencies etc) </p>

<p>of course, I agree a detailed user guide is a great idea. if you are exploring this, why not write it up and share as you go along, as we start to get more users coding objects , it will become increasingly important and useful resource.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/janvantomme'><b itemprop='author'>janvantomme</b></a>
           
           <time datetime='2016-02-25T12:39:49Z' itemprop='datePublished'>
             2016-02-25 12:39:49 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="1" data-topic="1150"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/letter_avatar_proxy/v2/letter/j/3ab097/40.png" class="avatar">Joren:</div>
<blockquote><p>In short it would be helpful if there were a more detailed user guide detailing the exact formats used, which would make it more easy to port algorithms to objects. Especially for people like me with some c/c++ experience but not much low level bit-banging ARM optimization knowledge.</p></blockquote></aside>

<p>I totally agree with this. I also have some basic knowledge of C/C++, but I have a hard time figuring out what most code does. API documentation with all available functions and a short piece of code on how to use these functions would be really handy as well.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/Joren'><b itemprop='author'>Joren</b></a>
           
           <time datetime='2016-02-25T12:48:51Z' itemprop='datePublished'>
             2016-02-25 12:48:51 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thanks. This is already very helpful to get me started. I will try to gain some more insight into the conversions and will share those here. Thanks again.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:3'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/Joren'><b itemprop='author'>Joren</b></a>
           
           <time datetime='2016-02-26T12:38:17Z' itemprop='datePublished'>
             2016-02-26 12:38:17 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I have made some  objects that do simple operations on audio buffers. The first is a mix object that converts audio, mixes it and converts it again. The code is optimized for readability not for performance.</p>

<pre><code>  // Capture the first input, it is encoded as a signed 
  // 32bit integer of which 27 bits are used. 
  // so to convert it to an interval [-1.0f , 1.0f] 
  // the following can be done:
  float input_one = (inlet_in1 / (float) (1&lt;&lt;27));
  // same for the second input which arrives at inlet_in2
  // note that the code generator automatically provides the 
  // array indexing. The line below is automatically converted to
  // float input_two = (inlet_in2[buffer_index] / (float) (1&lt;&lt;27));
  float input_two = (inlet_in2 / (float) (1&lt;&lt;27));

  // mixing is simply taking the sum of the two signals
  float mixed = input_one + input_two;
   
  // The following transforms the [-1.0f ; 1.0f] interval
  // to the axoloti convention interval of [-(1&lt;&lt;27) ; (1&lt;&lt;27)-1]
  outlet_out = (int32_t) (mixed * (1&lt;&lt;27));</code></pre>

<p>Another object does a gain. It shows how to capture input from a dial:</p>

<pre><code>  // frac32.u.map.gain is apparently mapped from 0 to 2^31
  // so the following gives a float between 0 and one
  float amplification = (param_amp / (float) (1&lt;&lt;31));

  // the value is simply multiplied with the current value of the
  // sample to get a correctly scaled output
  outlet_out = (int32_t) (amplification * inlet_in);</code></pre>

<p><a class="attachment" href="//community.axoloti.com/uploads/default/original/2X/1/12976ad68416b34d31d89de35fb0e9968ff74e59.axo">simple_gain.axo</a> (987 Bytes)<br><a class="attachment" href="//community.axoloti.com/uploads/default/original/2X/c/c875503f23f062d4aa7b78675ad3333c947ba8a8.axo">simple_mix.axo</a> (1.5 KB)</p>

<p>Please note that the comments might be not entirely correct. It reflects my current understanding of what is happening, but the objects seems to react as expected. A patch that uses these can be found here <a class="attachment" href="//community.axoloti.com/uploads/default/original/2X/d/ddb6405b798f8f4e8d7ed1e0da6dac058e1283fc.axp">simpelton.axp</a> (3.5 KB) .</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:2'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/thetechnobear'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-02-26T13:55:42Z' itemprop='datePublished'>
             2016-02-26 13:55:42 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>but why go via floats, this is inefficient, I think its better to 'get comfortable' with the necessary bit shifting, or at least this is generally the approach I'm taking.</p>

<p>kind of the idea i have, is only to use FP when interfacing between axoloti objects and 'external code/libraries' which have already been written using floats, this has the nice side effect of leaving the FPU available for this code, and not getting used by more mundane axoloti stuff, which can be just bit shifted around <img src="/images/emoji/emoji_one/smile.png?v=0" title=":smile:" class="emoji" alt=":smile:"> <br>(of course others may have different ideas/plans)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/Joren'><b itemprop='author'>Joren</b></a>
           
           <time datetime='2016-02-26T14:03:14Z' itemprop='datePublished'>
             2016-02-26 14:03:14 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I have created those objects as a kind of sanity check and with the aim of getting comfortable with the Axoloti conventions. The problem being that I need some kind of entry point to start understanding the bit shifting conventions (for which you kindly provided some insights earlier).  The rationale being: if I am able to convert to float an back to fixed point int then I am reasonably sure that I understand what is going on.</p>

<p>Perhaps the objects can provide some insights to others as well which is why I posted them here.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:2'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/Joren'><b itemprop='author'>Joren</b></a>
           
           <time datetime='2016-02-26T16:56:37Z' itemprop='datePublished'>
             2016-02-26 16:56:37 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Perhaps I bit off  more than I can chew but somehow I managed to get some sound out of an autotune patch I'm working on. It consists of two objects a pitch detector (yin) and a granular synthesis object called granulator. The pitch of an input is detected (currently an oscillator) by the pitch detector and via a midi keyboard the patch is able to determine how much the input pitch needs to be shifted to have the same frequency as the pressed midi key. The granulator subsequently shifts the pitch of the input to the requested pitch. That is the aim anyhow. As mentioned earlier I'm still struggling with the correct input/outputs.</p>

<p>Anyhow, the current alpha versions of the objects are included here for future reference and/or if someone wants to improve them.<a class="attachment" href="//community.axoloti.com/uploads/default/original/2X/5/5be8f8d8b8ef3ed85c2334a70975e3ad2f5821af.axp">crappy_autotune.axp</a> (3.6 KB)<a class="attachment" href="//community.axoloti.com/uploads/default/original/1X/80cc9581d59d48d716850337a19a2c7ffc84f2f2.axo">yin.axo</a> (10.9 KB)<br><a class="attachment" href="//community.axoloti.com/uploads/default/original/2X/3/31b2d6fd281448655ae7aa1d421b2886fcc53c96.axo">granulator.axo</a> (6.8 KB)</p>

<p>Currently, the delaylength for the granulator is expressed in powers of two so a buffer size of 11 means 2^11. Only the pitchr (reference) and pitchd (detected) inputs are working at the moment. To pitch shift something it needs two different pitches and a ratio is determined automatically. Time stretching also kind of works but due to the small buffer and due to being unable to predict the future it is limited. I have tried to use sdram for the delay line but failed: the sdram version worked with an oscillator but not when reading a file from an sd card. How to initialize and use sdram is also an area that could use a bit more documentation (atrr_poly? parent-&gt;poly?).</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:4'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/toneburst'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-03-11T09:52:33Z' itemprop='datePublished'>
             2016-03-11 09:52:33 UTC
           </time>
        </span>
        <span itemprop='position'>#9</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This sounds great! Looking forward to hearing it in action soon!</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/toneburst'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-03-14T16:31:24Z' itemprop='datePublished'>
             2016-03-14 16:31:24 UTC
           </time>
        </span>
        <span itemprop='position'>#10</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Is the principle similar to this now-discontinued module?<br><a href="http://www.gotharman.dk/Pitchshaper.htm" class="onebox" target="_blank" rel="nofollow">http://www.gotharman.dk/Pitchshaper.htm</a></p>

<p>I've been intrigued by this module for a while, but hate the panel design. Would be great to have  something similar for my Euxoloti module.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/philoop'><b itemprop='author'>philoop</b></a>
           
           <time datetime='2016-05-31T23:18:56Z' itemprop='datePublished'>
             2016-05-31 23:18:56 UTC
           </time>
        </span>
        <span itemprop='position'>#11</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>philoop says <img src="/images/emoji/emoji_one/slight_smile.png?v=2" title=":slight_smile:" class="emoji" alt=":slight_smile:"> tb move this to axobject coding else do nothing</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Documentation on data types and conversions for int32buffer, frac32, frac32.s.map.ratio,'>
      <hr>
  </div>






    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='/'>Home</a>
        <a href="/categories">Categories</a>
        <a href="/guidelines">FAQ/Guidelines</a>
        <a href="/tos">Terms of Service</a>
        <a href="/privacy">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
