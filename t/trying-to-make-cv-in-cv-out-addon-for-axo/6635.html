<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/trying-to-make-cv-in-cv-out-addon-for-axo/6635 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:03:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Trying to make CV-in / CV-out addon for Axo - Hardware - Axoloti Community</title>
    <meta name="description" content="Hi I&amp;#39;m trying to make a design for a CV-in / CV-out addon board for axo (for easy prototyping of AxoBased modules). I had a breadboard design based on the schematics found elsewhere on the forum. I changed the opamp to a&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="6635.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Trying to make CV-in / CV-out addon for Axo&#39;" href="6635.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/uploads/default/optimized/2X/0/09cf7f5cb3365acd3a73558f18bebcca92cbeee4_1_690x315.png" />
<meta property="og:image" content="http://community.axoloti.com/uploads/default/optimized/2X/0/09cf7f5cb3365acd3a73558f18bebcca92cbeee4_1_690x315.png" />
<meta property="og:url" content="http://community.axoloti.com/t/trying-to-make-cv-in-cv-out-addon-for-axo/6635" />
<meta name="twitter:url" content="http://community.axoloti.com/t/trying-to-make-cv-in-cv-out-addon-for-axo/6635" />
<meta property="og:title" content="Trying to make CV-in / CV-out addon for Axo" />
<meta name="twitter:title" content="Trying to make CV-in / CV-out addon for Axo" />
<meta property="og:description" content="Hi I&#39;m trying to make a design for a CV-in / CV-out addon board for axo (for easy prototyping of AxoBased modules). I had a breadboard design based on the schematics found elsewhere on the forum. I changed the opamp to a TL074 (pdf) because thatis what I had in my workshop.   so for CV in I have this:    [image]  I tested this on a breadboard and used an arduino to test this (so I would not fry my axo) and this all worked. So transfered it to a protoshield. But it sdoes not work. Now instead of ..." />
<meta name="twitter:description" content="Hi I&#39;m trying to make a design for a CV-in / CV-out addon board for axo (for easy prototyping of AxoBased modules). I had a breadboard design based on the schematics found elsewhere on the forum. I changed the opamp to a TL074 (pdf) because thatis what I had in my workshop.   so for CV in I have this:    [image]  I tested this on a breadboard and used an arduino to test this (so I would not fry my axo) and this all worked. So transfered it to a protoshield. But it sdoes not work. Now instead of ..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins ðŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="5 â¤" />


  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="6635.html">Trying to make CV-in / CV-out addon for Axo</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/hardware.html" itemprop="url">
        <span itemprop="title">Hardware</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kaos.html'><b itemprop='author'>kaos</b></a>
           
           <time datetime='2020-05-19T19:14:17Z' itemprop='datePublished'>
             2020-05-19 19:14:17 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi I'm trying to make a design for a CV-in / CV-out addon board for axo (for easy prototyping of AxoBased modules). I had a breadboard design based on the schematics found <a href="../official-pin-outs-revised-work-in-progress/1284.html">elsewhere on the forum</a>. I changed the opamp to a TL074 (<a href="https://pdf1.alldatasheet.com/datasheet-pdf/view/28778/TI/TL074.html" rel="nofollow noopener">pdf</a>) because thatis what I had in my workshop.</p>

<p>so for <strong>CV in</strong> I have this:</p>

<p><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/09cf7f5cb3365acd3a73558f18bebcca92cbeee4" href="../../uploads/default/original/2X/0/09cf7f5cb3365acd3a73558f18bebcca92cbeee4.png" class="lightbox" title="Screen Shot 2020-05-19 at 20.33.18.png"><img src="../../uploads/default/optimized/2X/0/09cf7f5cb3365acd3a73558f18bebcca92cbeee4_1_690x315.png" width="690" height="315"><div class="meta">
<span class="filename">Screen Shot 2020-05-19 at 20.33.18.png</span><span class="informations">922x421 26.8 KB</span><span class="expand"></span>
</div></a></div></p>

<p>I tested this on a breadboard and used an arduino to test this (so I would not fry my axo) and this all worked. So transfered it to a protoshield. But it sdoes not work. Now instead of scaling it down, the amp is scaling up, and forgetting all about the 1.65V offset. My signal is almost centered going from -11V to +10V. I have clipping diodes so the axo pin does not get this (-0.6V to 3.3V) but I don't know what is wrong.</p>

<p>Why does an opamp suddenly scale up?</p>

<p>some more info.</p>

<p>this is my build layout<br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/0940e3a9c2c5bff6143b588e44642f8b36abe415" href="../../uploads/default/original/2X/0/0940e3a9c2c5bff6143b588e44642f8b36abe415.jpg" class="lightbox" title="proto.jpg"><img src="../../uploads/default/optimized/2X/0/0940e3a9c2c5bff6143b588e44642f8b36abe415_1_486x500.jpg" width="486" height="500"><div class="meta">
<span class="filename">proto.jpg</span><span class="informations">1488x1530 915 KB</span><span class="expand"></span>
</div></a></div></p>

<p>I'm feeding it a -5v/+5v triangle wave (measured at b3)<br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/4ed96d428301362339035388b8b08eb108548d73" href="../../uploads/default/original/2X/4/4ed96d428301362339035388b8b08eb108548d73.jpg" class="lightbox" title="image.jpg"><img src="../../uploads/default/optimized/2X/4/4ed96d428301362339035388b8b08eb108548d73_1_666x499.jpg" width="666" height="499"><div class="meta">
<span class="filename">image.jpg</span><span class="informations">2437x1828 897 KB</span><span class="expand"></span>
</div></a></div></p>

<p>It properly gets scaled and offset before going into the amp (measured at b8 (pin 5 of the TL074)<br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/845b7231d6c19232bd9c3db7dc95932e1e85cd13" href="../../uploads/default/original/2X/8/845b7231d6c19232bd9c3db7dc95932e1e85cd13.jpg" class="lightbox" title="image.jpg"><img src="../../uploads/default/optimized/2X/8/845b7231d6c19232bd9c3db7dc95932e1e85cd13_1_666x499.jpg" width="666" height="499"><div class="meta">
<span class="filename">image.jpg</span><span class="informations">2438x1828 885 KB</span><span class="expand"></span>
</div></a></div></p>

<p>output before the diode clipping is<br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/bf91e4acb439390ee22ec77d7da87844f9a2dd97" href="../../uploads/default/original/2X/b/bf91e4acb439390ee22ec77d7da87844f9a2dd97.jpg" class="lightbox" title="image.jpg"><img src="../../uploads/default/optimized/2X/b/bf91e4acb439390ee22ec77d7da87844f9a2dd97_1_666x499.jpg" width="666" height="499"><div class="meta">
<span class="filename">image.jpg</span><span class="informations">2437x1828 943 KB</span><span class="expand"></span>
</div></a></div></p>

<p>gnd is measured ok on every gnd point in the schematics<br>3.3V VDDA is ok<br>1.65V CM is OK<br>the resistors are OK<br>the  axo is properly powered from the eurorack, and it works fine, gnd is connected<br>+12v is measured at a8 on pin 4<br>-12v is measured at a9 on pin 11 </p>

<p>probably something stupid... any ideas?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Nosnibor-2.html'><b itemprop='author'>Nosnibor</b></a>
           
           <time datetime='2020-05-19T21:05:52Z' itemprop='datePublished'>
             2020-05-19 21:05:52 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Your result matches the schematic (I did not figure out the layout yet): with the negative input of the opamp tied to GND, there is no limit to the amplifier's gain, so the output will be extreme (as close to either positive or negative supply as the output stage allows).<br>I think the dot connecting GND, pin 2 of the TL074, R13 and S of the input socket is wrong. The shield of the input socket should be connected to GND, and the negative input of the opamp should only be connected to R13. That way, the opamp becomes a voltage follower, i.e. output voltage = input voltage.</p>

<p>Edit: the layout looks correct though.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kaos.html'><b itemprop='author'>kaos</b></a>
           
           <time datetime='2020-05-20T05:51:59Z' itemprop='datePublished'>
             2020-05-20 05:51:59 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>No in the layout I connected the pin to ground on the back. You're right that will be it... Testing later today.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kaos.html'><b itemprop='author'>kaos</b></a>
           
           <time datetime='2020-05-20T08:48:37Z' itemprop='datePublished'>
             2020-05-20 08:48:37 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I made a mistake changing the layout from breadboard to schematics...Looking at the original breadboard, I still see one resistor sitting there, so I really forgot to take it out and draw it...<br>Thanks for spotting the mistake, it works now. </p>

<p> I get a nice linear offset + amplification <br>but:<br>-5v/+5v becomes -0.3v-3v, so not 0-3.3v<br>as you can see on the axo screenshot, corresponding with my scope output</p>

<p><img src="../../uploads/default/original/2X/9/9fe9dcb4c106f499782d3c5614470fe174b7884e.png" width="402" height="299"></p>

<p>any idea how I could rectify this? Updated schematics below</p>

<p><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/65fdca0100feaddca930ec127b479e3d9e642510" href="../../uploads/default/original/2X/6/65fdca0100feaddca930ec127b479e3d9e642510.png" class="lightbox" title="Screen Shot 2020-05-20 at 10.36.20.png"><img src="../../uploads/default/optimized/2X/6/65fdca0100feaddca930ec127b479e3d9e642510_1_690x284.png" width="690" height="284"><div class="meta">
<span class="filename">Screen Shot 2020-05-20 at 10.36.20.png</span><span class="informations">925x382 26.1 KB</span><span class="expand"></span>
</div></a></div></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kaos.html'><b itemprop='author'>kaos</b></a>
           
           <time datetime='2020-05-20T16:19:56Z' itemprop='datePublished'>
             2020-05-20 16:19:56 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><strong>CV Output is working perfectly</strong></p>

<p>meanwhile I have a working 0v/3.3v to -5v/+5v design<br>this one has no offset problems</p>

<p><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/b698343a70d135f41695cbb13ad9aaa886b25527" href="../../uploads/default/original/2X/b/b698343a70d135f41695cbb13ad9aaa886b25527.png" class="lightbox" title="Screen Shot 2020-05-20 at 14.59.32.png"><img src="../../uploads/default/optimized/2X/b/b698343a70d135f41695cbb13ad9aaa886b25527_1_690x469.png" width="690" height="469"><div class="meta">
<span class="filename">Screen Shot 2020-05-20 at 14.59.32.png</span><span class="informations">2008x1366 176 KB</span><span class="expand"></span>
</div></a></div></p>

<p>I do have a question about the axo safety though. What would happen if I would accidentally plug in a -5/+v signal in the output?  Should I add clamping diodes like in the other design? The TL074 is inbetween the pin and the jack, but what could/would happen?</p>

<p><strong>CV-input</strong><br>CV-input still has the small offset and clipping problem I mentioned earlier</p>

<aside class="quote" data-post="4" data-topic="6635"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/kaos/40/147_1.png" class="avatar">kaos:</div>
<blockquote><p>-5v/+5v becomes -0.3v-3v, so not 0-3.3v</p></blockquote></aside>

<p>pointers on how to fix are welcome.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:2'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Nosnibor-2.html'><b itemprop='author'>Nosnibor</b></a>
           
           <time datetime='2020-05-20T20:36:19Z' itemprop='datePublished'>
             2020-05-20 20:36:19 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I supect the CM voltage: the datasheet of the audio ADC/DAC says to not draw current from the CM output. Maybe 50ÂµA is already too much. Perhaps buffering CM with one of the other opamps of the TL074 will help (the datasheet mentions that connecting the positive input of an opamp is OK, so they probably had this situation in mind).<br>Or you could do without the CM voltage: one resistor to VDDA and one to GND should achieve the same result, although at the moment I don't remember how to calculate the correct values.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/tele_player.html'><b itemprop='author'>tele_player</b></a>
           
           <time datetime='2020-05-21T02:28:42Z' itemprop='datePublished'>
             2020-05-21 02:28:42 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Seems to me, if CM is being used as a 1.65V bias, a voltage divider using 3.3 could easily be tried instead.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kaos.html'><b itemprop='author'>kaos</b></a>
           
           <time datetime='2020-05-21T07:43:07Z' itemprop='datePublished'>
             2020-05-21 07:43:07 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yes that's how it was on the breadboard because I didn't have the reference voltage from an Arduino. Alright so a voltage divider with equal resistors should do the job. Any advice on the values? Like 50 ohm or rather 50Kohm</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Nosnibor-2.html'><b itemprop='author'>Nosnibor</b></a>
           
           <time datetime='2020-05-21T08:42:07Z' itemprop='datePublished'>
             2020-05-21 08:42:07 UTC
           </time>
        </span>
        <span itemprop='position'>#9</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>If you want a replacement for the CM voltage it should be rather low impedance, so it stays at the correct voltage, even if you draw some current from it (like the 50ÂµA that flow through the 33k+100k combination when the Input ist -5V). But a low-impedance voltage divider draws a lot of current, unless it is buffered with an opamp.<br>Another way would be to not use a 1.65V reference at all. Instead of a 33k resistor (R11) going to CM you would use two resistors of 66k (I've done the math by now), one going to VDDA, the other to GND. Of course, if you build several CV-in channels this would need more resistors (because each channel would need two resistors to reconstruct CM), but it would draw less current than one central voltage divider, because the resistors in each channel draw only as much current as needed.<br>And 66k is not a standard value, so you'd probably replace R7 by 150k and use 100k towards VDDA and GND or something similar.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/tele_player.html'><b itemprop='author'>tele_player</b></a>
           
           <time datetime='2020-05-21T12:24:54Z' itemprop='datePublished'>
             2020-05-21 12:24:54 UTC
           </time>
        </span>
        <span itemprop='position'>#10</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>What you describe (two resistors of 66k, one going to VDDA, the other to GND), IS a voltage divider; the equal resistors set the voltage at VDDA/2=1.65V.  How did you choose 66K? 68K is a close common value.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Nosnibor-2.html'><b itemprop='author'>Nosnibor</b></a>
           
           <time datetime='2020-05-21T13:53:50Z' itemprop='datePublished'>
             2020-05-21 13:53:50 UTC
           </time>
        </span>
        <span itemprop='position'>#11</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yes, the two 66k resistors alone would be a simple voltage divider giving VDDA/2=1.65V. But the resulting voltage is also influenced by CVin via R7 (100k), making this a voltage divider with two inputs, so the math gets a bit complicated (there probably is a simple formula for that case, but I have too little experience with circuit design to know about it).<br>My quick guess was to consider both resistors as parallel, since they both lead towards a constant voltage (as opposed to the variable input voltage), so they must have twice the original value. This is a somewhat "magical" argument inspired by RF circuit descriptions where all constant voltages are considered GND for RF purposes, since they all are only one capacitor (very low impedance for RF) away from GND.<br>Of course I didn't trust that kind of magical thinking, so I scribbled the back of an envelope full of equations, put the result into a spreadsheet and checked that it gave the same voltages as a 33k toward a low-impedance CM.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Sebo.html'><b itemprop='author'>Sebo</b></a>
           
           <time datetime='2020-05-22T09:09:36Z' itemprop='datePublished'>
             2020-05-22 09:09:36 UTC
           </time>
        </span>
        <span itemprop='position'>#12</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi, the problem here is you are using a non inverting configuration that is not well suited to work as a adder/mixer stage (you are trying to add the input voltage plus the reference voltage).<br>A correct adder/mixer configuration is using an inverting opamp (you have to use 2 in series to get the correct polarity of the signal).</p>

<p>I already did a module with Axoloti that have both CV inputs and CV outputs with correct gain staging and input protection (I used a different protection that yours because using diodes as protection have a few disadvantages).</p>

<p>You can check the circuit here:<br><aside class="quote" data-post="1" data-topic="4229">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/sebo/40/4466_1.jpg" class="avatar">
    <a href="../axoloti-as-a-5u-module/42292109.html?source_topic_id=6635" rel="nofollow noopener">Axoloti as a 5U Module</a> <a class="badge-wrapper  bullet" href="../../c/hardware.html"><span class="badge-category-bg" style="background-color: #AB9364;"></span><span style="color: #FFFFFF;" class="badge-category clear-badge" title="This category is intended for discussion about the Axoloti hardware and connecting to other hardware, including , connecting midi controllers and other hardware, related hardware projects.">Hardware</span></a>
  </div>
  <blockquote>
    Hi all: I did a module with Axoloti for my 5U modular. The module have: 

4 CV inputs (CV control + CV Atenautor) connected to PA0 to PA3. 1 Digital Input (with voltaje protection) connected to PB0. 2 CV outputs (0 to 10V) connected to PA4 and PA5 DAC outputs. 2 CV outputs (0 to 10V) connected to PA6 and PA7 using PWM at 10KHz. 6 Digital outputs connected to PC0 to PC5. 1 LED connected to PB1. 

 <a href="../../uploads/default/original/2X/0/04e1df4620f3f5ae4b668320a8180de3d7a3cdd9.jpg" class="lightbox" title="Modular.jpg" rel="nofollow noopener">[image]</a> <a href="../../uploads/default/original/2X/c/cb60fc04203aa6b759c9f7a8f098b09be959eaf5.png" class="lightbox" title="Sebo Axoloti Shield V4 - Schematic.png" rel="nofollow noopener">[image]</a>

Notes: I used MCP6002 (not MCP602), just didn't have a library for the MCP6002 in Eâ€¦
  </blockquote>
</aside>
</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kaos.html'><b itemprop='author'>kaos</b></a>
           
           <time datetime='2020-05-22T13:04:50Z' itemprop='datePublished'>
             2020-05-22 13:04:50 UTC
           </time>
        </span>
        <span itemprop='position'>#13</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Interesting,</p>

<aside class="quote" data-post="12" data-topic="6635"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/sebo/40/4466_1.jpg" class="avatar">Sebo:</div>
<blockquote><p>you have to use 2 in series to get the correct polarity of the signal</p></blockquote></aside>

<p>What if I would just fix this in the software? Would dropping the second stage suffice?</p>

<p>I see you use -15V/+15V in your modular, would the design change because I'm using -12V/+12V</p>

<aside class="quote" data-post="12" data-topic="6635"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/sebo/40/4466_1.jpg" class="avatar">Sebo:</div>
<blockquote><p>I used a different protection that yours because using diodes as protection have a few disadvantages</p></blockquote></aside>

<p>could you elaborate?  Are the diodes contributing to the offset problem? In the simulation, it is not the problem... but it is only a simulation, I don't see the clipping at all in the sim. What other problems could they evoke?<br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/22bd593cfbf189f82f2e8852784aaa6f2004a0e9" href="../../uploads/default/original/2X/2/22bd593cfbf189f82f2e8852784aaa6f2004a0e9.png" class="lightbox" title="Screen Shot 2020-05-22 at 14.50.17.png"><img src="../../uploads/default/optimized/2X/2/22bd593cfbf189f82f2e8852784aaa6f2004a0e9_1_568x500.png" width="568" height="500"><div class="meta">
<span class="filename">Screen Shot 2020-05-22 at 14.50.17.png</span><span class="informations">782x688 39.3 KB</span><span class="expand"></span>
</div></a></div><br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/8230d755e4b28db3b116052ce470782d111c7a5a" href="../../uploads/default/original/2X/8/8230d755e4b28db3b116052ce470782d111c7a5a.png" class="lightbox" title="Screen Shot 2020-05-22 at 14.49.18.png"><img src="../../uploads/default/optimized/2X/8/8230d755e4b28db3b116052ce470782d111c7a5a_1_553x499.png" width="553" height="499"><div class="meta">
<span class="filename">Screen Shot 2020-05-22 at 14.49.18.png</span><span class="informations">782x706 38.5 KB</span><span class="expand"></span>
</div></a></div></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/tele_player.html'><b itemprop='author'>tele_player</b></a>
           
           <time datetime='2020-05-22T14:02:57Z' itemprop='datePublished'>
             2020-05-22 14:02:57 UTC
           </time>
        </span>
        <span itemprop='position'>#14</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Relevant discussion. See the mentions of virtual ground on the inverting circuit.<br><a href="https://www.electronics-tutorials.ws/opamp/opamp_4.html" class="onebox" target="_blank" rel="nofollow noopener">https://www.electronics-tutorials.ws/opamp/opamp_4.html</a></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Sebo.html'><b itemprop='author'>Sebo</b></a>
           
           <time datetime='2020-05-22T17:16:44Z' itemprop='datePublished'>
             2020-05-22 17:16:44 UTC
           </time>
        </span>
        <span itemprop='position'>#15</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>You can't fix the polarity in software because you can get negative voltages into Axoloti. If a negative voltage reaches an input of the GPIO you probably burn it (that is why you should have some input protection).</p>

<p>Diodes have 2 problems:</p>

<p>1 - All diodes have a voltage drop that have to be substracted of the maximum voltage that are connected to (in this case 3.3V). A tipical signal diode have 0.7V of voltage drop, so the maximum voltage that will reach the input of the GPIO will be 2.6V (3.3 - 0.7), so you never going to get the full range of values in Axoloti (It will never reach 127). Even using a schotky diode that have a lower voltage drop (tipical 0.4V) will not be enough to get the full voltage to the input.</p>

<p>2 - When a voltage higher than 3.3V reaches the diodes, the diodes start to conduct and the current will go to the voltage regulator on the Axoloti board, if the current is too high you could burn the regulator and even all chips connected to 3.3V, so you have to limit the current, that is what R15 (100K) is for, but as this resistor have to be a bit high to limit the current enough, it forms a voltage divider with the internal impedance of the GPIO (50K I think), and then again you never reach the full voltage in the input...</p>

<p>In general, using diodes for protection works more or less well when the voltages are higher (5V or more) and when the input impedance of the chip is high...</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kaos.html'><b itemprop='author'>kaos</b></a>
           
           <time datetime='2020-05-25T08:03:37Z' itemprop='datePublished'>
             2020-05-25 08:03:37 UTC
           </time>
        </span>
        <span itemprop='position'>#16</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>right, the polarity problem, I should have figured that one out myself.<br>The diode insights are new to me, good info...</p>

<p>So best way forward seems an inverting opamp for the scale (10V peak to peak that becomes -3.3V to 0V) followed by an inverting unity gain buffer.<br>I used a lot of words in the previous sentence I haven't used before in my life (at least not in this combination) but I think I understand what I said there <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"> <a href="http://www.learningaboutelectronics.com/Articles/Unity-gain-buffer" rel="nofollow noopener">This page</a> explains it very well.</p>

<p><a class="mention" href="../../u/sebo-2.html">@Sebo</a>  Is there any reason you used a TL074 for the first stage and a MCP6002 for the second stage?<br>I also have some LM13700 lying around, but they are described as <em>Dual Operational Transconductance Amplifier with Linearizing Diodes and Buffers</em></p>

<p>Even more words I would have to learn about...</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:2'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/kaos.html'><b itemprop='author'>kaos</b></a>
           
           <time datetime='2020-05-25T08:27:39Z' itemprop='datePublished'>
             2020-05-25 08:27:39 UTC
           </time>
        </span>
        <span itemprop='position'>#17</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Allright! This one works, modeled according to your schematic, using 2 TL074s</p>

<p><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/ea37d7b030508d15657b086d7d207cf126ea1d15" href="../../uploads/default/original/2X/e/ea37d7b030508d15657b086d7d207cf126ea1d15.png" class="lightbox" title="Screen Shot 2020-05-25 at 10.20.22.png"><img src="../../uploads/default/optimized/2X/e/ea37d7b030508d15657b086d7d207cf126ea1d15_1_420x500.png" width="420" height="500"><div class="meta">
<span class="filename">Screen Shot 2020-05-25 at 10.20.22.png</span><span class="informations">584x695 29.8 KB</span><span class="expand"></span>
</div></a></div></p>

<p>problem here is that it offers no protection , and diodes also don't offer (adequate) protection as discussed earlier.<br>how could I protect the inputs of the axo.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
            <a href="../gate-trig-output-from-axoloti-pin-outputs/4590/12.html">Gate/Trig Output from Axoloti Pin outputs</a>
            <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Sebo.html'><b itemprop='author'>Sebo</b></a>
           
           <time datetime='2020-05-25T09:05:45Z' itemprop='datePublished'>
             2020-05-25 09:05:45 UTC
           </time>
        </span>
        <span itemprop='position'>#18</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The MCP6002 are the "protection". They are opamps that works rail to rail, uses the full range of the power suply they are conected to (the most common opamps like TL074 can't reach the power supply voltages). The power supply for the MCP6002 are +3.3V and ground, so even if they try to put a higher voltage to the output they can't.</p>

<p>The 13700 are transconductance opamps, they are good for make other things like VCAs, VCFs, compressors, etc.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Trying to make CV-in / CV-out addon for Axo'>
      <hr>
  </div>






    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/trying-to-make-cv-in-cv-out-addon-for-axo/6635 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:03:40 GMT -->
</html>
