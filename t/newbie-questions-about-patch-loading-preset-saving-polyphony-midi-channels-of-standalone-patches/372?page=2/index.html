<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches - Patching - Axoloti Community</title>
    <meta name="description" content="Hi all, I&amp;#39;ve had lots of fun creating  some instruments that are more or less ready to implement in my live sets - but I am now wondering about enclosures and building interfaces and started thinking about versatility of&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="https://sebiik.github.io/community.axoloti.com.backup/t/newbie-questions-about-patch-loading-preset-saving-polyphony-midi-channels-of-standalone-patches/372?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://sebiik.github.io/community.axoloti.com.backup","potentialAction":{"@type":"SearchAction","target":"https://sebiik.github.io/community.axoloti.com.backup/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="https://sebiik.github.io/community.axoloti.com.backup/opensearch.xml" title="Axoloti Community Search">

        <link href="/stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches&#39;" href="https://sebiik.github.io/community.axoloti.com.backup/t/newbie-questions-about-patch-loading-preset-saving-polyphony-midi-channels-of-standalone-patches/372.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:image" content="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/newbie-questions-about-patch-loading-preset-saving-polyphony-midi-channels-of-standalone-patches/372?page=2" />
<meta name="twitter:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/newbie-questions-about-patch-loading-preset-saving-polyphony-midi-channels-of-standalone-patches/372?page=2" />
<meta property="og:title" content="Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches" />
<meta name="twitter:title" content="Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches" />
<meta property="og:description" content="I think SDCard is the best medium for storing complete patch parameter snapshots.  There are 2 approaches:     simply writing/loading the &quot;PExch&quot; table to a file. This would save all parameters in the current patch, including on-parent parameters of subpatches (but excluding not-on-parent parameters of subpatches), in a binary format. It will only load well if the patch is exactly the same. Basically fairly easy to implement, but lacks preset-edit-ability from the GUI, and migrating such files w..." />
<meta name="twitter:description" content="I think SDCard is the best medium for storing complete patch parameter snapshots.  There are 2 approaches:     simply writing/loading the &quot;PExch&quot; table to a file. This would save all parameters in the current patch, including on-parent parameters of subpatches (but excluding not-on-parent parameters of subpatches), in a binary format. It will only load well if the patch is exactly the same. Basically fairly easy to implement, but lacks preset-edit-ability from the GUI, and migrating such files w..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="13 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="23 ‚ù§" />

      <link rel="prev" href="/t/newbie-questions-about-patch-loading-preset-saving-polyphony-midi-channels-of-standalone-patches/372">

  </head>
  <body class="crawler">
    
    <header>
      <a href="/"><img src="/uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="/t/newbie-questions-about-patch-loading-preset-saving-polyphony-midi-channels-of-standalone-patches/372">Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="/c/patching" itemprop="url">
        <span itemprop="title">Patching</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/johannes'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-01-03T22:09:26Z' itemprop='datePublished'>
             2016-01-03 22:09:26 UTC
           </time>
        </span>
        <span itemprop='position'>#21</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I think SDCard is the best medium for storing complete patch parameter snapshots. <br>There are 2 approaches: </p>

<ul>
<li>simply writing/loading the "PExch" table to a file. This would save all parameters in the current patch, including on-parent parameters of subpatches (but excluding not-on-parent parameters of subpatches), in a binary format. It will only load well if the patch is exactly the same. Basically fairly easy to implement, but lacks preset-edit-ability from the GUI, and migrating such files when making changes to a patch. </li>
<li>writing parameter + value lists to a file, perhaps even in a human-readable text format. I think this is what <a class="mention" href="/users/thetechnobear">@thetechnobear</a> has in mind. More robust towards patch changes, but still need to be careful with unexpected behavior when loading an older preset into a changed patch. This approach has less chance to work without interrupting the audio computation, since it involves a lot of string parsing.</li>
</ul>

<p>Both approaches touch an open area in the Axoloti framework. Currently the editor can only write a compiled patch to sdcard, but not open or connect to a patch running from sdcard, and keeping other data on the card (like parameter snapshots) in sync with the editor. The axoloti usb protocol allows uploading a file to sdcard but not downloading from sdcard yet.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:3'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/thetechnobear'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-01-03T22:39:31Z' itemprop='datePublished'>
             2016-01-03 22:39:31 UTC
           </time>
        </span>
        <span itemprop='position'>#22</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>actually I think both approaches are possible...</p>

<p>the data could be stored in a binary blob, along with the patch version... this would allow for quick loading (no parsing) when the patch is the correct version. (the 'usual' case) , and additionally a more robust format (where parameters ids etc can change) which is used for migration.<br>the preset file involved would be pretty smalls, so 'duplicating the information' would not be too problematic.</p>

<p>of course, there is always a potential of audio interference, or even patch anomalies as the presets are saved and loaded due to a number of factors including file io... but I suspect these can be kept to 'reasonable' levels.</p>

<p>there are also lots of other approaches which can trade off memory, file io, cpu load etc... and which take into account when presets are loaded/saved ... e.g. when its performance critical or not.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/alexk'><b itemprop='author'>alexk</b></a>
           
           <time datetime='2016-01-28T17:06:21Z' itemprop='datePublished'>
             2016-01-28 17:06:21 UTC
           </time>
        </span>
        <span itemprop='position'>#23</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ughh im so busy with other stuff but cant wait to return to this question. I don't want this crap from Namm 2016..i want my own synth with presets <img src="/images/emoji/emoji_one/stuck_out_tongue.png?v=0" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/DrJustice'><b itemprop='author'>DrJustice</b></a>
           
           <time datetime='2016-04-07T19:55:31Z' itemprop='datePublished'>
             2016-04-07 19:55:31 UTC
           </time>
        </span>
        <span itemprop='position'>#24</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>^ You may want to have a look <a href="//community.axoloti.com/t/drjustice-contributions/1459/4">here</a>. </p>

<p>It's an implementation of the first method suggested by Johannes in his posting above. It seems to work fairly well, but adding, removing or changing modules in a patch may render the presets unusable. I.e. only use with finished patches. </p>

<p>If xpatch.cpp had an array of pointers to all the patch root structures, a full global store/recall would be possible. Could this be added? Or perhaps they can be gotten to from a module already, and I'm just missing it?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/alexk'><b itemprop='author'>alexk</b></a>
           
           <time datetime='2016-04-10T11:21:43Z' itemprop='datePublished'>
             2016-04-10 11:21:43 UTC
           </time>
        </span>
        <span itemprop='position'>#25</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>wow that looks very interesting. Will study it a bit more, but if you have time could you tell me if this needs a specific firmware? Too caught up with my own code right now.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/DrJustice'><b itemprop='author'>DrJustice</b></a>
           
           <time datetime='2016-04-10T11:39:16Z' itemprop='datePublished'>
             2016-04-10 11:39:16 UTC
           </time>
        </span>
        <span itemprop='position'>#26</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I've tested the preset manager with 1.0.8 and 1.0.9 and those are fine.</p>

<p>It depends on a structure in the firmware, which could theoretically change and break at some version, but I think that bit is fairly stable for now. And <em>if/when</em> it changes [1] it might be to the advantage of the preset manager, which I plan to keep up to date.</p>

<p>[1] I'm advocating a tiny change: a table of pointers to the root struct of every sub patch in xpatch.cpp, to allow a global parameter load/save.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/thetechnobear'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-04-10T14:12:09Z' itemprop='datePublished'>
             2016-04-10 14:12:09 UTC
           </time>
        </span>
        <span itemprop='position'>#27</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="/users/drjustice">@DrJustice</a>  just been taking a look at your preset manager (only code, not played with it yet  ) </p>

<p>for discussion purposes i.e. its not criticism, its just great to have someone playing in this area, so can discuss these things. ... also I'm interested if my understanding is correct <img src="/images/emoji/emoji_one/smile.png?v=0" title=":smile:" class="emoji" alt=":smile:"> </p>

<p>I notice your using PExch, Im assuming this is fully populated on the patch (I've not checked, but explains how your PM works) <br>as such, I think this is not really saving presets, but saving a full set of current parameters values. presets are stored value in 'p' (i know not best name!)   and are a subset of the parameters. so 'theoretically' it should only save those, and also I think it should populate 'p', since otherwise if a user does a recall of a preset later, they will not pick up the values that they earlier loaded.<br>I raised, this as potentially, there is going to be confusion, between the interplay of presetmanger and recall/storing of presets  ... and frankly, I think presets already confuse many (including me <img src="/images/emoji/emoji_one/wink.png?v=0" title=":wink:" class="emoji" alt=":wink:"> ) </p>

<p>also... and this may not matter... Id assume PExch changes as your patch changes...  so does any patch change invalidate the preset stored?</p>

<p>of course my understanding may be incorrect, as I took a different approach on Push (as I wasn't storing the data), I used the global object parameter table (ObjectKvpRoot) ,  and just presented this to the user.<br>however, this also has 'issues' as its only the underlying parameters, so it doesn't have any knowledge of a parameter being on a 'subpatch', no issue for storage, but means from a UI perspective, you cannot show parameters that have been 'placed on the parent'<br>of course, the advantage for display, was also it has details about max/min , which aren't in PExch... unfortunately I dont think there is a relationship between PExch and the main object table (as far as i remember when playing with this) </p>

<p>here kind of illustrates where the two worlds divide:</p>

<pre><code> parent-&gt;PExch[PARAM_INDEX_square__3_pitch].pfunction = pfun_signed_clamp;
 SetKVP_IPVP(&amp;KVP_instancesquare__3_pitch,ObjectKvpRoot, "square_3" ,&amp;parent-&gt;PExch[PARAM_INDEX_square__3_pitch], -1&lt;&lt;27, 1&lt;&lt;27);
 KVP_RegisterObject(&amp;KVP_instancesquare__3_pitch);</code></pre>

<p>thats this shows, is the global table knows about the parameters and all its attributes but only knows at PExch instance, it has no knowledge of where it comes from e.g. parent/Pexch idx , similarly parent-&gt;pExch has no understanding of the actually parameter that is created in the global parameter table.</p>

<p>anyway, this is a bit fyi and discussion only... alot of this matter only when building controllers which want to expose the parameters in a sensible way to the user. but I think some of it is 'interesting' to storing patch state.</p>

<p>note: the global parameter table has the object name, which is what I kind of referred to above, this name only changes if the user changes object names, rather than patch structure.<br>I fear PExch and the index in ObjectKvpRoot are both based on the order things are built in a patch, which in turn is position on the patch canvas vs other objects. (though Ive not verified this) </p>

<p>anyway, perhaps this should be a separate topic, but i thought Id start here... as may not interest you at all <img src="/images/emoji/emoji_one/wink.png?v=0" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:2'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/DrJustice'><b itemprop='author'>DrJustice</b></a>
           
           <time datetime='2016-04-10T15:59:46Z' itemprop='datePublished'>
             2016-04-10 15:59:46 UTC
           </time>
        </span>
        <span itemprop='position'>#28</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="27" data-topic="372"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/user_avatar/community.axoloti.com/thetechnobear/40/6_1.png" class="avatar">thetechnobear:</div>
<blockquote><p>I notice your using PExch, Im assuming this is fully populated on the patch (I've not checked, but explains how your PM works) as such, I think this is not really saving presets, but saving a full set of current parameters values. presets are stored value in 'p' (i know not best name!)   and are a subset of the parameters. so 'theoretically' it should only save those, and also I think</p></blockquote></aside>

<p>Ah yes... that's an area open to confusion. These 'presets' are not the same as the original Axoloti presets (please add me to the ranks who gets confused by that - I'm used to the conventional meaning of 'preset' in synths). And since the original Axoloti presets aren't parameters as such, they don't get saved. PExch is fully populated AFAICS, and tests confirm this.</p>

<p>So, this thing should probably have another name, but what should that be? For what it's worth I think 99% of users will expects 'presets' to be a total store/recall of all parameters. So we have patches (which in fixed architecture synths are also called presets), original Axoloti presets, and my attempt at 'conventional' presets.</p>

<p><aside class="quote"><blockquote><p>also... and this may not matter... Id assume PExch changes as your patch changes... so does any patch change invalidate the preset stored?</p></blockquote></aside></p>

<p>I assume the above explanation, makes this half redundant, but: Changing the parameters is fine, that's what the preset manager is meant to capture. Adding/removing/changing modules in a patch will invalidate the presets previously stored for that patch. Changing the placement of modules reorders PExch, so that should be avoided too - I strongly suggest that Axoloti implements an iteration order based on the topology of the patch, not the placement of graphical placements  (you can have an algorithm from me if you wish). Therefore this PM module is best used for finalized patches, but even so I use it for patches I'm working on just to switch parameter sets (aka recall presets...) during testing. It sure beats having no conventional preset storage at all.</p>

<p><aside class="quote"><blockquote><p>...the global object parameter table (ObjectKvpRoot)</p></blockquote></aside></p>

<p>OK - that's something I will look into. If this can help me read and write all parameter values in all sub patches, I'll use that. Otherwise, just an array of pointers to the root structures of each patch would allow total store/recall of all patch parameters.</p>

<p>The issue with presets getting invalidated by patch structure changes could be avoided by having access to patch/module/parameter metadata, such that named parameters could be stored for named modules in a named (sub)patch. That metadata would eat RAM though - best placed in the SDRAM rater that the SRAM then.</p>

<p>In any case, I believe that (conventional) preset save/load is a very important feature that users will expect, so let's find a reasonable implementation and just do it!  <img src="/images/emoji/emoji_one/smiley.png?v=0" title=":smiley:" class="emoji" alt=":smiley:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:2'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/thetechnobear'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-04-10T16:35:08Z' itemprop='datePublished'>
             2016-04-10 16:35:08 UTC
           </time>
        </span>
        <span itemprop='position'>#29</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>yeah the presets in axoloti are a very nice feature, but perhaps need a better UI metaphor and tidying up...<br>they have many advantages, but I grant they are not how we think of presets.</p>

<aside class="quote" data-post="28" data-topic="372"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/user_avatar/community.axoloti.com/drjustice/40/1430_1.png" class="avatar">DrJustice:</div>
<blockquote><p>So, this thing should probably have another name, but what should that be?</p></blockquote></aside>

<p>I agree, but when I was writing this, I couldn't think of anything either.</p>

<p>my fear, is this will get users asking for the current presets to be a snapshot (as your PM is) , which we have had already, but I think thats wrong (its been discussed many times here already) , as the current system whilst perhaps not perfect/familar is very useful.</p>

<p>perhaps snapshot manager? is it Reaktor that calls these things snapshots?</p>

<aside class="quote" data-post="28" data-topic="372"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/user_avatar/community.axoloti.com/drjustice/40/1430_1.png" class="avatar">DrJustice:</div>
<blockquote><p>OK - that's something I will look into. If this can help me read and write all parameter values in all sub patches, I'll use that.</p></blockquote></aside>

<p>yes it does that, as it stores all parameters. <br>(Ok, Ive seen a couple of objects that do not appear to be registering the the parameters properly... I can't remember which)</p>

<aside class="quote" data-post="28" data-topic="372"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/user_avatar/community.axoloti.com/drjustice/40/1430_1.png" class="avatar">DrJustice:</div>
<blockquote><p>The issue with presets getting invalidated by patch structure changes could be avoided by having access to patch/module/parameter metadata, such that named parameters could be stored for named modules in a named (sub)patch. That metadata would eat RAM though - best placed in the SDRAM rater that the SRAM then.</p></blockquote></aside>

<p>again the above table has a name, which makes it less fragile... and I believe this name has to be unique, though its worth checking this.  if you look at my Push code, from memory i display it, with the parameter name and the object name its within (IIRC) ... so hopefully forming a FQN.</p>

<p>However... I will repeat, this does all need improving... but making it so its backwards compatible, and adding the extra meta data is no small task (also has to be kept small, as its part of the runtime)<br>... there is also another possibility, which is to keep this metadata separate, but along side (an in step with) the patch binary... such that the axoloti core doesn't have to load it, but its available for other processes to decode , think, like debug symbols.  this might be better, since potentially there is alot of useful meta data, that only editors/controllers need and that for runtime axoloti does not need.<br>(axoloti runtime, could deal merely with a single index, doesnt care about the rest) </p>

<p>as I said, I suspect when Axoloti Control is being finalised, it will also require this area to be improved, as it will face the same issues when wanting to display data to the end user in a logical fashion.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/DrJustice'><b itemprop='author'>DrJustice</b></a>
           
           <time datetime='2016-04-11T14:09:15Z' itemprop='datePublished'>
             2016-04-11 14:09:15 UTC
           </time>
        </span>
        <span itemprop='position'>#30</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="27" data-topic="372"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/user_avatar/community.axoloti.com/thetechnobear/40/6_1.png" class="avatar">thetechnobear:</div>
<blockquote>
<p>of course my understanding may be incorrect, as I took a different approach on Push (as I wasn't storing the data), I used the global object parameter table (ObjectKvpRoot) ,  and just presented this to the user.however, this also has 'issues' as its only the underlying parameters, so it doesn't have any knowledge of a parameter being on a 'subpatch', no issue for storage, but means from a UI perspective, you cannot show parameters that have been 'placed on the parent'of course, the advantage for display, was also it has details about max/min , which aren't in PExch... unfortunately I dont think there is a relationship between PExch and the main object table (as far as i remember when playing with this) </p>
<p>here kind of illustrates where the two worlds divide:</p>
<p> parent-&gt;PExch[PARAM_INDEX_square__3_pitch].pfunction = pfun_signed_clamp;<br> SetKVP_IPVP(&amp;KVP_instancesquare__3_pitch,ObjectKvpRoot, "square_3" ,&amp;parent-&gt;PExch[PARAM_INDEX_square__3_pitch], -1&lt;&lt;27, 1&lt;&lt;27);<br> KVP_RegisterObject(&amp;KVP_instancesquare__3_pitch);</p>
</blockquote></aside>

<p>I've followed that up now, and I can't make sense of the ObjectKvps table. So far, from what I can see it only has top level patch parameters registered, and then not all of them as you mentioned, even though I see the registering calls is xpatch.cpp. Also, the registered parameters are seemingly not consistent with the SetKVP_IPVP() and  KVP_RegisterObject() calls in xpatch.cpp, among other things I can only retrieve the keyname of a few of the ipValuePair structs that are registered.</p>

<p>There is of course a good chance that I'm doing something wrong. The code below is what I use to inspect ObjectKvps ATM. It's executed at the first iteration of the preset manager module (BTW, I'm thinking of renaming it to "snapshot manager" as you suggested, to avoid confusion). </p>

<pre><code>if( start_sequence == 0 ) // Only do this on the first iteration of the module!
  {
    extern struct KeyValuePair *ObjectKvps[];

    LogTextMessage( "preset_manager::krate(): ObjectKvpRoot = %08x, ObjectKvps = %08x, n = %d", ObjectKvpRoot, ObjectKvps, ObjectKvpRoot-&gt;apvp.length );

    for( int i = 0; i &lt; ObjectKvpRoot-&gt;apvp.length; i++ )
      {
        switch( ObjectKvps[i]-&gt;kvptype )
          {
            case KVP_TYPE_IPVP :
              LogTextMessage( "KVP_TYPE_IPVP: .keyName = %s, .value = %08x",
                ObjectKvps[i]-&gt;keyname != NULL ? ObjectKvps[i]-&gt;keyname : "NULL",
                ObjectKvps[i]-&gt;ipvp.PEx-&gt;value );
              break;
            case KVP_TYPE_IVP :
              LogTextMessage( "KVP_TYPE_IPVP: .keyName = %s, .value = %08x",
                ObjectKvps[i]-&gt;keyname != NULL ? ObjectKvps[i]-&gt;keyname : "NULL",
                ObjectKvps[i]-&gt;ivp.value );
              break;
            default :
              LogTextMessage( "KVP_TYPE_ = %d", ObjectKvps[i]-&gt;vptype );
              break;
          }
      }</code></pre>

<p>I'm running:</p>

<p>Axoloti version: 1.0.9<br>Firmware version: 1.0.0.1, crc=0x21C46C25, entrypoint=0x20011000<br>Host OS: Windows 7 64 bit</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/thetechnobear'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-04-11T16:24:33Z' itemprop='datePublished'>
             2016-04-11 16:24:33 UTC
           </time>
        </span>
        <span itemprop='position'>#31</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Its a bit of time (when I was doing the push stuff) since Ive played with this.</p>

<p>as far as i remember though... <br>you will see all parameters... just remember when you 'place on parent' you are really just exposing the same underlying parameter (i.e. the one in the sub patch) , so that can be confusing.</p>

<p>also as I said, I noticed some objects are not correctly registering their parameters. from memory this was some of the sel type objects.  (this is something I think we should fix.)</p>

<p>perhaps try the following...<br>create a patch with dials in the top level, and also dials in the subpatch (name them all, so you can see whats what).<br>and see if you get all the parameters.... </p>

<p>hopefully, then what we can do is go the other way, and narrow down, what is not being registered... and see if we can do this. i suspect its possible , perhaps you chose a different set of objects to the ones i did.</p>

<p>at some point, I'll create once to just print the stuff out as you did, as I cant use my push object now (traded in for  a push 2)... </p>

<p>unfortunately, as I said in my first post, its definitely 'not right' at the moment, there are 3 different structures (albeit related) doing things in this area... and I dont think any are vary consistent, or have the information we need.<br>the reason for raising this, is I suspect, we will need to tweak it all.... and the last thing I would do is create another one (e.g. adding the tree info your requesting for PExch) without reviewing it all.<br>as I said, Id put it on hold really, as I know Johannes will also need this updating for the Axoloti Control... and when we discussed it before, he did say the ui bit in firmware, was really just provisional/prototyping until Axoloti Control gets developed properly....<br>BUT... I thought its useful/important for you to know a little more about how parameters are handled... as Im sure you will have some good ideas for the future too.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/DrJustice'><b itemprop='author'>DrJustice</b></a>
           
           <time datetime='2016-04-11T18:24:10Z' itemprop='datePublished'>
             2016-04-11 18:24:10 UTC
           </time>
        </span>
        <span itemprop='position'>#32</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Absolutely tb - all info is greatly appreciated <img src="/images/emoji/emoji_one/smile.png?v=0" title=":smile:" class="emoji" alt=":smile:"></p>

<p>The addition I suggested for xpatch.cpp is simply a list of pointers to each patch root structure. A simple NULL terminated array would do fine. The metadata stuff we briefly discussed was more theoretical.</p>

<p>From looking at ui.c, ui.h and xpatch.cpp, it seems to partly be a work in progress for the remote. If it's the intention that ObjectKvps should be a registry for all parameters, that will be a great thing to have. However, right now it looks like it's incomplete and can't be used for this.</p>

<p>My test scenario consists of a patch with one sub patch, and I'm only seeing some of the top level parameters in ObjectKvps - still with the caveat that I could be doing things wrong.</p>

<p>I've added the test scenario to the library, so that you or anybody else who knows the firmware and xpatch can have a look and see what's going on:<br>patches/drj/test/preset_manager_test.axp,<br>objects/drj/test/preset_manager_test.axo</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/DrJustice'><b itemprop='author'>DrJustice</b></a>
           
           <time datetime='2016-04-12T08:58:17Z' itemprop='datePublished'>
             2016-04-12 08:58:17 UTC
           </time>
        </span>
        <span itemprop='position'>#33</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Of course I had done a silly mistake - It's looking quite good now. <img src="/images/emoji/emoji_one/blush.png?v=0" title=":blush:" class="emoji" alt=":blush:"></p>

<p>However the ctrl/i (integer spinbox object) and ParameterInt32Box (object parameter) do not appear to be registered. In xpatch.cpp a KeyValuePair is defined locally for them, but SetKVP_IPVP() and KVP_RegisterObject() calls are never made. Perhaps this could be the case for some other obejcts too? OK this is close, but the cigars will have to remain in the humidor for now.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/thetechnobear'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-04-12T10:01:33Z' itemprop='datePublished'>
             2016-04-12 10:01:33 UTC
           </time>
        </span>
        <span itemprop='position'>#34</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>cool... I started doubting my memory for a moment there</p>

<aside class="quote" data-post="33" data-topic="372"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//community.axoloti.com/user_avatar/community.axoloti.com/drjustice/40/1430_1.png" class="avatar">DrJustice:</div>
<blockquote><p>However the ctrl/i (integer spinbox object) and ParameterInt32Box (object parameter) do not appear to be registered. In xpatch.cpp a KeyValuePair is defined locally for them, but SetKVP_IPVP() and KVP_RegisterObject() calls are never made. Perhaps this could be the case for some other obejcts too? OK this is close, but the cigars will have to remain in the humidor for now.</p></blockquote></aside>

<p>yeah, theres a few of these... I can't remember which ones at the moment...<br>I need to determine if there is a good reason for this, or if its just an oversight, or perhaps something that was added later and not applied to everything.</p>

<p>perhaps if you maintain a list of the ones you spot... then it will give us something to work off of.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/DrJustice'><b itemprop='author'>DrJustice</b></a>
           
           <time datetime='2016-04-12T10:32:03Z' itemprop='datePublished'>
             2016-04-12 10:32:03 UTC
           </time>
        </span>
        <span itemprop='position'>#35</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Aye! I shall keep notes of anything missing. I'm writing a new version now, will have something to test later today.</p>

<p>Perhaps it's an idea to split off this part of discussion into a new thread, starting from <a href="//community.axoloti.com/t/newbie-questions-about-patch-loading-preset-saving-polyphony-midi-channels-of-standalone-patches/372/27">here</a>?</p>

<p>And don't doubt yourself, tb! You're the veteran and I'm the noob with only a few hours of system familiarisation so far.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:3'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/DrJustice'><b itemprop='author'>DrJustice</b></a>
           
           <time datetime='2016-04-14T20:37:34Z' itemprop='datePublished'>
             2016-04-14 20:37:34 UTC
           </time>
        </span>
        <span itemprop='position'>#36</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>A new version of the preset manager is up, please ref. my contribution thread for a description.</p>

<p>The functionality is now very close to 'conventional' presets. Just need two things to make that happen:</p>

<p>1 -  Get those currently non-registered parameters fixed. I still have only spotted the integer spinbox, but I haven't been searching for that  (too busy programming...).</p>

<p>2 - A list of sub patches, with something to identify each sub patch, e.g. just a sequence number or something like that, so that name clashes in the global save mode can be avoided (that is equally named parameters in different sub patches). I.e. an array of  sub patch pointer/identifier pairs.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:4'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/alexk'><b itemprop='author'>alexk</b></a>
           
           <time datetime='2016-04-20T11:36:56Z' itemprop='datePublished'>
             2016-04-20 11:36:56 UTC
           </time>
        </span>
        <span itemprop='position'>#37</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>looking forward to finally try it out. been catching up on things <img src="/images/emoji/emoji_one/smile.png?v=0" title=":smile:" class="emoji" alt=":smile:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Newbie Questions about Patch Loading, Preset saving, Polyphony, Midi Channels of standalone patches'>
      <hr>
  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement'>
      <span itemprop='url'><a rel="prev" itemprop="name" href="/t/newbie-questions-about-patch-loading-preset-saving-polyphony-midi-channels-of-standalone-patches/372">‚Üê previous page</a></span>
  </div>





    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='/'>Home</a>
        <a href="/categories">Categories</a>
        <a href="/guidelines">FAQ/Guidelines</a>
        <a href="/tos">Terms of Service</a>
        <a href="/privacy">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
