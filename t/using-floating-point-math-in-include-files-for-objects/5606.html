<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/using-floating-point-math-in-include-files-for-objects/5606 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jul 2023 03:10:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Using floating point math in include files for objects - Developer - Axoloti Community</title>
    <meta name="description" content="I&amp;#39;d like to use floating point math (sin, cos, log, exp) in a header file that I inlude in an object but this throws an error (undefined reference to `sin&amp;#39;). Neither including cmath nor math.h resolved the error. It work&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="5606.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://sebiik.github.io/community.axoloti.com.backup","potentialAction":{"@type":"SearchAction","target":"https://sebiik.github.io/community.axoloti.com.backup/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Using floating point math in include files for objects&#39;" href="5606.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:image" content="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/using-floating-point-math-in-include-files-for-objects/5606" />
<meta name="twitter:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/using-floating-point-math-in-include-files-for-objects/5606" />
<meta property="og:title" content="Using floating point math in include files for objects" />
<meta name="twitter:title" content="Using floating point math in include files for objects" />
<meta property="og:description" content="I&#39;d like to use floating point math (sin, cos, log, exp) in a header file that I inlude in an object but this throws an error (undefined reference to `sin&#39;). Neither including cmath nor math.h resolved the error. It works if fixed values are given (e.g. sin(0.5)), probably because the calculation is done by the compiler.   Is it at all possible to use these floating point math functions with axoloti?" />
<meta name="twitter:description" content="I&#39;d like to use floating point math (sin, cos, log, exp) in a header file that I inlude in an object but this throws an error (undefined reference to `sin&#39;). Neither including cmath nor math.h resolved the error. It works if fixed values are given (e.g. sin(0.5)), probably because the calculation is done by the compiler.   Is it at all possible to use these floating point math functions with axoloti?" />


  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="5606.html">Using floating point math in include files for objects</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/developer.html" itemprop="url">
        <span itemprop="title">Developer</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/chris.html'><b itemprop='author'>chris</b></a>
           
           <time datetime='2019-04-12T13:32:30Z' itemprop='datePublished'>
             2019-04-12 13:32:30 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I'd like to use floating point math (sin, cos, log, exp) in a header file that I inlude in an object but this throws an error (undefined reference to `sin'). Neither including cmath nor math.h resolved the error. It works if fixed values are given (e.g. sin(0.5)), probably because the calculation is done by the compiler.</p>

<p>Is it at all possible to use these floating point math functions with axoloti?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Using floating point math in include files for objects'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/deadsy.html'><b itemprop='author'>deadsy</b></a>
           
           <time datetime='2019-04-12T15:21:14Z' itemprop='datePublished'>
             2019-04-12 15:21:14 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>It's possible to use the standard math library, but generally not desirable. The standard math library favors accuracy over speed. ie - they'll run the algo until they get enough significant digits to fill out the fractional portion of the float type being returned. That's typically not needed to audio DSP. The axoloti firmware has table based math functions that should be called instead. They are less accurate but much faster. Take a look at the implementation of the factory sine wave oscillator to see how to do this.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Using floating point math in include files for objects'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/chris.html'><b itemprop='author'>chris</b></a>
           
           <time datetime='2019-04-13T07:38:36Z' itemprop='datePublished'>
             2019-04-13 07:38:36 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thanks for the reply. I was able to get the functions up and running by using sinf/cosf and pow(e, x) instead of sin/cos/exp.</p>

<p>The math is only used during initialisation but I need the higher accuracy there. This is for a speaker crossover where I have given filters that should run on the axoloti. As I'm much more familiar with floating point dsp I implemented the filters in floating point which seems to work fine (the whole crossover uses about 20% CPU).</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:2'>
      <meta itemprop='headline' content='Using floating point math in include files for objects'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/deadsy.html'><b itemprop='author'>deadsy</b></a>
           
           <time datetime='2019-04-13T14:52:38Z' itemprop='datePublished'>
             2019-04-13 14:52:38 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Certainly you want to stick to single precision float on the axoloti because the cortex-m4 doesn't have instructions for 64 bit floats. Also keep in mind that a constant written like "2.0" will be treated as a double (64 bits) while the same written as "2.0f" or "2.f"  will be treated as float (32 bits). That is: make sure you put an "f" on the end of your constants so the compiler doesn't try to do 64 bit float operations.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Using floating point math in include files for objects'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jaffasplaffa.html'><b itemprop='author'>jaffasplaffa</b></a>
           
           <time datetime='2019-04-13T17:06:39Z' itemprop='datePublished'>
             2019-04-13 17:06:39 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="3" data-topic="5606"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../letter_avatar_proxy/v2/letter/c/958977/40.html" class="avatar">chris:</div>
<blockquote><p>Thanks for the reply. I was able to get the functions up and running by using sinf/cosf and pow(e, x) instead of sin/cos/exp.</p></blockquote></aside>

<p>Johannes told me to stay away from pow function, as it takes a lot of resources. But not sure how to test it.</p>

<p>May I ask which filter you are making? </p>

<p>Anything special? <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Using floating point math in include files for objects'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/chris.html'><b itemprop='author'>chris</b></a>
           
           <time datetime='2019-04-14T08:52:49Z' itemprop='datePublished'>
             2019-04-14 08:52:49 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The pow function is only used during initialisation as the filters don't change.</p>

<p>I use rather typical EQ filters (lowcut, hicut, peak and shelfs). The crossover filters are two butterworh cuts for a linkwitz-riley filter and the shelfs &amp; peak filters are for equalisation. Unfortunately it's not easy to set gain and Q factor in the axoloti objects I found. At least not for me. I also had problems understanding the parameters mappings while trying to hard code a Q factor of sqrt(0.5) for a 2nd order butterworth filter. </p>

<p>The processing is done in floating point using <a href="https://www.kvraudio.com/forum/viewtopic.php?p=4836443#p4836443" rel="nofollow noopener">this</a> implementation.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Using floating point math in include files for objects'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jaffasplaffa.html'><b itemprop='author'>jaffasplaffa</b></a>
           
           <time datetime='2019-04-14T12:50:24Z' itemprop='datePublished'>
             2019-04-14 12:50:24 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Sounds great.</p>

<p>A bit more complicated than I understand, but it sounds nice.</p>

<p>I hope you get the Q working <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Using floating point math in include files for objects'>
      <hr>
  </div>






    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/using-floating-point-math-in-include-files-for-objects/5606 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jul 2023 03:10:37 GMT -->
</html>
