<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/custom-file-loader-and-structs/4339 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:05:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Custom File Loader and Structs - AxoObject coding - Axoloti Community</title>
    <meta name="description" content="This is related to @lokki question about loading arrays, but coming at it from a slightly different direction, so I thought it worth making a new thread. 

I&amp;#39;m working on a custom file-loader object, that I&amp;#39;d like to ope&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="4339.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Custom File Loader and Structs&#39;" href="4339.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:image" content="http://community.axoloti.com/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:url" content="http://community.axoloti.com/t/custom-file-loader-and-structs/4339" />
<meta name="twitter:url" content="http://community.axoloti.com/t/custom-file-loader-and-structs/4339" />
<meta property="og:title" content="Custom File Loader and Structs" />
<meta name="twitter:title" content="Custom File Loader and Structs" />
<meta property="og:description" content="This is related to @lokki question about loading arrays, but coming at it from a slightly different direction, so I thought it worth making a new thread.   I&#39;m working on a custom file-loader object, that I&#39;d like to operate in the same way as the Factory &#39;table/alloc/16b sdram load&#39; object- ie you select a file, then the contents of that file is copied to SDRAM, and becomes available to other objects in the patch by setting an attribute to the name of the first object.   However, I don&#39;t want m..." />
<meta name="twitter:description" content="This is related to @lokki question about loading arrays, but coming at it from a slightly different direction, so I thought it worth making a new thread.   I&#39;m working on a custom file-loader object, that I&#39;d like to operate in the same way as the Factory &#39;table/alloc/16b sdram load&#39; object- ie you select a file, then the contents of that file is copied to SDRAM, and becomes available to other objects in the patch by setting an attribute to the name of the first object.   However, I don&#39;t want m..." />


  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="4339.html">Custom File Loader and Structs</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/axoobject-code.html" itemprop="url">
        <span itemprop="title">AxoObject coding</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2018-03-12T16:43:33Z' itemprop='datePublished'>
             2018-03-12 16:43:33 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This is related to <a class="mention" href="../../u/lokki.html">@lokki</a> <a href="../two-questions-arrays-and-where-to-put-them-solved/4252.html">question</a> about loading arrays, but coming at it from a slightly different direction, so I thought it worth making a new thread.</p>

<p>I'm working on a custom file-loader object, that I'd like to operate in the same way as the Factory '<em>table/alloc/16b sdram load</em>' object- ie you select a file, then the contents of that file is copied to SDRAM, and becomes available to other objects in the patch by setting an attribute to the name of the first object.</p>

<p>However, I don't want my file-loader just to load simple arrays into SDRAM. I want to define a struct in the loader (let's called it '<em>ROMHeader</em>'), and to be able to access the SDRAM data in other objects by means of a pointer of type ROMHeader.</p>

<p>Is this possible?</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2018-03-12T16:54:35Z' itemprop='datePublished'>
             2018-03-12 16:54:35 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Oh, and the length of the file to be loaded is not known in advance.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2018-03-12T17:01:21Z' itemprop='datePublished'>
             2018-03-12 17:01:21 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>yes, as I said in the other thread, it’s just data , you can cast it to whatever you want. </p>

<p>The only issue you <strong>may</strong> encounter is byte alignment and struct packing - but I’d give it a go first , as it may not be an issue for you - so you can avoid this topic <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:2'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2018-03-12T18:36:17Z' itemprop='datePublished'>
             2018-03-12 18:36:17 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi <a class="mention" href="../../u/thetechnobear.html">@thetechnobear</a> thanks for the quick reply.</p>

<p>Is the fact that the size of the file to be copied to SDRAM isn’t known in advance a problem, though?</p>

<p>The alloc 16b sdram object has at attribute for the number of bytes to be allocated.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2018-03-12T19:11:07Z' itemprop='datePublished'>
             2018-03-12 19:11:07 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>NO, assuming you follow the advice I gave in the other thread about how to get filesize and dynamically allocate the memory.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2018-03-12T19:26:20Z' itemprop='datePublished'>
             2018-03-12 19:26:20 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Ah, ok. but <a class="mention" href="../../u/lokki.html">@lokki</a>’s scenario was slightly different. He wanted to load data into an object for use exclusively by that same object.l, and wanted to ensure that multiple instances of the object shared the same data.</p>

<p>That’s not really what I’m trying to do.</p>

<p>I want other objects to be able to access the data, in the same way they would if it was at ‘alloc’, or table object.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2018-03-12T19:35:58Z' itemprop='datePublished'>
             2018-03-12 19:35:58 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>No, part 2 of his question was about accessing from other objects.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2018-03-12T20:02:29Z' itemprop='datePublished'>
             2018-03-12 20:02:29 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I will read through the thread again. I didn't pick up that point when I just scanned through the thread a while ago.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2018-03-12T20:43:12Z' itemprop='datePublished'>
             2018-03-12 20:43:12 UTC
           </time>
        </span>
        <span itemprop='position'>#9</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hmm.. I still don't think what you suggest will work for me.</p>

<p>I'm embarrassingly vague on OOP terminology, but I understand you're proposing a singleton pattern, whereby only a single instance of data-loader class is, or can be created.</p>

<p>Doesn't that inherently preclude the use of more than one instance of the class (ie more than one of my Loader objects, loading different files)?</p>

<p>That's exactly what <a class="mention" href="../../u/lokki.html">@lokki</a> wanted, but it's not really what I'm after.</p>

<p>I want something that works (to the user) in exactly the same way as a '<em>table/alloc</em>' module and eg a '<em>table read</em>', ie the user references the data in the 'loader' object by entering the name of the 'loader' in a text attribute of the 'reader' object.</p>

<p>I'd also need the Loader object to be 'poly-safe', by which I understand that if used polyphonically, it will not load the same data into SDRAM multiple times.</p>

<p>In the past, I was able to modify the factory <em>'table/alloc 16bt sdram'</em> object to load my file into an 8-bit array in SDRAM, but this only worked because the size of the file to be loaded was known in advance, and could be set in a const.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2018-03-12T22:31:17Z' itemprop='datePublished'>
             2018-03-12 22:31:17 UTC
           </time>
        </span>
        <span itemprop='position'>#10</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="3" data-topic="4339"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/thetechnobear/40/6_1.html" class="avatar">thetechnobear:</div>
<blockquote><p>The only issue you may encounter is byte alignment and struct packing - but I’d give it a go first , as it may not be an issue for you - so you can avoid this topic</p></blockquote></aside>

<p>Hit that one already, in fact. I found that rearranging the order of variables in the struct solved the problem, but it had me scratching my head for a while.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2018-03-14T09:38:54Z' itemprop='datePublished'>
             2018-03-14 09:38:54 UTC
           </time>
        </span>
        <span itemprop='position'>#11</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I managed to upload the data as uint8_t, then cast the pointer to the struct type I'd defined, and all is good.</p>

<p>Having said that, I was reading on a forum that casting an int pointer to a struct pointer is potentially a Very Bad thing to do (or at least, bad practice).</p>

<p>It seems to work but should I be aware of any potential pitfalls?</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2018-03-14T10:20:56Z' itemprop='datePublished'>
             2018-03-14 10:20:56 UTC
           </time>
        </span>
        <span itemprop='position'>#12</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>just the normal problems with static casting things ... you basically stop the compiler from doing any syntax checks, so if you give it bad data it'll crash and burn.<br>so yeah, its generally to be avoided... <br>that's why we generally use void pointers for 'type changing', to kind of remind us to take care <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2018-03-14T10:40:58Z' itemprop='datePublished'>
             2018-03-14 10:40:58 UTC
           </time>
        </span>
        <span itemprop='position'>#13</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="12" data-topic="4339"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/thetechnobear/40/6_1.html" class="avatar">thetechnobear:</div>
<blockquote><p>just the normal problems with static casting things ... you basically stop the compiler from doing any syntax checks, so if you give it bad data it'll crash and burn.</p></blockquote></aside>

<p>Makes sense. But, if I've made checks all along the way that the memory has been allocated, that file has been copied etc., and the format of the file is known, I should be OK, I guess.</p>

<aside class="quote" data-post="12" data-topic="4339"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/thetechnobear/40/6_1.html" class="avatar">thetechnobear:</div>
<blockquote><p>that's why we generally use void pointers for 'type changing', to kind of remind us to take care</p></blockquote></aside>

<p>I see. I will look into those, thanks for the tip.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Custom File Loader and Structs'>
      <hr>
  </div>






    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/custom-file-loader-and-structs/4339 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:05:56 GMT -->
</html>
