<!DOCTYPE html>
<html lang="en" class="desktop-view not-mobile-device  anon">
  <head>
    <meta charset="utf-8">
    <title>K-/S-Rate, CPU Speed, C Code, and Multithreading - Developer - Axoloti Community</title>
    <meta name="description" content="Hi there. I&amp;#39;m very new to both Axoloti and coding (hoping to learn on the Axoloti), so sorry if what I ask is either obvious or doesn&amp;#39;t make sense.  

Anyways, I&amp;#39;ve been perusing the forums here, and thought of a questio&amp;hellip;">
    <meta name="discourse_theme_key" content="b5ce34aa-3ee1-4d3e-b190-0a2ab62c7408">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="http://community.axoloti.com/t/k-s-rate-cpu-speed-c-code-and-multithreading/4701" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="http://community.axoloti.com/opensearch.xml" title="Axoloti Community Search">

    

      <meta name="fragment" content="!">


    <script>
      window.EmberENV = window.EmberENV || {};
      window.EmberENV['FORCE_JQUERY'] = true;
    </script>

    <link rel='preload' href='/assets/locales/en-5bbc8626277bd471a9fcd063411070c515cad1a78c86a38ad27792a513f11bd4.js' as='script'/>
<script src='/assets/locales/en-5bbc8626277bd471a9fcd063411070c515cad1a78c86a38ad27792a513f11bd4.js'></script>
    <link rel='preload' href='/assets/ember_jquery-a8dcbd325e04410f036f2a791d66d8316c48c5387acdd914de99a5dd6afb3cd3.js' as='script'/>
<script src='/assets/ember_jquery-a8dcbd325e04410f036f2a791d66d8316c48c5387acdd914de99a5dd6afb3cd3.js'></script>
    <link rel='preload' href='/assets/preload-store-ec90ffab9d7a6d9e507dda7cf7343e9d50b8bce624f7f44486ac8fd6b9814309.js' as='script'/>
<script src='/assets/preload-store-ec90ffab9d7a6d9e507dda7cf7343e9d50b8bce624f7f44486ac8fd6b9814309.js'></script>
    <link rel='preload' href='/assets/vendor-199fce5a9e9895329b51b04605f1f5061951acb488baa6b2ea2fc2ae36def529.js' as='script'/>
<script src='/assets/vendor-199fce5a9e9895329b51b04605f1f5061951acb488baa6b2ea2fc2ae36def529.js'></script>
    <link rel='preload' href='/assets/pretty-text-bundle-e888dd08c05658b05da2124dd56955aa8fe94225d532fb8bfa3264a3eb2aa581.js' as='script'/>
<script src='/assets/pretty-text-bundle-e888dd08c05658b05da2124dd56955aa8fe94225d532fb8bfa3264a3eb2aa581.js'></script>
    <link rel='preload' href='/assets/application-13a284a273d9247cd8b3d19ae7d053297aeb5b3eabaa9a901c9fd236fb7dfe60.js' as='script'/>
<script src='/assets/application-13a284a273d9247cd8b3d19ae7d053297aeb5b3eabaa9a901c9fd236fb7dfe60.js'></script>
    <link rel='preload' href='/assets/plugin-3a5d56cbe920ebb10de8abd59e839cf2d48d598ca07a267327f96e3fec534065.js' as='script'/>
<script src='/assets/plugin-3a5d56cbe920ebb10de8abd59e839cf2d48d598ca07a267327f96e3fec534065.js'></script>
    <link rel='preload' href='/assets/plugin-third-party-346f0166b34a16f0ac66ea388d925068ee8f76267dc167ac7173785ea046f465.js' as='script'/>
<script src='/assets/plugin-third-party-346f0166b34a16f0ac66ea388d925068ee8f76267dc167ac7173785ea046f465.js'></script>


      

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

    <link rel="manifest" href="/manifest.json">


      <link href="/stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>


  <link href="/stylesheets/desktop_theme_1_6c5f8f7f5e6a154a9f0dfd7aedf04bae4b669f17.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop_theme"/>

    

<link rel="preload" href="/assets/fontawesome-webfont-2adefcbc041e7d18fcf2d417879dc5a09997aa64d675b7a3c4b6ce33da13f3fe.woff2?http://community.axoloti.com&2&v=4.7.0" as="font" type="font/woff2" crossorigin />
<style>
  @font-face {
    font-family: 'FontAwesome';
    src: url('/assets/fontawesome-webfont-2adefcbc041e7d18fcf2d417879dc5a09997aa64d675b7a3c4b6ce33da13f3fe.woff2?http://community.axoloti.com&2&v=4.7.0') format('woff2'),
         url('/assets/fontawesome-webfont-ba0c59deb5450f5cb41b3f93609ee2d0d995415877ddfa223e8a8a7533474f07.woff?http://community.axoloti.com&amp;2&v=4.7.0') format('woff');
  }
</style>


      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;K-/S-Rate, CPU Speed, C Code, and Multithreading&#39;" href="http://community.axoloti.com/t/k-s-rate-cpu-speed-c-code-and-multithreading/4701.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:image" content="http://community.axoloti.com/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:url" content="http://community.axoloti.com/t/k-s-rate-cpu-speed-c-code-and-multithreading/4701" />
<meta name="twitter:url" content="http://community.axoloti.com/t/k-s-rate-cpu-speed-c-code-and-multithreading/4701" />
<meta property="og:title" content="K-/S-Rate, CPU Speed, C Code, and Multithreading" />
<meta name="twitter:title" content="K-/S-Rate, CPU Speed, C Code, and Multithreading" />
<meta property="og:description" content="Hi there. I&#39;m very new to both Axoloti and coding (hoping to learn on the Axoloti), so sorry if what I ask is either obvious or doesn&#39;t make sense.    Anyways, I&#39;ve been perusing the forums here, and thought of a question I couldn&#39;t find the answer to. In a nutshell, I&#39;m wondering how both the k-rate and s-rate Hz numbers relate to both the number of lines in a code block and the processor&#39;s clock speed.   So far, I&#39;ve picked up that k-rate code is 3 kHz, s-rate is 48 kHz, and the CPU&#39;s clock sp..." />
<meta name="twitter:description" content="Hi there. I&#39;m very new to both Axoloti and coding (hoping to learn on the Axoloti), so sorry if what I ask is either obvious or doesn&#39;t make sense.    Anyways, I&#39;ve been perusing the forums here, and thought of a question I couldn&#39;t find the answer to. In a nutshell, I&#39;m wondering how both the k-rate and s-rate Hz numbers relate to both the number of lines in a code block and the processor&#39;s clock speed.   So far, I&#39;ve picked up that k-rate code is 3 kHz, s-rate is 48 kHz, and the CPU&#39;s clock sp..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="3 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="3 ❤" />



    
  </head>

  <body class="">
    

    <div class='debug-eyeline'></div>

    <noscript data-path="/t/k-s-rate-cpu-speed-c-code-and-multithreading/4701">
      <header class="d-header">
  <div class="wrap">
    <div class="contents">
      <div class="row">
        <div class="title span13">
          <a href="/">
              <img src="/uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo">
          </a>
        </div>
            <div class='panel clearfix'>
              <a href="/login" class='btn btn-primary btn-small login-button'><i class="fa fa-user"></i> Log In</a>
            </div>
      </div>
    </div>
  </div>
</header>

      <div id="main-outlet" class="wrap">
        <!-- preload-content: -->
        <h1>
  <a href="/t/k-s-rate-cpu-speed-c-code-and-multithreading/4701">K-/S-Rate, CPU Speed, C Code, and Multithreading</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="/c/developer" itemprop="url">
        <span itemprop="title">Developer</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/thomas11'><b itemprop='author'>thomas11</b></a>
           
           <time datetime='2018-06-19T21:06:45Z' itemprop='datePublished'>
             2018-06-19 21:06:45 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi there. I'm very new to both Axoloti and coding (hoping to learn on the Axoloti), so sorry if what I ask is either obvious or doesn't make sense. </p>

<p>Anyways, I've been perusing the forums here, and thought of a question I couldn't find the answer to. In a nutshell, I'm wondering how both the k-rate and s-rate Hz numbers relate to both the number of lines in a code block and the processor's clock speed.</p>

<p>So far, I've picked up that k-rate code is 3 kHz, s-rate is 48 kHz, and the CPU's clock speed is 168 MHz. For the k-/s-rate numbers, does this mean that the Axoloti board will execute the entire code.krate block for an object 3,000 times a second, and the entire code.srate block 48,000 times a second? Or will it only execute 1 line of code in these blocks 3,000/48,000 times a second? Or will it do something else? Basically, what is it that is being done at the 3/48 kHz rates?</p>

<p>As for the CPU's clock speed, since it's much higher than the k-/s-rate speeds I'm assuming that there is some multithreading going on, such that the processor is executing multiple k-/s-rate things at the same time. Is this right? And if so, how does the multithreading work at the broad brush strokes level? Is it that each object has its own thread? Or is it ad hoc what gets its own thread? Or is there something I as a developer will need to do to control this aspect of things? Or is it something else?</p>

<p>Any thoughts you could spare for me would be a huge help. Thanks!</p>

<p>P.S. Feel free to move this to another category if 'Developer' isn't the right one.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='K-/S-Rate, CPU Speed, C Code, and Multithreading'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/deadsy'><b itemprop='author'>deadsy</b></a>
           
           <time datetime='2018-06-20T06:04:40Z' itemprop='datePublished'>
             2018-06-20 06:04:40 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I'd preface this by saying that I'm fairly new to the axoloti firmware, so if others have better information/insights please correct me.</p>

<blockquote><p>I'm wondering how both the k-rate and s-rate Hz numbers relate to both the <br>number of lines in a code block and the processor's clock speed.</p></blockquote>

<p>They don't...</p>

<blockquote><p>So far, I've picked up that k-rate code is 3 kHz s-rate is 48 kHz</p></blockquote>

<p>Right. The codec/sai is setup to playback 48000 samples per second.<br>Each sample is a 32 bit fixed point (q5.27) quantity.<br>There are 2 channels of audio.</p>

<p>Some signals in a synth are relatively slow moving, E.g envelopes.<br>We can save memory and cpu by generating them at a slower rate.<br>In axoloti the factor is x16, so the k-rate signals have 3000 values/second.</p>

<blockquote><p>and the CPU's clock speed is 168 MHz.</p></blockquote>

<p>Right. The CPU is actually rated for 180 MHz, but ST in their wisdom made it impossible to run the USB with this CPU speed.</p>

<blockquote><p>For the k-/s-rate numbers, does this mean that the Axoloti board will execute <br>the entire code.krate block for an object 3,000 times a second, and the entire <br>code.srate block 48,000 times a second?</p></blockquote>

<p>Yes. If you write an some object code in the GUI and look at what gets generated you will see the following:</p>

<p></p><pre><code class="lang-auto">void dsp(blah...) {
  your_krate_code();
  for(i = 0 i &lt; BUFSIZE; i ++) {
    your_srate_code();
  }
}</code></pre>

<p>ie - your krate code gets called once and the srate code gets called in a 16x loop.<br>Some of the objects don't bother with the srate code. They just do everything (including the srate work) in the krate code specification.</p>

<p>16 x 1/48000 = 1/3 ms of signal. So: an object generating an srate signal must be called 3000 times/second.</p>

<blockquote><p>As for the CPU's clock speed, since it's much higher than the k-/s-rate speeds <br>I'm assuming that there is some multithreading going on</p></blockquote>

<p>Yes, in so far as the firmware uses chibios and chibios supports multiple concurrent tasks/threads.</p>

<blockquote><p>such that the processor is executing multiple k-/s-rate things at the same <br>time. Is this right?</p></blockquote>

<p>No. One thread is responsible for generating the audio buffers and that is "ThreadDSP".</p>

<p>Basically it works as follows:</p>

<p>The codec/SAI needs to be fed at a rate of 48000 samples/second (x 2 channels) to generate clean audio.</p>

<p>The SAI is fed by DMA from memory. The DMA is arranged in double buffering mode. ie: when the SAI is reading from one buffer the CPU can be busy filling in the other buffer. When the SAI is done with one buffer the DMA will be switched to the other buffer, so the CPU has to be done with filling it in before this happens.</p>

<p>Every time the DMA switches buffers an interrupt gets generated. This interrupt wakes up ThreadDSP and tells it to get busy computing the sound and filling in the output buffer the SAI is not currently reading from.</p>

<p>To do this the code calls the patch you have created. See: PatchProcess in xpatch.cpp</p>

<p>That code hooks up all the objects you have created and ultimately computes the 16 samples (x2 channels) needed for the audio output.</p>

<p>When you return from your patch the ThreadDSP code will time how long it took and see how much you beat the deadline by. This gives you the CPU load number.</p>

<p>So- the bigger the patch, the more complex the objects, the greater the number of voices, the longer it will take the CPU to compute the sound. Every 1/3 ms the ThreadDSP code will wake up and will go full speed trying to get the buffer filled before the SAI needs it.</p>

<p>Hope this helps.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:3'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='K-/S-Rate, CPU Speed, C Code, and Multithreading'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/thomas11'><b itemprop='author'>thomas11</b></a>
           
           <time datetime='2018-06-20T14:13:05Z' itemprop='datePublished'>
             2018-06-20 14:13:05 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="/u/deadsy">@deadsy</a> Thanks so much for that. I think it gives me a good handle on things. But to double check that I'm on the right page, the main outline is that Axoloti has two buffers, and at any time one of the buffers is being read from (and I assume output through the audio out?) while the other is being written to. ThreadDSP is the function that does the writing, and the way ThreadDSP does this is by calling the PatchProcess function from xpatch.cpp, which in turn calls my k- and s-rate code through the void dsp(...) function you sketched out above. Finally, ThreadDSP checks to see how much time it had left after it finishes writing to the buffer, and uses that to show me the CPU load. Is that on the right track?</p>

<p>Also, reading through your response made me think of a few extra questions. First, are there two buffers because Axoloti has a stereo out and needs one each for the left and right outs, or for some other reason? </p>

<p>Second, does the dsp(...) function get generated for each object in a patch, or for the entire patch? </p>

<p>Third, do you happen to know where I would find the (I assume .c or .cpp) files that include the dsp(...) function? All I've been able to find are the .axo/.axp files that (if I understand correctly) are used to generate the files I'm looking for now.</p>

<p>And last, do you know where I would find the xpatch.cpp file and the file(s) that have the ThreadDSP code? I've found an xpatch.h file under the axoloti-runtime/firmware folder, but this doesn't look to be the file you're talking about. And I haven't had any luck finding ThreadDSP.</p>

<p>Thanks again for the help!</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='K-/S-Rate, CPU Speed, C Code, and Multithreading'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/deadsy'><b itemprop='author'>deadsy</b></a>
           
           <time datetime='2018-06-20T17:57:33Z' itemprop='datePublished'>
             2018-06-20 17:57:33 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <blockquote><p>Is that on the right track?</p></blockquote>

<p>Yes.</p>

<blockquote><p>are there two buffers because Axoloti has a stereo out and needs one each for the left and right outs, or for some other reason?</p></blockquote>

<p>well, there are actually 4 defined in ./axoloti/firmware/codec.c</p>

<p></p><pre><code class="lang-auto">int32_t buf[BUFSIZE*2] __attribute__ ((section (".sram2")));
int32_t buf2[BUFSIZE*2] __attribute__ ((section (".sram2")));
int32_t rbuf[BUFSIZE*2] __attribute__ ((section (".sram2")));
int32_t rbuf2[BUFSIZE*2] __attribute__ ((section (".sram2")));</code></pre>

<p>buf/buf2 are for audio output (dac).<br>rbuf/rbuf2 are for audio input (adc).</p>

<p>For both input and output there are 2 buffers so they can operate in the aforementioned ping-pong fashion. While the codec is busy with one buffer the cpu is busy with the other buffer. That's a standard DSP technique and has nothing to do with stereo output.</p>

<p>You will notice a BUFSIZE*2 for the buffers. The x2 is for the left/right stereo channels. The CPU has to compute 2 channels worth of audio data.</p>

<blockquote><p>does the dsp(...) function get generated for each object</p></blockquote>

<p>For each object. </p>

<blockquote><p>where I would find the (I assume .c or .cpp) files that include the dsp(...) function?</p></blockquote>

<p>I find it in ./axoloti/build/xpatch.cpp<br>I'm building the code from source, so it may be different if you have a binary install- but you'll find the generated patch code somewhere amongst the axoloti files. (find | grep xpatch)</p>

<blockquote><p>ThreadDSP</p></blockquote>

<p>./axoloti/firmware/patch.c<br></p>

<p></p><pre><code class="lang-auto">static msg_t ThreadDSP(void *arg) {</code></pre>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='K-/S-Rate, CPU Speed, C Code, and Multithreading'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='/u/thomas11'><b itemprop='author'>thomas11</b></a>
           
           <time datetime='2018-06-20T22:36:03Z' itemprop='datePublished'>
             2018-06-20 22:36:03 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="/u/deadsy">@deadsy</a> Thanks so much for the follow up! I have a good overview of these things now, and a manageable number of files to start looking over for the details.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='K-/S-Rate, CPU Speed, C Code, and Multithreading'>
      <hr>
  </div>






        <!-- :preload-content -->
        <footer>
          <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
            <a href='/'>Home</a>
            <a href="/categories">Categories</a>
            <a href="/guidelines">FAQ/Guidelines</a>
            <a href="/tos">Terms of Service</a>
            <a href="/privacy">Privacy Policy</a>
          </nav>
        </footer>
      </div>

      <footer id='noscript-footer'>
        <p>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
      </footer>
    </noscript>

      

    <section id='main'>
    </section>

    <div id='offscreen-content'>
    </div>

      <form id='hidden-login-form' method="post" action="/login" style="display: none;">
        <input name="username" type="text"     id="signin_username">
        <input name="password" type="password" id="signin_password">
        <input name="redirect" type="hidden">
        <input type="submit" id="signin-button" value="Log In">
      </form>

      <script>
      (function() {
        var ps = require('preload-store').default;
          ps.store("site", {"default_archetype":"regular","notification_types":{"mentioned":1,"replied":2,"quoted":3,"edited":4,"liked":5,"private_message":6,"invited_to_private_message":7,"invitee_accepted":8,"posted":9,"moved_post":10,"linked":11,"granted_badge":12,"invited_to_topic":13,"custom":14,"group_mentioned":15,"group_message_summary":16,"watching_first_post":17,"topic_reminder":18},"post_types":{"regular":1,"moderator_action":2,"small_action":3,"whisper":4},"groups":[{"id":1,"name":"admins"},{"id":0,"name":"everyone"},{"id":2,"name":"moderators"},{"id":3,"name":"staff"},{"id":10,"name":"trust_level_0"},{"id":11,"name":"trust_level_1"},{"id":12,"name":"trust_level_2"},{"id":13,"name":"trust_level_3"},{"id":14,"name":"trust_level_4"}],"filters":["latest","unread","new","read","posted","bookmarks"],"periods":["all","yearly","quarterly","monthly","weekly","daily"],"top_menu_items":["latest","unread","new","read","posted","bookmarks","category","categories","top"],"anonymous_top_menu_items":["latest","top","categories","category","categories","top"],"uncategorized_category_id":1,"is_readonly":false,"disabled_plugins":[],"user_field_max_length":2048,"suppressed_from_homepage_category_ids":[],"post_action_types":[{"name_key":"bookmark","name":"Bookmark","description":"Bookmark this post","short_description":"Bookmark this post","long_form":"bookmarked this post","is_flag":false,"icon":null,"id":1,"is_custom_flag":false},{"name_key":"like","name":"Like","description":"Like this post","short_description":"Like this post","long_form":"liked this","is_flag":false,"icon":"heart","id":2,"is_custom_flag":false},{"name_key":"off_topic","name":"Off-Topic","description":"This post is not relevant to the current discussion as defined by the title and first post, and should probably be moved elsewhere.","short_description":"Not relevant to the discussion","long_form":"flagged this as off-topic","is_flag":true,"icon":null,"id":3,"is_custom_flag":false},{"name_key":"inappropriate","name":"Inappropriate","description":"This post contains content that a reasonable person would consider offensive, abusive, or a violation of \u003ca href=\"/guidelines\"\u003eour community guidelines\u003c/a\u003e.","short_description":"A violation of \u003ca href=\"/guidelines\"\u003eour community guidelines\u003c/a\u003e","long_form":"flagged this as inappropriate","is_flag":true,"icon":null,"id":4,"is_custom_flag":false},{"name_key":"vote","name":"Vote","description":"Vote for this post","short_description":"Vote for this post","long_form":"voted for this post","is_flag":false,"icon":null,"id":5,"is_custom_flag":false},{"name_key":"spam","name":"Spam","description":"This post is an advertisement, or vandalism. It is not useful or relevant to the current topic.","short_description":"This is an advertisement or vandalism","long_form":"flagged this as spam","is_flag":true,"icon":null,"id":8,"is_custom_flag":false},{"name_key":"notify_user","name":"Send @{{username}} a message","description":"I want to talk to this person directly and privately about their post.","short_description":"I want to talk to this person directly and privately about their post.","long_form":"messaged user","is_flag":true,"icon":null,"id":6,"is_custom_flag":true},{"name_key":"notify_moderators","name":"Something Else","description":"This post requires staff attention for another reason not listed above.","short_description":"Requires staff attention for another reason","long_form":"flagged this for staff attention","is_flag":true,"icon":null,"id":7,"is_custom_flag":true}],"topic_flag_types":[{"name_key":"inappropriate","name":"Inappropriate","description":"This topic contains content that a reasonable person would consider offensive, abusive, or a violation of \u003ca href=\"/guidelines\"\u003eour community guidelines\u003c/a\u003e.","short_description":"translation missing: en.topic_flag_types.inappropriate.short_description","long_form":"flagged this as inappropriate","is_flag":true,"icon":null,"id":4,"is_custom_flag":false},{"name_key":"spam","name":"Spam","description":"This topic is an advertisement. It is not useful or relevant to this site, but promotional in nature.","short_description":"translation missing: en.topic_flag_types.spam.short_description","long_form":"flagged this as spam","is_flag":true,"icon":null,"id":8,"is_custom_flag":false},{"name_key":"notify_moderators","name":"Something Else","description":"This topic requires general staff attention based on the \u003ca href=\"/guidelines\"\u003eguidelines\u003c/a\u003e, \u003ca href=\"/tos\"\u003eTOS\u003c/a\u003e, or for another reason not listed above.","short_description":"translation missing: en.topic_flag_types.notify_moderators.short_description","long_form":"flagged this for moderator attention","is_flag":true,"icon":null,"id":7,"is_custom_flag":true}],"can_create_tag":null,"can_tag_topics":null,"tags_filter_regexp":"[/\\?#\\[\\]@!\\$\u0026'\\(\\)\\*\\+,;=\\.%\\\\`^\\s|\\{\\}\"\u003c\u003e]+","top_tags":["midi","controllers","modular","linux","1.0.11","macos","windows","troubleshooting","usb","challenge","wavetable","library","math","faust","dsp","out","tips","current","14bit"],"topic_featured_link_allowed_category_ids":[10,4,1,5,15,12,2,6,9,16,14,3,8,7,13,11],"user_themes":[{"theme_key":"b5ce34aa-3ee1-4d3e-b190-0a2ab62c7408","name":"Migrated from Site Text","default":true}],"categories":[{"id":1,"name":"Uncategorized","color":"AB9364","text_color":"FFFFFF","slug":"uncategorized","topic_count":-1,"post_count":1,"position":0,"description":"Topics that don't need a category, or don't fit into any other existing category.","description_text":"","topic_url":"/t/","read_restricted":false,"permission":null,"notification_level":1,"topic_template":null,"has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":10,"name":"User Guide","color":"3AB54A","text_color":"FFFFFF","slug":"user-guide","topic_count":24,"post_count":102,"position":1,"description":"This category contains posts to help users use Axoloti, a dynamic user guide.","description_text":"This category contains posts to help users use Axoloti, a dynamic user guide.","topic_url":"/t/about-the-user-guide-category/51","read_restricted":false,"permission":null,"notification_level":1,"topic_template":"","has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":8,"name":"Helpdesk","color":"9EB83B","text_color":"FFFFFF","slug":"helpdesk","topic_count":395,"post_count":3131,"position":2,"description":"This category is for reporting issues and bugs\u003cbr\u003ePlease use other categories for discussions on features or questions or \"how to?\"","description_text":"This category is for reporting issues and bugsPlease use other categories for discussions on features or questions or \"how to?\"","topic_url":"/t/about-the-helpdesk-category/23","read_restricted":false,"permission":null,"notification_level":1,"topic_template":"","has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":13,"name":"Community Library","color":"9EB83B","text_color":"FFFFFF","slug":"community-library","topic_count":54,"post_count":2953,"position":3,"description":"Category for the community library","description_text":"Category for the community library","topic_url":"/t/about-the-community-library-category/1005","read_restricted":false,"permission":null,"notification_level":1,"topic_template":"","has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":7,"name":"Patching","color":"AB9364","text_color":"FFFFFF","slug":"patching","topic_count":1043,"post_count":8521,"position":4,"description":"This category is for discussion about patching Axoloti, and sharing patches.","description_text":"This category is for discussion about patching Axoloti, and sharing patches.","topic_url":"/t/about-the-patching-category/14","read_restricted":false,"permission":null,"notification_level":1,"topic_template":"","has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":5,"name":"Hardware","color":"AB9364","text_color":"FFFFFF","slug":"hardware","topic_count":732,"post_count":7717,"position":5,"description":"This category is intended for discussion about the Axoloti hardware and connecting to other hardware, including , connecting midi controllers and other hardware, related hardware projects. ","description_text":"This category is intended for discussion about the Axoloti hardware and connecting to other hardware, including , connecting midi controllers and other hardware, related hardware projects.","topic_url":"/t/about-the-hardware-category/12","read_restricted":false,"permission":null,"notification_level":1,"topic_template":null,"has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":6,"name":"Software","color":"AB9364","text_color":"FFFFFF","slug":"software","topic_count":340,"post_count":3410,"position":6,"description":"This category is for posts regarding the software of Axoloti, this includes the Axoloti patching GUI, Axoloti Objects (axo) and firmware. Please use the Patching category to discuss patching Axoloti. ","description_text":"This category is for posts regarding the software of Axoloti, this includes the Axoloti patching GUI, Axoloti Objects (axo) and firmware. Please use the Patching category to discuss patching Axoloti.","topic_url":"/t/about-the-software-category/13","read_restricted":false,"permission":null,"notification_level":1,"topic_template":null,"has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":16,"name":"AxoObject coding","color":"AB9364","text_color":"FFFFFF","slug":"axoobject-code","topic_count":276,"post_count":2240,"position":7,"description":"Category to discuss coding Axoloti Objects.","description_text":"Category to discuss coding Axoloti Objects.","topic_url":"/t/about-the-axoobject-coding-category/1519","read_restricted":false,"permission":null,"notification_level":1,"topic_template":null,"has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":14,"name":"News/Events","color":"283890","text_color":"FFFFFF","slug":"events","topic_count":30,"post_count":106,"position":8,"description":"Meetups, workshops, presentations, all sort of events.\u003cbr\u003eIt's perfectly fine for users to announce and discuss their own events, as long as it is related to Axoloti somehow.\u003cbr\u003eStart your topic title with the name of the area where your event will happen.","description_text":"Meetups, workshops, presentations, all sort of events.It's perfectly fine for users to announce and discuss their own events, as long as it is related to Axoloti somehow.Start your topic title with the name of the area where your event will happen.","topic_url":"/t/about-the-events-category/1142","read_restricted":false,"permission":null,"notification_level":1,"topic_template":"","has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":12,"name":"Challenges","color":"0E76BD","text_color":"FFFFFF","slug":"challenges","topic_count":19,"post_count":277,"position":9,"description":"This category is for challenges, competitions and discussions related to these.\u003cbr\u003eposters are reminded when entering challenges and competitions to not include any copyrighted material","description_text":"This category is for challenges, competitions and discussions related to these.posters are reminded when entering challenges and competitions to not include any copyrighted material","topic_url":"/t/about-the-challenges-category/838","read_restricted":false,"permission":null,"notification_level":1,"topic_template":"","has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":9,"name":"Your Music/Projects","color":"0E76BD","text_color":"FFFFFF","slug":"your-music-projects","topic_count":196,"post_count":1385,"position":10,"description":"Have some music that you have made with Axoloti? or an interesting project you would like to share the communities?\u003cbr\u003eTells us about it here.","description_text":"Have some music that you have made with Axoloti? or an interesting project you would like to share the communities?Tells us about it here.","topic_url":"/t/about-the-your-music-projects-category/25","read_restricted":false,"permission":null,"notification_level":1,"topic_template":"","has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":15,"name":"Lounge","color":"AB9364","text_color":"FFFFFF","slug":"lounge","topic_count":107,"post_count":1736,"position":11,"description":"This category is for discussions that are related to Axoloti generally but are not specifically about Axoloti.\u003cbr\u003e(please ensure it has some relevance to Axoloti, rather than general discussion) ","description_text":"This category is for discussions that are related to Axoloti generally but are not specifically about Axoloti.(please ensure it has some relevance to Axoloti, rather than general discussion)","topic_url":"/t/about-the-lounge-category/1277","read_restricted":false,"permission":null,"notification_level":1,"topic_template":null,"has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":11,"name":"Developer","color":"BF1E2E","text_color":"FFFFFF","slug":"developer","topic_count":69,"post_count":672,"position":12,"description":"This category is for discussion about the development of Axoloti at a low level, its intended only for developers/programmers.","description_text":"This category is for discussion about the development of Axoloti at a low level, its intended only for developers/programmers.","topic_url":"/t/about-the-developer-category/735","read_restricted":false,"permission":null,"notification_level":1,"topic_template":"This category is for low level discussion on the development of Axoloti, its is intended for developers/programmers only.","has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null},{"id":3,"name":"Website and Forum","color":"808281","text_color":"FFFFFF","slug":"meta","topic_count":46,"post_count":416,"position":13,"description":"Discussion about this site, its organization, how it works, and how we can improve it.","description_text":"Discussion about this site, its organization, how it works, and how we can improve it.","topic_url":"/t/about-the-meta-category/2","read_restricted":false,"permission":null,"notification_level":1,"topic_template":"","has_children":false,"sort_order":null,"sort_ascending":null,"show_subcategory_list":false,"num_featured_topics":3,"default_view":null,"subcategory_list_style":"rows_with_featured_topics","default_top_period":"all","uploaded_logo":null,"uploaded_background":null}],"trust_levels":[{"id":0,"name":"new user"},{"id":1,"name":"basic user"},{"id":2,"name":"member"},{"id":3,"name":"regular"},{"id":4,"name":"leader"}],"archetypes":[{"id":"regular","name":"Regular Topic","options":[]},{"id":"banner","name":"Banner Topic","options":[]}],"user_fields":[]});
          ps.store("siteSettings", {"title":"Axoloti Community","contact_email":"johannes.taelman@gmail.com","contact_url":"","logo_url":"/uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png","logo_small_url":"/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png","mobile_logo_url":"","favicon_url":"/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png","allow_user_locale":false,"suggested_topics":5,"track_external_right_clicks":false,"ga_universal_tracking_code":"UA-56017691-4","ga_universal_domain_name":"auto","ga_tracking_code":"","ga_domain_name":"","gtm_container_id":"","top_menu":"categories|latest|new|unread|top","post_menu":"like-count|like|share|flag|edit|bookmark|delete|admin|reply","post_menu_hidden_items":"flag|bookmark|edit|delete|admin","share_links":"twitter|facebook|email","desktop_category_page_style":"categories_and_latest_topics","category_colors":"BF1E2E|F1592A|F7941D|9EB83B|3AB54A|12A89D|25AAE2|0E76BD|652D90|92278F|ED207B|8C6238|231F20|808281|B3B5B4|283890","category_style":"bullet","enable_mobile_theme":true,"relative_date_duration":30,"fixed_category_positions":true,"fixed_category_positions_on_create":false,"enable_badges":true,"enable_badge_sql":false,"enable_whispers":false,"invite_only":false,"login_required":false,"must_approve_users":false,"enable_local_logins":true,"allow_new_registrations":true,"enable_signup_cta":true,"enable_google_oauth2_logins":false,"enable_yahoo_logins":false,"enable_twitter_logins":false,"enable_instagram_logins":false,"enable_facebook_logins":false,"enable_github_logins":false,"enable_sso":false,"sso_overrides_avatar":false,"min_username_length":3,"max_username_length":20,"min_password_length":10,"min_admin_password_length":15,"logout_redirect":"","full_name_required":false,"enable_names":true,"invites_per_page":40,"delete_user_max_post_age":60,"delete_all_posts_max":15,"show_email_on_profile":false,"prioritize_username_in_ux":true,"enable_user_directory":true,"allow_anonymous_posting":false,"anonymous_posting_min_trust_level":1,"hide_user_profiles_from_public":false,"enable_group_directory":true,"min_post_length":20,"min_first_post_length":20,"min_private_message_post_length":10,"max_post_length":32000,"topic_featured_link_enabled":true,"min_topic_title_length":15,"max_topic_title_length":255,"min_private_message_title_length":2,"allow_uncategorized_topics":false,"min_title_similar_length":10,"min_body_similar_length":15,"enable_private_messages":true,"edit_history_visible_to_public":false,"delete_removed_posts_after":24,"enable_experimental_markdown_it":false,"traditional_markdown_linebreaks":false,"enable_markdown_typographer":false,"allow_html_tables":false,"suppress_reply_directly_below":true,"suppress_reply_directly_above":true,"max_reply_history":1,"newuser_max_images":1,"newuser_max_attachments":2,"show_pinned_excerpt_mobile":true,"show_pinned_excerpt_desktop":true,"display_name_on_posts":false,"show_time_gap_days":7,"short_progress_text_threshold":10000,"default_code_lang":"auto","autohighlight_all_code":false,"highlighted_languages":"apache|bash|cs|cpp|css|coffeescript|diff|xml|http|ini|json|java|javascript|makefile|markdown|nginx|objectivec|ruby|perl|php|python|sql|handlebars","censored_words":"","censored_pattern":"","enable_emoji":true,"emoji_set":"twitter","code_formatting_style":"4-spaces-indent","allowed_href_schemes":"","email_time_window_mins":10,"disable_digest_emails":false,"email_in":false,"disable_emails":false,"bounce_score_threshold":4,"max_image_size_kb":3072,"max_attachment_size_kb":3072,"authorized_extensions":"jpg|jpeg|png|gif|axo|axp|axs|axh|fpd|brd|axt","max_image_width":690,"max_image_height":500,"prevent_anons_from_downloading_files":false,"enable_s3_uploads":false,"allow_profile_backgrounds":true,"allow_uploaded_avatars":true,"allow_animated_avatars":false,"default_avatars":"","external_system_avatars_enabled":true,"external_system_avatars_url":"/letter_avatar_proxy/v2/letter/{first_letter}/{color}/{size}.png","allow_staff_to_upload_any_file_in_pm":true,"tl1_requires_read_posts":30,"tl3_links_no_follow":false,"use_admin_ip_whitelist":false,"max_oneboxes_per_post":50,"alert_admins_if_errors_per_minute":0,"alert_admins_if_errors_per_hour":0,"max_prints_per_hour_per_user":5,"enable_long_polling":true,"long_polling_base_url":"/","background_polling_interval":60000,"polling_interval":3000,"anon_polling_interval":15000,"flush_timings_secs":20,"verbose_localization":false,"max_new_topics":500,"tos_url":"","privacy_policy_url":"","faq_url":"","maximum_backups":5,"min_search_term_length":3,"version_checks":true,"suppress_uncategorized_badge":true,"topic_views_heat_low":1000,"topic_views_heat_medium":2000,"topic_views_heat_high":5000,"topic_post_like_heat_low":0.5,"topic_post_like_heat_medium":1.0,"topic_post_like_heat_high":2.0,"history_hours_low":12,"history_hours_medium":24,"history_hours_high":48,"cold_age_days_low":14,"cold_age_days_medium":90,"cold_age_days_high":180,"global_notice":"","show_create_topics_notice":true,"bootstrap_mode_min_users":50,"bootstrap_mode_enabled":false,"automatically_unpin_topics":true,"read_time_word_count":500,"disable_mailing_list_mode":false,"default_topics_automatic_unpin":true,"tagging_enabled":true,"tag_style":"simple","max_tags_per_topic":5,"max_tag_length":20,"min_trust_level_to_tag_topics":0,"max_tag_search_results":5,"show_filter_by_tag":true,"tags_sort_alphabetically":false,"staff_tags":"","suppress_overlapping_tags_in_list":false,"discourse_narrative_bot_enabled":true,"poll_enabled":true,"poll_maximum_options":20,"details_enabled":true,"available_locales":"ar|bs_BA|cs|da|de|el|en|es|et|fa_IR|fi|fr|gl|he|id|it|ja|ko|nb_NO|nl|pl_PL|pt|pt_BR|ro|ru|sk|sq|sv|te|tr_TR|uk|ur|vi|zh_CN|zh_TW"});
          ps.store("customHTML", {"top":"","footer":""});
          ps.store("banner", {});
          ps.store("customEmoji", []);
          ps.store("translationOverrides", {});
          ps.store("topic_4701", {"post_stream":{"posts":[{"id":29358,"name":"","username":"thomas11","avatar_template":"/letter_avatar_proxy/v2/letter/t/aeb1de/{size}.png","created_at":"2018-06-19T21:06:45.966Z","cooked":"\u003cp\u003eHi there. I'm very new to both Axoloti and coding (hoping to learn on the Axoloti), so sorry if what I ask is either obvious or doesn't make sense. \u003c/p\u003e\n\n\u003cp\u003eAnyways, I've been perusing the forums here, and thought of a question I couldn't find the answer to. In a nutshell, I'm wondering how both the k-rate and s-rate Hz numbers relate to both the number of lines in a code block and the processor's clock speed.\u003c/p\u003e\n\n\u003cp\u003eSo far, I've picked up that k-rate code is 3 kHz, s-rate is 48 kHz, and the CPU's clock speed is 168 MHz. For the k-/s-rate numbers, does this mean that the Axoloti board will execute the entire code.krate block for an object 3,000 times a second, and the entire code.srate block 48,000 times a second? Or will it only execute 1 line of code in these blocks 3,000/48,000 times a second? Or will it do something else? Basically, what is it that is being done at the 3/48 kHz rates?\u003c/p\u003e\n\n\u003cp\u003eAs for the CPU's clock speed, since it's much higher than the k-/s-rate speeds I'm assuming that there is some multithreading going on, such that the processor is executing multiple k-/s-rate things at the same time. Is this right? And if so, how does the multithreading work at the broad brush strokes level? Is it that each object has its own thread? Or is it ad hoc what gets its own thread? Or is there something I as a developer will need to do to control this aspect of things? Or is it something else?\u003c/p\u003e\n\n\u003cp\u003eAny thoughts you could spare for me would be a huge help. Thanks!\u003c/p\u003e\n\n\u003cp\u003eP.S. Feel free to move this to another category if 'Developer' isn't the right one.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2018-06-19T21:06:45.966Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"avg_time":46,"incoming_link_count":59,"reads":80,"score":313.3,"yours":false,"topic_id":4701,"topic_slug":"k-s-rate-cpu-speed-c-code-and-multithreading","display_username":"","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1776,"hidden":false,"hidden_reason_id":null,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":false,"wiki":false},{"id":29362,"name":"Jason T Harris","username":"deadsy","avatar_template":"/user_avatar/community.axoloti.com/deadsy/{size}/5105_1.png","created_at":"2018-06-20T06:04:40.819Z","cooked":"\u003cp\u003eI'd preface this by saying that I'm fairly new to the axoloti firmware, so if others have better information/insights please correct me.\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eI'm wondering how both the k-rate and s-rate Hz numbers relate to both the \u003cbr\u003enumber of lines in a code block and the processor's clock speed.\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eThey don't...\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eSo far, I've picked up that k-rate code is 3 kHz s-rate is 48 kHz\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eRight. The codec/sai is setup to playback 48000 samples per second.\u003cbr\u003eEach sample is a 32 bit fixed point (q5.27) quantity.\u003cbr\u003eThere are 2 channels of audio.\u003c/p\u003e\n\n\u003cp\u003eSome signals in a synth are relatively slow moving, E.g envelopes.\u003cbr\u003eWe can save memory and cpu by generating them at a slower rate.\u003cbr\u003eIn axoloti the factor is x16, so the k-rate signals have 3000 values/second.\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eand the CPU's clock speed is 168 MHz.\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eRight. The CPU is actually rated for 180 MHz, but ST in their wisdom made it impossible to run the USB with this CPU speed.\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eFor the k-/s-rate numbers, does this mean that the Axoloti board will execute \u003cbr\u003ethe entire code.krate block for an object 3,000 times a second, and the entire \u003cbr\u003ecode.srate block 48,000 times a second?\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eYes. If you write an some object code in the GUI and look at what gets generated you will see the following:\u003c/p\u003e\n\n\u003cp\u003e\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003evoid dsp(blah...) {\n  your_krate_code();\n  for(i = 0 i \u0026lt; BUFSIZE; i ++) {\n    your_srate_code();\n  }\n}\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003eie - your krate code gets called once and the srate code gets called in a 16x loop.\u003cbr\u003eSome of the objects don't bother with the srate code. They just do everything (including the srate work) in the krate code specification.\u003c/p\u003e\n\n\u003cp\u003e16 x 1/48000 = 1/3 ms of signal. So: an object generating an srate signal must be called 3000 times/second.\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eAs for the CPU's clock speed, since it's much higher than the k-/s-rate speeds \u003cbr\u003eI'm assuming that there is some multithreading going on\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eYes, in so far as the firmware uses chibios and chibios supports multiple concurrent tasks/threads.\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003esuch that the processor is executing multiple k-/s-rate things at the same \u003cbr\u003etime. Is this right?\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eNo. One thread is responsible for generating the audio buffers and that is \"ThreadDSP\".\u003c/p\u003e\n\n\u003cp\u003eBasically it works as follows:\u003c/p\u003e\n\n\u003cp\u003eThe codec/SAI needs to be fed at a rate of 48000 samples/second (x 2 channels) to generate clean audio.\u003c/p\u003e\n\n\u003cp\u003eThe SAI is fed by DMA from memory. The DMA is arranged in double buffering mode. ie: when the SAI is reading from one buffer the CPU can be busy filling in the other buffer. When the SAI is done with one buffer the DMA will be switched to the other buffer, so the CPU has to be done with filling it in before this happens.\u003c/p\u003e\n\n\u003cp\u003eEvery time the DMA switches buffers an interrupt gets generated. This interrupt wakes up ThreadDSP and tells it to get busy computing the sound and filling in the output buffer the SAI is not currently reading from.\u003c/p\u003e\n\n\u003cp\u003eTo do this the code calls the patch you have created. See: PatchProcess in xpatch.cpp\u003c/p\u003e\n\n\u003cp\u003eThat code hooks up all the objects you have created and ultimately computes the 16 samples (x2 channels) needed for the audio output.\u003c/p\u003e\n\n\u003cp\u003eWhen you return from your patch the ThreadDSP code will time how long it took and see how much you beat the deadline by. This gives you the CPU load number.\u003c/p\u003e\n\n\u003cp\u003eSo- the bigger the patch, the more complex the objects, the greater the number of voices, the longer it will take the CPU to compute the sound. Every 1/3 ms the ThreadDSP code will wake up and will go full speed trying to get the buffer filled before the SAI needs it.\u003c/p\u003e\n\n\u003cp\u003eHope this helps.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2018-06-20T06:04:40.819Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"avg_time":85,"incoming_link_count":1,"reads":72,"score":68.65,"yours":false,"topic_id":4701,"topic_slug":"k-s-rate-cpu-speed-c-code-and-multithreading","display_username":"Jason T Harris","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"actions_summary":[{"id":2,"count":3}],"moderator":false,"admin":false,"staff":false,"user_id":1672,"hidden":false,"hidden_reason_id":null,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":false,"wiki":false},{"id":29388,"name":"","username":"thomas11","avatar_template":"/letter_avatar_proxy/v2/letter/t/aeb1de/{size}.png","created_at":"2018-06-20T14:13:05.837Z","cooked":"\u003cp\u003e\u003ca class=\"mention\" href=\"/u/deadsy\"\u003e@deadsy\u003c/a\u003e Thanks so much for that. I think it gives me a good handle on things. But to double check that I'm on the right page, the main outline is that Axoloti has two buffers, and at any time one of the buffers is being read from (and I assume output through the audio out?) while the other is being written to. ThreadDSP is the function that does the writing, and the way ThreadDSP does this is by calling the PatchProcess function from xpatch.cpp, which in turn calls my k- and s-rate code through the void dsp(...) function you sketched out above. Finally, ThreadDSP checks to see how much time it had left after it finishes writing to the buffer, and uses that to show me the CPU load. Is that on the right track?\u003c/p\u003e\n\n\u003cp\u003eAlso, reading through your response made me think of a few extra questions. First, are there two buffers because Axoloti has a stereo out and needs one each for the left and right outs, or for some other reason? \u003c/p\u003e\n\n\u003cp\u003eSecond, does the dsp(...) function get generated for each object in a patch, or for the entire patch? \u003c/p\u003e\n\n\u003cp\u003eThird, do you happen to know where I would find the (I assume .c or .cpp) files that include the dsp(...) function? All I've been able to find are the .axo/.axp files that (if I understand correctly) are used to generate the files I'm looking for now.\u003c/p\u003e\n\n\u003cp\u003eAnd last, do you know where I would find the xpatch.cpp file and the file(s) that have the ThreadDSP code? I've found an xpatch.h file under the axoloti-runtime/firmware folder, but this doesn't look to be the file you're talking about. And I haven't had any luck finding ThreadDSP.\u003c/p\u003e\n\n\u003cp\u003eThanks again for the help!\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2018-06-20T14:13:05.837Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"avg_time":31,"incoming_link_count":1,"reads":61,"score":18.75,"yours":false,"topic_id":4701,"topic_slug":"k-s-rate-cpu-speed-c-code-and-multithreading","display_username":"","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1776,"hidden":false,"hidden_reason_id":null,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":false,"wiki":false},{"id":29392,"name":"Jason T Harris","username":"deadsy","avatar_template":"/user_avatar/community.axoloti.com/deadsy/{size}/5105_1.png","created_at":"2018-06-20T17:57:33.974Z","cooked":"\u003cblockquote\u003e\u003cp\u003eIs that on the right track?\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eYes.\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eare there two buffers because Axoloti has a stereo out and needs one each for the left and right outs, or for some other reason?\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003ewell, there are actually 4 defined in ./axoloti/firmware/codec.c\u003c/p\u003e\n\n\u003cp\u003e\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003eint32_t buf[BUFSIZE*2] __attribute__ ((section (\".sram2\")));\nint32_t buf2[BUFSIZE*2] __attribute__ ((section (\".sram2\")));\nint32_t rbuf[BUFSIZE*2] __attribute__ ((section (\".sram2\")));\nint32_t rbuf2[BUFSIZE*2] __attribute__ ((section (\".sram2\")));\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003ebuf/buf2 are for audio output (dac).\u003cbr\u003erbuf/rbuf2 are for audio input (adc).\u003c/p\u003e\n\n\u003cp\u003eFor both input and output there are 2 buffers so they can operate in the aforementioned ping-pong fashion. While the codec is busy with one buffer the cpu is busy with the other buffer. That's a standard DSP technique and has nothing to do with stereo output.\u003c/p\u003e\n\n\u003cp\u003eYou will notice a BUFSIZE*2 for the buffers. The x2 is for the left/right stereo channels. The CPU has to compute 2 channels worth of audio data.\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003edoes the dsp(...) function get generated for each object\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eFor each object. \u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003ewhere I would find the (I assume .c or .cpp) files that include the dsp(...) function?\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eI find it in ./axoloti/build/xpatch.cpp\u003cbr\u003eI'm building the code from source, so it may be different if you have a binary install- but you'll find the generated patch code somewhere amongst the axoloti files. (find | grep xpatch)\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eThreadDSP\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003e./axoloti/firmware/patch.c\u003cbr\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003estatic msg_t ThreadDSP(void *arg) {\u003c/code\u003e\u003c/pre\u003e","post_number":4,"post_type":1,"updated_at":"2018-06-21T04:30:57.587Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"avg_time":34,"incoming_link_count":2,"reads":54,"score":22.5,"yours":false,"topic_id":4701,"topic_slug":"k-s-rate-cpu-speed-c-code-and-multithreading","display_username":"Jason T Harris","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1672,"hidden":false,"hidden_reason_id":null,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":false,"wiki":false},{"id":29395,"name":"","username":"thomas11","avatar_template":"/letter_avatar_proxy/v2/letter/t/aeb1de/{size}.png","created_at":"2018-06-20T22:36:03.737Z","cooked":"\u003cp\u003e\u003ca class=\"mention\" href=\"/u/deadsy\"\u003e@deadsy\u003c/a\u003e Thanks so much for the follow up! I have a good overview of these things now, and a manageable number of files to start looking over for the details.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2018-06-20T22:36:03.737Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"avg_time":7,"incoming_link_count":1,"reads":48,"score":14.95,"yours":false,"topic_id":4701,"topic_slug":"k-s-rate-cpu-speed-c-code-and-multithreading","display_username":"","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1776,"hidden":false,"hidden_reason_id":null,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":false,"wiki":false}],"stream":[29358,29362,29388,29392,29395]},"timeline_lookup":[[1,1560],[4,1559]],"id":4701,"title":"K-/S-Rate, CPU Speed, C Code, and Multithreading","fancy_title":"K-/S-Rate, CPU Speed, C Code, and Multithreading","posts_count":5,"created_at":"2018-06-19T21:06:45.865Z","views":1036,"reply_count":0,"participant_count":2,"like_count":3,"last_posted_at":"2018-06-20T22:36:03.737Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"k-s-rate-cpu-speed-c-code-and-multithreading","category_id":11,"word_count":1546,"deleted_at":null,"user_id":1776,"pm_with_non_human_user":false,"draft":null,"draft_key":"topic_4701","draft_sequence":null,"unpinned":null,"pinned_globally":false,"pinned":false,"pinned_at":null,"pinned_until":null,"details":{"created_by":{"id":1776,"username":"thomas11","avatar_template":"/letter_avatar_proxy/v2/letter/t/aeb1de/{size}.png"},"last_poster":{"id":1776,"username":"thomas11","avatar_template":"/letter_avatar_proxy/v2/letter/t/aeb1de/{size}.png"},"participants":[{"id":1776,"username":"thomas11","avatar_template":"/letter_avatar_proxy/v2/letter/t/aeb1de/{size}.png","post_count":3,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1672,"username":"deadsy","avatar_template":"/user_avatar/community.axoloti.com/deadsy/{size}/5105_1.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null}],"suggested_topics":[{"id":7786,"title":"Anyone tried editing/adding custom controls?","fancy_title":"Anyone tried editing/adding custom controls?","slug":"anyone-tried-editing-adding-custom-controls","posts_count":8,"reply_count":4,"highest_post_number":8,"image_url":null,"created_at":"2022-09-12T12:18:01.091Z","last_posted_at":"2022-09-27T05:18:06.593Z","bumped":true,"bumped_at":"2022-09-27T05:18:06.593Z","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"archetype":"regular","like_count":3,"views":66,"category_id":11,"tags":[],"featured_link":null,"posters":[{"extras":null,"description":"Original Poster","user":{"id":410,"username":"SirSickSik","avatar_template":"/user_avatar/community.axoloti.com/sirsicksik/{size}/5014_1.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":139,"username":"sebiiksbcs","avatar_template":"/user_avatar/community.axoloti.com/sebiiksbcs/{size}/6295_1.png"}}]},{"id":7581,"title":"What would be required to build patcher for browser","fancy_title":"What would be required to build patcher for browser","slug":"what-would-be-required-to-build-patcher-for-browser","posts_count":12,"reply_count":4,"highest_post_number":12,"image_url":null,"created_at":"2021-12-15T05:03:33.291Z","last_posted_at":"2021-12-30T16:26:11.660Z","bumped":true,"bumped_at":"2021-12-30T16:26:11.660Z","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"archetype":"regular","like_count":8,"views":314,"category_id":11,"tags":[],"featured_link":null,"posters":[{"extras":null,"description":"Original Poster","user":{"id":521,"username":"tekknovator","avatar_template":"/user_avatar/community.axoloti.com/tekknovator/{size}/7986_1.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":410,"username":"SirSickSik","avatar_template":"/user_avatar/community.axoloti.com/sirsicksik/{size}/5014_1.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":177,"username":"DIYDSP","avatar_template":"/letter_avatar_proxy/v2/letter/d/6de8d8/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":2111,"username":"tele_player","avatar_template":"/letter_avatar_proxy/v2/letter/t/e47c2d/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":13,"username":"janvantomme","avatar_template":"/user_avatar/community.axoloti.com/janvantomme/{size}/10_1.png"}}]},{"id":7596,"title":"Possible to upload files to SD card via script or code?","fancy_title":"Possible to upload files to SD card via script or code?","slug":"possible-to-upload-files-to-sd-card-via-script-or-code","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-01-03T12:01:58.112Z","last_posted_at":"2022-01-03T13:59:18.519Z","bumped":true,"bumped_at":"2022-01-03T13:59:18.519Z","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"archetype":"regular","like_count":0,"views":143,"category_id":11,"tags":[],"featured_link":null,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":2301,"username":"ivofx","avatar_template":"/letter_avatar_proxy/v2/letter/i/c57346/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":13,"username":"janvantomme","avatar_template":"/user_avatar/community.axoloti.com/janvantomme/{size}/10_1.png"}}]},{"id":7592,"title":"Is Axoloti over?","fancy_title":"Is Axoloti over?","slug":"is-axoloti-over","posts_count":24,"reply_count":11,"highest_post_number":24,"image_url":null,"created_at":"2021-12-25T09:30:28.248Z","last_posted_at":"2022-03-10T21:31:30.522Z","bumped":true,"bumped_at":"2022-03-11T08:24:47.396Z","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"archetype":"regular","like_count":62,"views":944,"category_id":5,"tags":[],"featured_link":null,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1936,"username":"DrKoma","avatar_template":"/user_avatar/community.axoloti.com/drkoma/{size}/6977_1.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":337,"username":"Blindsmyth","avatar_template":"/letter_avatar_proxy/v2/letter/b/2acd7d/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":775,"username":"AndrewChi","avatar_template":"/letter_avatar_proxy/v2/letter/a/4af34b/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1436,"username":"servandisco","avatar_template":"/user_avatar/community.axoloti.com/servandisco/{size}/6750_1.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":967,"username":"SmashedTransistors","avatar_template":"/user_avatar/community.axoloti.com/smashedtransistors/{size}/3147_1.png"}}]},{"id":7522,"title":"My Axo Sampler is not Mono compatible","fancy_title":"My Axo Sampler is not Mono compatible","slug":"my-axo-sampler-is-not-mono-compatible","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-11-05T13:10:18.404Z","last_posted_at":"2021-11-15T22:07:56.813Z","bumped":true,"bumped_at":"2021-11-15T22:07:56.813Z","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"archetype":"regular","like_count":0,"views":226,"category_id":7,"tags":[],"featured_link":null,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1913,"username":"kryshe","avatar_template":"/letter_avatar_proxy/v2/letter/k/fbc32d/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":337,"username":"Blindsmyth","avatar_template":"/letter_avatar_proxy/v2/letter/b/2acd7d/{size}.png"}}]}],"notification_level":1,"can_flag_topic":false},"highest_post_number":5,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":null,"tags":[],"featured_link":null,"topic_timer":null,"message_bus_last_id":34});
      })();
      </script>

    

    <script>
  Ember.RSVP.configure('onerror', function(e) {
    // Ignore TransitionAborted exceptions that bubble up
    if (e && e.message === "TransitionAborted") { return; }

    window.onerror(e && e.message, null,null,null,e);
  });
</script>

<script>

  (function() {
    var ps = require('preload-store').default;

    Discourse.CDN = '';
    Discourse.BaseUrl = 'community.axoloti.com'.replace(/:[\d]*$/,"");
    Discourse.BaseUri = '';
    Discourse.Environment = 'production';
    Discourse.SiteSettings = ps.get('siteSettings');
    Discourse.LetterAvatarVersion = '5_9b142ce9460b8c6b265fd9abf598d3fd';
    I18n.defaultLocale = 'en';
    Discourse.start();
    Discourse.set('assetVersion','d1ec72c862674d2eea0eb8ef6fc5934f');
    Discourse.Session.currentProp("disableCustomCSS", false);
    Discourse.HighlightJSPath = "/highlight-js/community.axoloti.com/100444ceef8ca161334f64d3ce49fe7a1556f943.js";
  })();
</script>

<link rel='preload' href='/assets/browser-update-f57286e74ddbc53aa899689b01ef467078911e4138050c561939955849af35dd.js' as='script'/>
<script src='/assets/browser-update-f57286e74ddbc53aa899689b01ef467078911e4138050c561939955849af35dd.js'></script>


    

      
    
  </body>
</html>
