<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/axo-delay-implementation/3186 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:40:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Axo delay implementation - AxoObject coding - Axoloti Community</title>
    <meta name="description" content="Hi there, so for a project i&amp;#39;m doing for university, i am attempting to make a delay among other things (chorus &amp;amp; flanger, but they are derivatives on delay), and have found the way its done in factory objects is rather &amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="3186.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Axo delay implementation&#39;" href="3186.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/uploads/default/original/2X/5/52b2c1c7d20ff5d131a5b212ebaa571c4fa62647.jpg" />
<meta property="og:image" content="http://community.axoloti.com/uploads/default/original/2X/5/52b2c1c7d20ff5d131a5b212ebaa571c4fa62647.jpg" />
<meta property="og:url" content="http://community.axoloti.com/t/axo-delay-implementation/3186" />
<meta name="twitter:url" content="http://community.axoloti.com/t/axo-delay-implementation/3186" />
<meta property="og:title" content="Axo delay implementation" />
<meta name="twitter:title" content="Axo delay implementation" />
<meta property="og:description" content="Hi there, so for a project i&#39;m doing for university, i am attempting to make a delay among other things (chorus &amp; flanger, but they are derivatives on delay), and have found the way its done in factory objects is rather different to what i&#39;ve been taught. To clear up any confusion, the object i am using is a combination of delay rite/read interp. If we look at the local data it seems there are 3 delay related variables    [image]   I can see what these are defined as, but not really sure as to w..." />
<meta name="twitter:description" content="Hi there, so for a project i&#39;m doing for university, i am attempting to make a delay among other things (chorus &amp; flanger, but they are derivatives on delay), and have found the way its done in factory objects is rather different to what i&#39;ve been taught. To clear up any confusion, the object i am using is a combination of delay rite/read interp. If we look at the local data it seems there are 3 delay related variables    [image]   I can see what these are defined as, but not really sure as to w..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="6 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="2 ❤" />

      <link rel="next" href="31864658.html?page=2">

  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="3186.html">Axo delay implementation</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/axoobject-code.html" itemprop="url">
        <span itemprop="title">AxoObject coding</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Walla.html'><b itemprop='author'>Walla</b></a>
           
           <time datetime='2017-04-05T16:35:35Z' itemprop='datePublished'>
             2017-04-05 16:35:35 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi there, so for a project i'm doing for university, i am attempting to make a delay among other things (chorus &amp; flanger, but they are derivatives on delay), and have found the way its done in factory objects is rather different to what i've been taught. To clear up any confusion, the object i am using is a combination of delay rite/read interp.<br>If we look at the local data it seems there are 3 delay related variables </p>

<p><img src="../../uploads/default/original/2X/5/52b2c1c7d20ff5d131a5b212ebaa571c4fa62647.jpg" width="388" height="81"></p>

<p>I can see what these are defined as, but not really sure as to what each of them really do. In the processing code (s-rate) "LENGTH" isn't actually used at all, only LENGTHPOW * LENGTHMASK are used. </p>

<p><img src="../../uploads/default/original/2X/d/de1f4c2a05207e0e848344400113f5b2c571411f.jpg" width="459" height="213"></p>

<p>If we look at line 2 &amp; 3 for example, this looks like the inlet actually being written to the buffer, but unsure as to what &amp;LENGTHMASK is doing? and LENGTHPOW for that matter</p>

<p>And again with the processing code from read interp, I've been taught how to use buffers by having a read and a write pointer in a circular buffer that wraps around, but cant see anything to do with a read pointer, instead it looks like on line 7, tmp_di is a variable relating to the write point which acts as the read point, is this right ? but the code after that does get a bit lost on me, its so different to what i was taught! You're probably just thinking why not use what you where taught ? well i i would love to, but we where given a framework to work in written by our lecturer, and haven't had much success in porting it over (way too many error messages)</p>

<p>The main reason i am investigating all of this is because i am attempting to make a chorus from this as a building block, i have put the lfo inside the object and that all works, but i cant seem to figure out where to apply the lfo as there isnt an obvious read pointer! </p>

<p>Here is what i've done so far <a class="attachment" href="../../uploads/default/original/2X/c/dead%20chorus.axo">dead chorus.axo</a> (4.1 KB) please let me know if you can help <img src="../../images/emoji/emoji_one/slight_smile30f4.png?v=3" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jaffasplaffa.html'><b itemprop='author'>jaffasplaffa</b></a>
           
           <time datetime='2017-04-05T17:27:03Z' itemprop='datePublished'>
             2017-04-05 17:27:03 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="1" data-topic="3186"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/walla/40/3814_1.html" class="avatar">Walla:</div>
<blockquote><p>LENGTH</p></blockquote></aside>

<p>I am pretty sure it refers to size and length of the delay line. You know, the attribute where you set the delay length in 1024, 2048, 4096, etc...</p>

<p>When I look at the picture I see it is not a factory delay line, cause the reference to the delay/write object has been removed. WHich one are you working on? The attr_ references for the array and writpos, which is usually located in the delay/write sdram object have been removed.</p>

<p>So if this is a combined object of the delay/write and the delay/read int, take a look in the local code page. There you should see this:<br><img src="../../uploads/default/original/2X/4/48f21bdd7deca3fb733d034125db72cfdc6cb78d.png" width="540" height="235"></p>

<p>If not a combined object, then look inside the delay/write sdram.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Walla.html'><b itemprop='author'>Walla</b></a>
           
           <time datetime='2017-04-05T17:47:51Z' itemprop='datePublished'>
             2017-04-05 17:47:51 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>It looks like LEGTHPOW is the normal delay size, then what about the (1&lt;&lt;attr_size) for LENGTH and LENGTHMASK ?</p>

<p>I did write in the original post but there was a lot of writing so could have got a bit lost, i have combined the factory read/write interp into one object, what makes you think its not factory ? i have that same section you posted as the first picture in my initial post.</p>

<p>I can see what the names are, it just this has been done very differently to the only way in which i know, so i need to try and get my head around whats going on with each variable, as i understand the processes involved, i just can't pick that out from the code. Does that make sense ?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jaffasplaffa.html'><b itemprop='author'>jaffasplaffa</b></a>
           
           <time datetime='2017-04-05T17:55:54Z' itemprop='datePublished'>
             2017-04-05 17:55:54 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="3" data-topic="3186"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/walla/40/3814_1.html" class="avatar">Walla:</div>
<blockquote><p>what makes you think its not factory ?</p></blockquote></aside>

<p>Cause the factory objects are NOT combined. They are seperate, Anyway, i doesnt really matter <img src="../../images/emoji/emoji_one/slight_smile30f4.png?v=3" title=":slight_smile:" class="emoji" alt=":slight_smile:"> </p>

<aside class="quote" data-post="3" data-topic="3186"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/walla/40/3814_1.html" class="avatar">Walla:</div>
<blockquote><p>It looks like LEGTHPOW is the normal delay size, then what about the (1&lt;&lt;attr_size) for LENGTH and LENGTHMASK ?</p></blockquote></aside>

<p>I opened the code and looked. Look in "local code". There you see all three. If you want to find where the LENGTH is used, look in "init code". But in general ALL three refers to the delay size;<br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/540c2f854760d29d787d86c0d0ee409e8b5a8519" href="../../uploads/default/original/2X/5/540c2f854760d29d787d86c0d0ee409e8b5a8519.png" class="lightbox" title="1.png"><img src="../../uploads/default/optimized/2X/5/540c2f854760d29d787d86c0d0ee409e8b5a8519_1_690x138.png" width="690" height="138"><div class="meta">
<span class="filename">1.png</span><span class="informations">830x166 19.3 KB</span><span class="expand"></span>
</div></a></div></p>

<p><img src="../../uploads/default/original/2X/6/6240c044b10c5fe0774bf5410f230cfb8a31ab69.png" width="170" height="185"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Walla.html'><b itemprop='author'>Walla</b></a>
           
           <time datetime='2017-04-05T18:03:50Z' itemprop='datePublished'>
             2017-04-05 18:03:50 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Sorry should have been more clear then, it is a 'custom' object combined of the factory read/write <img src="../../images/emoji/emoji_one/slight_smile30f4.png?v=3" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>

<p>My general question was about what these 3 are each actually doing, why have 3 variables for the length of the buffer ? for example whats the point of having LENGTH bitshifted left 1 position ?<br>but the second part was more trying to get an understanding of whats going on in the s-rate code for the delay/read interp and how those variables are being used, as ultimately i want to be modulating the read position with the LFO, as there isn't a specific function for the read pointer</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jaffasplaffa.html'><b itemprop='author'>jaffasplaffa</b></a>
           
           <time datetime='2017-04-05T18:05:33Z' itemprop='datePublished'>
             2017-04-05 18:05:33 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Sorry cant help you wit that. I am still learning things like that, so I am definately following your post <img src="../../images/emoji/emoji_one/slight_smile30f4.png?v=3" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Walla.html'><b itemprop='author'>Walla</b></a>
           
           <time datetime='2017-04-05T18:07:51Z' itemprop='datePublished'>
             2017-04-05 18:07:51 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>No worries! yes its quite hard just going from code without any comments or documentation, i think that is going to be one of the next big steps to get this product to the masses, documentation!</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:2'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2017-04-05T18:15:06Z' itemprop='datePublished'>
             2017-04-05 18:15:06 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>mod note: ive renamed topic to a bit a bit clearer</p>

<p>I suspect its doing as you have been taught, just it using binary operations to keep it efficient..</p>

<p>LENGTHMASK is being used as a modulo operation to keep the array read within bounds.</p>

<p>LENGTHPOW <br>first instance to calculate the read position, (this is a division, taking into account <a href="../coding-axoloti-objects/2606.html">this is in Q27 format, see user guide for more on this</a>)<br>second instance, this is part of the interpolation, so how much of the delay time, is between samples.</p>

<p>sorry this is a bit 'overview' , the best idea is to work thru an example. <br>this integer maths is at first a bit confusing, again check the post in the user guide section.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2017-04-05T18:27:33Z' itemprop='datePublished'>
             2017-04-05 18:27:33 UTC
           </time>
        </span>
        <span itemprop='position'>#9</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>btw: if you are doing this for 'educational purposes' , I'm not sure id advise going down the whole Q27/integer maths route, its not really going to gain you much understanding in delay lines/fx (if that's your goal), and its hard when reading code, to try to learn multiple things at the same time.</p>

<p>so I think, I would be tempted to convert the audio/parameters into floats, and use a more understandable implementation... (as you are being taught), similarly your implementation doesn't need to use the optimisation tips used by the factory objects. </p>

<p>once you have your 'simple' implementation working, then you can take that knowledge and go back and revise to a more optimised form if you feel its necessary - but then you will be able to concentrate on that, rather than the delay implementation.</p>

<p>just my personal opinion , I'm sure you'll get there in the end either way.</p>

<p>EDIT, for float to int32 and back you need q27_to_float(), and float_to_q27(), <br>if you look at fx/rngs/reverb k-rate code you will see us doing this conversion.<br>(you don't need to look at the reverb code, just how its doing the conversion in Axoloti to float, which is probably how you've been taught delay lines)</p>

<aside class="quote" data-post="7" data-topic="3186"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/walla/40/3814_1.html" class="avatar">Walla:</div>
<blockquote><p>yes its quite hard just going from code without any comments or documentation, i think that is going to be one of the next big steps to get this product to the masses, documentation!</p></blockquote></aside>

<p>I think that's probably an unrealistic expectation, I don't Axoloti factory objects are created to be an education in how to write dsp code/integer maths, rather to provide a visual patching environment so users do <strong>not</strong> have to know about dsp coding. <br>if you can learn coding techniques from them (as I have)  I personally have seen this as a bonus.<br>(Johannes may have a different opinion, this is just my view)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Walla.html'><b itemprop='author'>Walla</b></a>
           
           <time datetime='2017-04-07T17:34:45Z' itemprop='datePublished'>
             2017-04-07 17:34:45 UTC
           </time>
        </span>
        <span itemprop='position'>#10</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>So first of all thanks <a class="mention" href="../../users/thetechnobear.html">@thetechnobear</a> for another very helpful reply, much appreciated! also good choice in title update, mine was a bit vague.</p>

<p>I have taken your advice and a converting all data into floats for my working and then back again for the output which has helped me in other areas (distortion implementation).</p>

<p>I started trying to port over my old code into axo and i seem to have run into a bit of a halt. Basically, i set it all up as it worked with xcode, changing variable names and references of course so they match the axo framework, and when i run the object, the compiler takes a little longer than normal to run, then when it runs i got a couple of odd, squeaky noises, spits out a huuuge error in the console window and then crashes.<br>Before it crashed, i got a really quick look at the console and it said something about overflow of 2605 samples, which i'm assuming is something to do with how i'm creating and using my buffer, but i'm really not too sure as its not something i dealt with on my course. </p>

<p>So after axo had crashed i lost my object, so i re-wrote it out (only a few lines) and now when i go to compile the green LED flashes really fast, then it seems to reboot as it disconnects from my laptop, while both led's flash and im back to the start <img src="../../images/emoji/emoji_one/confused30f4.png?v=3" title=":confused:" class="emoji" alt=":confused:"> there is now no more error in console, only:<br>Starting patch...<br>patch start taking too long, disconnecting<br>Disconnect request<br>Done starting patch</p>

<p>Have uploaded the object in question. All i want to be doing here is taking the input and adding to buffer, then have a fixed delay time of 0.25s mixed with the original. All variable names should be obvious <a class="attachment" href="../../uploads/default/original/2X/a/simple%20echo.axo">simple echo.axo</a> (1.6 KB)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2017-04-07T18:36:35Z' itemprop='datePublished'>
             2017-04-07 18:36:35 UTC
           </time>
        </span>
        <span itemprop='position'>#11</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ok, I don't have time to debug your code, so I can only point out some errors that 'stand out' to me.</p>

<p>the main issue, is you are trying to store the float signal into a 16 bit int, its should be a float (which is 32bit), make your array a float.</p>

<p>( are you not getting 'type conversion' warnings when you compile this?)  </p>

<p></p><pre><code class="lang-auto">buffreadpos = buffwritepos - 12000; 
if(buffreadpos &lt; 0) buffreadpos = 0;</code></pre>

<p>this is wrong,<br>essentially what your trying to do is create a circular buffer... <br>if the writepos = 100, then readpos = 12000 -writepos,<br>i.e. 11500</p>

<p>note, you  also need to be careful here, if your buffer size is less that the delay line size, you need to handle this too.<br>(your default is 5000, so cannot work for 12000 samples)</p>

<p>also your check will not work..<br>bufferreadpos will never be &lt;  0 as you have declared it as a uint, i.e. an unsigned int... </p>

<p>this is probably what is crashing your patch, as on the first execution<br>bufreadpos = 0-12000, which will evaluation to  UINT32_MAX-12000, <br>which is a very large number, well beyond your array boundary <img src="../../images/emoji/emoji_one/wink30f4.png?v=3" title=":wink:" class="emoji" alt=":wink:"></p>

<p>finally, if you are using larger delay lines you will want to declare the array in sdram, as the default (sram) is quite small... look up one of the factory objects with sdram in title to see how to do this.</p>

<p>also id be tempted to add a 'wet/dry' param, so your out only has a part of you in signal.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Walla.html'><b itemprop='author'>Walla</b></a>
           
           <time datetime='2017-04-08T13:49:55Z' itemprop='datePublished'>
             2017-04-08 13:49:55 UTC
           </time>
        </span>
        <span itemprop='position'>#12</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>awesome, dont worry about that! that fact you can find time to help me at all i am gracious for <img src="../../images/emoji/emoji_one/slight_smile30f4.png?v=3" title=":slight_smile:" class="emoji" alt=":slight_smile:"> you must be a very busy man!</p>

<p>aha thought there might have been a few oversights in the porting of code, sorted, and no not that i saw!</p>

<blockquote><p>buffreadpos = buffwritepos - 12000; <br>if(buffreadpos &lt; 0) buffreadpos = 0;</p></blockquote>

<p>This little bit is giving me quite a hard time to get my head around its wrong because this is the way we've been taught and is in my working code. I understand your example, but not sure as to what the work around would be. <br>To create the circular buffer, you wrap the write/read pointers so for the read, instead of the above code, would it be something like:</p>

<blockquote><p>buffreadpos = buffwritepos - 12000; <br>if(buffreadpos &lt;= 0) buffreadpos = buffreadpos + attr_size;</p></blockquote>

<p>this in my head would fix it as it would just add the full buffer size with the offset from being negative ?</p>

<p>Have now declared the array into sdram, was getting the error: incompatible types in assignment of 'float*' to 'float* [17]' for this line...</p>

<blockquote><p>array = &amp;_array[parent-&gt;polyIndex][0];</p></blockquote>

<p>but a pointer to the declaration in local data seemed to solve that.</p>

<p>Think there is something wrong with my floats though somewhere, these 2 lines of code which are the only ones accessing the array, are giving me the error <em>"can't convert float to float in assignment"</em>, which has me headscratching as the only time im converting from/to a float is on an inlet variable first thing when audio comes in and last thing as audio is sent to the outlet.</p>

<blockquote><p>array[writepos] = fIn; <br>fDelSig = array[readpos];</p></blockquote>

<p>Does that error message imply that because the array is a float, the input will automatically get converted before it goes into the array ? that is my only thought (fIn and fDelSig are delcared as float type)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2017-04-09T10:54:49Z' itemprop='datePublished'>
             2017-04-09 10:54:49 UTC
           </time>
        </span>
        <span itemprop='position'>#13</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>sorry dont have time to read now...<br>the 'trick' with this, is probably to actually track readpos (not write) and use modulo </p>

<p>off the top of my head something like </p>

<pre><code>r = (r + 1) % len;
w = (r + delay) % len</code></pre>

<p>(could be wrong, as I've not really thought it thru <img src="../../images/emoji/emoji_one/wink30f4.png?v=3" title=":wink:" class="emoji" alt=":wink:">)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Walla.html'><b itemprop='author'>Walla</b></a>
           
           <time datetime='2017-04-09T12:07:35Z' itemprop='datePublished'>
             2017-04-09 12:07:35 UTC
           </time>
        </span>
        <span itemprop='position'>#14</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <blockquote><p>sorry dont have time to read now...<br>No worries! as i said earlier the fact you have time to lend a hand every now and then i am grateful for <img src="../../images/emoji/emoji_one/slight_smile30f4.png?v=3" title=":slight_smile:" class="emoji" alt=":slight_smile:"> you are a big help!</p></blockquote>

<p>does your "% len" refer to the percentage of buffer used ?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Sputnki.html'><b itemprop='author'>Sputnki</b></a>
           
           <time datetime='2017-04-09T12:18:08Z' itemprop='datePublished'>
             2017-04-09 12:18:08 UTC
           </time>
        </span>
        <span itemprop='position'>#15</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="../../users/walla.html">@Walla</a> <br><a href="http://www.cplusplus.com/forum/general/19502/" class="onebox" target="_blank" rel="nofollow noopener">http://www.cplusplus.com/forum/general/19502/</a></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Walla.html'><b itemprop='author'>Walla</b></a>
           
           <time datetime='2017-04-09T12:22:54Z' itemprop='datePublished'>
             2017-04-09 12:22:54 UTC
           </time>
        </span>
        <span itemprop='position'>#16</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>thank you <a class="mention" href="../../users/sputnki.html">@Sputnki</a> for the link, since technobear responded i have looked into this and can now see the big benefit of having a modulo (wondering why i didn't get taught this!).</p>

<p>The main issue im having at the minute is this error when trying to input/output the buffer</p>

<blockquote><p>cant convert 'float to float' in assignment</p></blockquote>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Sputnki.html'><b itemprop='author'>Sputnki</b></a>
           
           <time datetime='2017-04-09T12:28:18Z' itemprop='datePublished'>
             2017-04-09 12:28:18 UTC
           </time>
        </span>
        <span itemprop='position'>#17</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Are you executing code in k-rate or s-rate?</p>

<p>Because if you want to access buffered inlets or outlets (red) in k-rate, you need to specify the exact sample..</p>

<p>For example be out a frac32buffer outlet: in k-rate</p>

<p></p><pre><code class="lang-auto">outlet_out[15] = value;</code></pre>

<p>While, in s-rate:<br></p>

<p></p><pre><code class="lang-auto">outlet_out = value;</code></pre>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Walla.html'><b itemprop='author'>Walla</b></a>
           
           <time datetime='2017-04-09T12:33:26Z' itemprop='datePublished'>
             2017-04-09 12:33:26 UTC
           </time>
        </span>
        <span itemprop='position'>#18</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>All processing code is being done in s-rate</p>

<p>Thought i would see what would happen if you just write the q27 inlet to the buffer and as expected you get</p>

<blockquote><p>invalid conversion from int32_t (aka long int) to float</p></blockquote>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Sputnki.html'><b itemprop='author'>Sputnki</b></a>
           
           <time datetime='2017-04-09T12:37:11Z' itemprop='datePublished'>
             2017-04-09 12:37:11 UTC
           </time>
        </span>
        <span itemprop='position'>#19</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Uhm, that's strange. Try casting it to int32_t, though i doubt it will solve anything</p>

<p>outlet_out = (in32_t) yourfloatvariable;</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Walla.html'><b itemprop='author'>Walla</b></a>
           
           <time datetime='2017-04-09T12:45:49Z' itemprop='datePublished'>
             2017-04-09 12:45:49 UTC
           </time>
        </span>
        <span itemprop='position'>#20</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yep same error unfortunately <img src="../../images/emoji/emoji_one/confused30f4.png?v=3" title=":confused:" class="emoji" alt=":confused:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Axo delay implementation'>
      <hr>
  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement'>
      <span itemprop='url'><b><a rel="next" itemprop="name" href="31864658.html?page=2">next page →</a></b></span>
  </div>





    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/axo-delay-implementation/3186 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:40:48 GMT -->
</html>
