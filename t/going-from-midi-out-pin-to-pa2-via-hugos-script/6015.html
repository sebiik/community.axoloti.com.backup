<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/going-from-midi-out-pin-to-pa2-via-hugos-script/6015 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 16 Jul 2023 18:19:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Going from Midi Out Pin to PA2 via Hugo&#39;s script - Hardware - Axoloti Community</title>
    <meta name="description" content="I try to send Midi from 1 board to another via the Midi Out Pin to PA3 with @Hugo&amp;#39;s script...It doesn&amp;#39;t work...does anyone know why? Sending from PA2 to PA3 with the script works... [image]">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="6015.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Going from Midi Out Pin to PA2 via Hugo&#39;s script&#39;" href="6015.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/uploads/default/optimized/2X/b/b33601852658882ae9d46cebc69522964a78c21c_1_386x500.jpg" />
<meta property="og:image" content="http://community.axoloti.com/uploads/default/optimized/2X/b/b33601852658882ae9d46cebc69522964a78c21c_1_386x500.jpg" />
<meta property="og:url" content="http://community.axoloti.com/t/going-from-midi-out-pin-to-pa2-via-hugos-script/6015" />
<meta name="twitter:url" content="http://community.axoloti.com/t/going-from-midi-out-pin-to-pa2-via-hugos-script/6015" />
<meta property="og:title" content="Going from Midi Out Pin to PA2 via Hugo&#39;s script" />
<meta name="twitter:title" content="Going from Midi Out Pin to PA2 via Hugo&#39;s script" />
<meta property="og:description" content="I try to send Midi from 1 board to another via the Midi Out Pin to PA3 with @Hugo&#39;s script...It doesn&#39;t work...does anyone know why? Sending from PA2 to PA3 with the script works...  [image]" />
<meta name="twitter:description" content="I try to send Midi from 1 board to another via the Midi Out Pin to PA3 with @Hugo&#39;s script...It doesn&#39;t work...does anyone know why? Sending from PA2 to PA3 with the script works...  [image]" />


  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="http://community.axoloti.com/uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="6015.html">Going from Midi Out Pin to PA2 via Hugo&#39;s script</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/hardware.html" itemprop="url">
        <span itemprop="title">Hardware</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Blindsmyth.html'><b itemprop='author'>Blindsmyth</b></a>
           
           <time datetime='2019-09-19T16:56:27Z' itemprop='datePublished'>
             2019-09-19 16:56:27 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I try to send Midi from 1 board to another via the Midi Out Pin to PA3 with <a class="mention" href="../../u/hugo-2.html">@Hugo</a>'s script...It doesn't work...does anyone know why? Sending from PA2 to PA3 with the script works...<br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/b33601852658882ae9d46cebc69522964a78c21c" href="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/2X/b/b33601852658882ae9d46cebc69522964a78c21c.jpg" class="lightbox" title="Bildschirmfoto 2019-09-19 um 19.00.57.jpg"><img src="http://community.axoloti.com/uploads/default/optimized/2X/b/b33601852658882ae9d46cebc69522964a78c21c_1_386x500.jpg" width="386" height="500"><div class="meta">
<span class="filename">Bildschirmfoto 2019-09-19 um 19.00.57.jpg</span><span class="informations">1108x1432 452 KB</span><span class="expand"></span>
</div></a></div></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Going from Midi Out Pin to PA2 via Hugo&#39;s script'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/weasel79.html'><b itemprop='author'>weasel79</b></a>
           
           <time datetime='2019-09-19T22:49:31Z' itemprop='datePublished'>
             2019-09-19 22:49:31 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i just used hugos scripts a couple days ago and iirc they are by default configured to send from TX/RX to RX/TX of the other board, so PA2 to other board PA3 and PA3 to other board PA2. the JP2 connectors usually are not involved i think?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Going from Midi Out Pin to PA2 via Hugo&#39;s script'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Blindsmyth.html'><b itemprop='author'>Blindsmyth</b></a>
           
           <time datetime='2019-09-19T23:13:12Z' itemprop='datePublished'>
             2019-09-19 23:13:12 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I want to use the regular midi out because I want to use all the convenient midi objects, like midi thru, clock out etc.</p>

<p>So<br>Axo 1 regular midi out ---&gt; Axo 2 PA3 script midi in </p>

<p>But maybe this doesnt work pin to pin...<br>For now I go PA2-PA3 but it's pain in the ass to forward like 20+cc values with this script objects and I haven't figured out how to send midi clock with the script...</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Going from Midi Out Pin to PA2 via Hugo&#39;s script'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/weasel79.html'><b itemprop='author'>weasel79</b></a>
           
           <time datetime='2019-09-19T23:16:43Z' itemprop='datePublished'>
             2019-09-19 23:16:43 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i worked on some hugo serial stuff, you can easily just have a small object on Axo1 that just fowards ALL midi data to PA2? for clock, you might have to add some code, eg from <a class="mention" href="../../u/a773.html">@a773</a> <code>midithru_incl_clock</code> object:</p>

<pre><code>if ((status_type == MIDI_CONTROL_CHANGE) ||
                (status_type == MIDI_NOTE_OFF) ||
                (status_type == MIDI_NOTE_ON) ||
                (status_type == MIDI_POLY_PRESSURE) ||
                (status_type == MIDI_PITCH_BEND)) {
                    MidiSend3((midi_device_t) attr_output,status,data1,data2);
                    flash_cnt = FLASH_LEN;
            } else if ( (status_type == MIDI_PROGRAM_CHANGE) ||
                        (status_type == MIDI_CHANNEL_PRESSURE)) {
                MidiSend2((midi_device_t) attr_output,status,data1);
                flash_cnt = FLASH_LEN;
            } else if ((status == MIDI_TIMING_CLOCK) ||
      			(status == MIDI_START) ||
    				(status == MIDI_CONTINUE) ||
      			(status == MIDI_STOP)) {
    				MidiSend1((midi_device_t) attr_output,status);
  				}</code></pre>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Going from Midi Out Pin to PA2 via Hugo&#39;s script'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Blindsmyth.html'><b itemprop='author'>Blindsmyth</b></a>
           
           <time datetime='2019-09-19T23:39:15Z' itemprop='datePublished'>
             2019-09-19 23:39:15 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Ok thanks but where would I put this code? into the script part or the k-rate part? I didn't really understand how these objects in hugos examples work, or rather I don't get the connection between the script part and the object part.</p>

<p>I'm sorry, I'm quite diletantic with code I didn't get much further as copy pasting code from different objects together.</p>

<p>P.S. What I want more precisely is to forward all midi data from usb host port of axo 1 to axo 2, and have the midi clock out patchable like with the clock_tx object od drj.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Going from Midi Out Pin to PA2 via Hugo&#39;s script'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/weasel79.html'><b itemprop='author'>weasel79</b></a>
           
           <time datetime='2019-09-19T23:43:22Z' itemprop='datePublished'>
             2019-09-19 23:43:22 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>something like that would go in the sending object, top right in hugos midi script, on Axo1, to forward all USB or other incoming midi data to serial TX. then on Axo2 you have the top left script which just forwards all RX data to internal midi so on Axo2 you can then use all regular midi objects.<br>you need to kind of merge hugos script with a midi thru script. edit both the scrip and the embedded object midi code. if you have a day or two i can send the objects i made last week.</p>

<p>if you wanna alter/add midi clock on Axo1 to send to Axo2, you need some more ptaching. maybe there are clock-to-internal-midi objects? look into interal midi. cause anything you send to that egts caught by hugos sender object.</p>

<p>edit:<br>so heres the code to go into the "script", you need to add SendMidi1 according "midithru_incl_clock" object... or just copy the whole filtering from there, i left some stuff out iirc.</p>

<pre><code>    void setup(){

    }

    void SendMidi3(uint8_t b0,uint8_t b1,uint8_t b2){
      sdPut(&amp;SD2,b0);
      sdPut(&amp;SD2,b1);
      sdPut(&amp;SD2,b2);
    }
    void SendMidi2(uint8_t b0,uint8_t b1){
      sdPut(&amp;SD2,b0);
      sdPut(&amp;SD2,b1);
    }

    void loop(){
    //chThdSleepMilliseconds(10);
      if (this-&gt;trig){
      	uint8_t status_type = status &amp; 0xF0;
      	if ( (status_type == MIDI_PROGRAM_CHANGE) ||
              (status_type == MIDI_CHANNEL_PRESSURE)){
              	SendMidi2(this-&gt;status,this-&gt;data1);
              }
         else SendMidi3(this-&gt;status,this-&gt;data1,this-&gt;data2);
      	LogTextMessage("Sending: %d - %d - %d",this-&gt;status,this-&gt;data1,this-&gt;data2);
      	this-&gt;trig2 = 1;
      }
     
      
    }</code></pre>

<p>local data of the embedded object:</p>

<pre><code>uint8_t bstatus, bdata1, bdata2;
uint8_t status, data1, data2;
bool trig, trig2, btrig;

attr_script
msg_t ThreadX2(){
  setup();
  while(!chThdShouldTerminate()){
     loop();
     chThdSleepMilliseconds(1);
  }
  chThdExit((msg_t)0);
}
static msg_t ThreadX(void *arg) {
((attr_parent *)arg)-&gt;ThreadX2();
}
WORKING_AREA(waThreadX, 1024);
Thread *Thd;</code></pre>

<p>and k-rate of embedded script object:</p>

<pre><code>    this-&gt;data1 = bdata1;
    this-&gt;data2 = bdata2;
    this-&gt;trig = btrig;
    if (this-&gt;trig2) { btrig = 0;this-&gt;trig2 = 0;}</code></pre>

<p>this all might have some weird hacks and shit in there, it was working but i cahnged my mind, resorted to an usb chain and then crashed my whole system for 5 days. so good luck haha.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Going from Midi Out Pin to PA2 via Hugo&#39;s script'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Blindsmyth.html'><b itemprop='author'>Blindsmyth</b></a>
           
           <time datetime='2019-09-19T23:50:25Z' itemprop='datePublished'>
             2019-09-19 23:50:25 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="6" data-topic="6015"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="http://community.axoloti.com/user_avatar/community.axoloti.com/weasel79/40/6141_1.png" class="avatar">weasel79:</div>
<blockquote><p>something like that would go in the sending object, top right in hugos midi script, on Axo1, to forward all USB or other incoming midi data to serial TX. then on Axo2 you have the top left script which just forwards all RX data to internal midi so on Axo2 you can then use all regular midi objects.<br>you need to kind of merge hugos script with a midi thru script. edit both the scrip and the embedded object midi code. i</p></blockquote></aside>

<p>Yes I already thoght something like this. It's just that these two layers, the object and the script part confuse me and I cannot use the copy and pasting that I usually do.</p>

<aside class="quote" data-post="6" data-topic="6015"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="http://community.axoloti.com/user_avatar/community.axoloti.com/weasel79/40/6141_1.png" class="avatar">weasel79:</div>
<blockquote><p>if you wanna alter/add midi clock on Axo1 to send to Axo2, you need some more ptaching. maybe there are clock-to-internal-midi objects? look into interal midi. cause anything you send to that egts caught by hugos sender object.</p></blockquote></aside>

<p>the thing is depending on the situation axo 1 generates a clock, or when there is one coming externally it uses the external clock and sends it to axo 2. <br>What I did now as work around is just send 24ppq and 4ppq as one bar counter<br><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/3877e285330cb2c84db53dd82a6d7f3b1efe26ab" href="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/2X/3/3877e285330cb2c84db53dd82a6d7f3b1efe26ab.png" class="lightbox" title="Bildschirmfoto 2019-09-20 um 01.55.21.png"><img src="http://community.axoloti.com/uploads/default/optimized/2X/3/3877e285330cb2c84db53dd82a6d7f3b1efe26ab_1_690x314.png" width="690" height="314"><div class="meta">
<span class="filename">Bildschirmfoto 2019-09-20 um 01.55.21.png</span><span class="informations">948x432 39.7 KB</span><span class="expand"></span>
</div></a></div><br>But I would really prefer to send normal midi clock.</p>

<aside class="quote" data-post="6" data-topic="6015"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="http://community.axoloti.com/user_avatar/community.axoloti.com/weasel79/40/6141_1.png" class="avatar">weasel79:</div>
<blockquote><p>if you have a day or two i can send the objects i made last week.</p></blockquote></aside>

<p> <br>I would be very happy to see what you have done. Maybe it would make me understand this script part a bit more</p>

<p>Edit: Oh very nice I apreciate that <img src="http://community.axoloti.com/images/emoji/twitter/pray.png?v=5" title=":pray:" class="emoji" alt=":pray:"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Going from Midi Out Pin to PA2 via Hugo&#39;s script'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Blindsmyth.html'><b itemprop='author'>Blindsmyth</b></a>
           
           <time datetime='2019-10-01T20:13:12Z' itemprop='datePublished'>
             2019-10-01 20:13:12 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hey there, </p>

<p>I don't really get midi through to work. Copy pasted the code you send me but there is no midi being forwarded.</p>

<p><a class="attachment" href="../../uploads/default/original/2X/e/midi%20thru.axp"> midi thru.axp</a> (9.9 KB)</p>

<p>As for the midi clock I just need something like something like this in the form of the script.</p>

<p><img src="http://community.axoloti.com/uploads/default/original/2X/8/8509fb452cd3fe50fc67427fb22cb38dbeaf1eec.png" width="344" height="332"></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Going from Midi Out Pin to PA2 via Hugo&#39;s script'>
      <hr>
  </div>






    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/going-from-midi-out-pin-to-pa2-via-hugos-script/6015 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 16 Jul 2023 18:19:03 GMT -->
</html>
