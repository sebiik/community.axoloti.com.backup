<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/loading-binary-data-into-sdram/1995?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jul 2023 04:19:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Loading Binary Data Into SDRAM - AxoObject coding - Axoloti Community</title>
    <meta name="description" content="This is probably really simple, but I&amp;#39;m failing dismally in my attempts so far. 

I want to load a 16kb array of 8-bit ints into a table in SDRAM. I don&amp;#39;t want to load it from a file, as I want to roll the data into a cu&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="19954658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://sebiik.github.io/community.axoloti.com.backup","potentialAction":{"@type":"SearchAction","target":"https://sebiik.github.io/community.axoloti.com.backup/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Loading Binary Data Into SDRAM&#39;" href="1995.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:image" content="https://sebiik.github.io/community.axoloti.com.backup/uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png" />
<meta property="og:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/loading-binary-data-into-sdram/1995?page=2" />
<meta name="twitter:url" content="https://sebiik.github.io/community.axoloti.com.backup/t/loading-binary-data-into-sdram/1995?page=2" />
<meta property="og:title" content="Loading Binary Data Into SDRAM" />
<meta name="twitter:title" content="Loading Binary Data Into SDRAM" />
<meta property="og:description" content="just checked, for my own interest 🙂    goes via fbuff , which is a 256 byte  buffer in sram2. this is of course reused across objects. (so may have to be careful if multiple loads being done in separate threads!?) ... also used by pconnection.   (streamer has a different implementation I think, but not checked)" />
<meta name="twitter:description" content="just checked, for my own interest 🙂    goes via fbuff , which is a 256 byte  buffer in sram2. this is of course reused across objects. (so may have to be careful if multiple loads being done in separate threads!?) ... also used by pconnection.   (streamer has a different implementation I think, but not checked)" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="1 ❤" />

      <link rel="prev" href="1995.html">

  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="1995.html">Loading Binary Data Into SDRAM</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/axoobject-code.html" itemprop="url">
        <span itemprop="title">AxoObject coding</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-07-14T12:15:38Z' itemprop='datePublished'>
             2016-07-14 12:15:38 UTC
           </time>
        </span>
        <span itemprop='position'>#22</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>just checked, for my own interest <img src="../../images/emoji/emoji_one/slight_smile5e1f.png?v=2" title=":slight_smile:" class="emoji" alt=":slight_smile:"> </p>

<p>goes via fbuff , which is a 256 byte  buffer in sram2. this is of course reused across objects.<br>(so may have to be careful if multiple loads being done in separate threads!?) ... also used by pconnection.</p>

<p>(streamer has a different implementation I think, but not checked)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-07-14T12:17:25Z' itemprop='datePublished'>
             2016-07-14 12:17:25 UTC
           </time>
        </span>
        <span itemprop='position'>#23</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="20" data-topic="1995"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/b9e5f3/40.html" class="avatar">toneburst:</div>
<blockquote><p>Hang on though, if there's 256kb of SRAM, and my patch contains just the one alloc 8b sdram object, why is it overflowing the SDRAM trying to allocate 16kb?</p></blockquote></aside>

<p>Sram overflowing or sdram overflowing?<br>Literal assignment code like<br><code>array[0] = 0x29;</code><br>expands to multiple bytes of binary executable code.</p>

<aside class="quote" data-post="20" data-topic="1995"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/b9e5f3/40.html" class="avatar">toneburst:</div>
<blockquote><p>Is there a hard limit on the amount of SRAM a single object can use?</p></blockquote></aside>

<p>There is no per-object limit.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-07-14T12:21:01Z' itemprop='datePublished'>
             2016-07-14 12:21:01 UTC
           </time>
        </span>
        <span itemprop='position'>#24</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Oops, I meant overflowing SRAM (see error message above).</p>

<p>Shouldn't the extra SRAM used by the assignment operation be freed up after each assignment, though?</p>

<p>If not, I guess that would explain where all the SRAM went..</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:2'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-07-14T12:37:54Z' itemprop='datePublished'>
             2016-07-14 12:37:54 UTC
           </time>
        </span>
        <span itemprop='position'>#25</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Are there any objects that actually use explicit C memory-assignment/garbage-collection commands?</p>

<p>I must say I was a little surprised not to see any of that in any of the objects I've poked around inside (bear in mind that my very basic C knowledge dates back to the end of the last century..).</p>

<p>Maybe all that stuff is handled behind the scenes.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-07-14T12:46:59Z' itemprop='datePublished'>
             2016-07-14 12:46:59 UTC
           </time>
        </span>
        <span itemprop='position'>#26</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="24" data-topic="1995"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/b9e5f3/40.html" class="avatar">toneburst:</div>
<blockquote><p>Shouldn't the extra SRAM used by the assignment operation be freed up after each assignment, though?</p></blockquote></aside>

<p>You've got me thinking here if this is possible. A memory segment containing initialization code could be re-used for other things, <strong>but</strong> it must be certain that those other things are not accessed by the initialization code. So how are those other things initialized? A "2nd stage" initializer for blank memory only? Potentially a source of confusion and weird errors...</p>

<aside class="quote" data-post="25" data-topic="1995"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/b9e5f3/40.html" class="avatar">toneburst:</div>
<blockquote><p>Are there any objects that actually use explicit C memory-assignment/garbage-collection commands?</p></blockquote></aside>

<p>Patches use static memory. Garbage collection is not real time. Dynamic memory allocation can cause memory fragmentation, and overflow during runtime. With static memory, the compiler knows before running the patch.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-07-14T14:51:29Z' itemprop='datePublished'>
             2016-07-14 14:51:29 UTC
           </time>
        </span>
        <span itemprop='position'>#27</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="26" data-topic="1995"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/johannes/40/8_1.png" class="avatar">johannes:</div>
<blockquote><p>Patches use static memory. Garbage collection is not real time. Dynamic memory allocation can cause memory fragmentation, and overflow during runtime. With static memory, the compiler knows before running the patch.</p></blockquote></aside>

<p>I see...........</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-07-14T15:16:27Z' itemprop='datePublished'>
             2016-07-14 15:16:27 UTC
           </time>
        </span>
        <span itemprop='position'>#28</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>It's just occurred to me:</p>

<p>Given that simply assigning a value to an array item is about as simple an operation as you can do, isn't any Init routine in the table/alloc object that attempts to fill a largish array in SDRAM going to hit a similar issue (ie running out of SRAM before it manages to fill up the array)?</p>

<p>I was only trying to fill 16kb, the object size attribute allows for the creation of much larger arrays than that.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/johannes.html'><b itemprop='author'>johannes</b></a>
           
           <time datetime='2016-07-14T15:22:32Z' itemprop='datePublished'>
             2016-07-14 15:22:32 UTC
           </time>
        </span>
        <span itemprop='position'>#29</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>When the initial values are <strong>computed</strong> in a loop, the resulting binary code size can be pretty small.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-07-14T15:26:29Z' itemprop='datePublished'>
             2016-07-14 15:26:29 UTC
           </time>
        </span>
        <span itemprop='position'>#30</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="29" data-topic="1995" data-full="true"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/johannes/40/8_1.png" class="avatar">johannes:</div>
<blockquote><p>When the initial values are computed in a loop, the resulting binary code size can be pretty small.</p></blockquote></aside>

<p>Interesting. That seems counter-intuitive. Is it because 'working memory' (i.e. memory used to perform the computation) is reused more efficiently, in this case?</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/rvense.html'><b itemprop='author'>rvense</b></a>
           
           <time datetime='2016-07-14T15:31:57Z' itemprop='datePublished'>
             2016-07-14 15:31:57 UTC
           </time>
        </span>
        <span itemprop='position'>#31</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yeah, if you're doing it in a loop then all the variables inside the loop are only allocated once. Say you're computing a stupidly high-resolution sawtooth wave:</p>

<p>int wave[] = .... // array in sdram</p>

<p>for (int i = 0; i &lt; 65535; i++) {<br>  wave[i] = i;<br>}</p>

<p>That's only going to use one word of working memory for the counter, but it'll fill a 64k look-up table.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-07-14T18:04:05Z' itemprop='datePublished'>
             2016-07-14 18:04:05 UTC
           </time>
        </span>
        <span itemprop='position'>#32</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I see. But if I do</p>

<p>array[0] = 0x5a;</p>

<p>Would I be right in thinking that 8 bits of SRAM are required to allocate that value to SDRAM, plus some extra RAM required to do the assignment itself, and that memory is never reclaimed?</p>

<p>Just getting things clear in my head..</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/rvense.html'><b itemprop='author'>rvense</b></a>
           
           <time datetime='2016-07-14T18:42:51Z' itemprop='datePublished'>
             2016-07-14 18:42:51 UTC
           </time>
        </span>
        <span itemprop='position'>#33</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>If you just put a long line of assignments like that, it's going to get put into the actual executable code as constants. This is stored in Flash/ROM, but the patch might get loaded into SRAM on start up, I'm not sure.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-07-14T18:44:31Z' itemprop='datePublished'>
             2016-07-14 18:44:31 UTC
           </time>
        </span>
        <span itemprop='position'>#34</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>It looks like that's what's happening, because it's the SRAM that's running out.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2016-07-14T18:55:47Z' itemprop='datePublished'>
             2016-07-14 18:55:47 UTC
           </time>
        </span>
        <span itemprop='position'>#35</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>patch code is loaded into SRAM, only firmware into flash. <br>(limited flash cycles and size/length of time it takes to flash)</p>

<p>using explicitly assignment I expect be less efficient than using a static array of data.<br>the former creates lots of instructions, the later simply calls an initialiser when the patch is loaded. <br>(both use sram, as both .text and .rodata go into sram ... see ramlink.ld)</p>

<p>if this was a normal use case, I wonder if  you would move .rodata to sdram....<br>(I suspect there would be performance issues with this move)</p>

<p>EDIT: <br>in your example, try to make your array a constant... see if it uses less memory.<br>(I'm wondering if your getting 2 copies, one in .rodata and one in .bss, both for a patch reside in sram,<br>it may not be happening as it may be optimised out by the compiler when it sees no writes, but worth a try to save sram)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/toneburst.html'><b itemprop='author'>toneburst</b></a>
           
           <time datetime='2016-07-17T15:14:25Z' itemprop='datePublished'>
             2016-07-17 15:14:25 UTC
           </time>
        </span>
        <span itemprop='position'>#36</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I'll give that a go. I'm going to focus on loading the data from file first, now, though.</p>

<p>a|x</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Loading Binary Data Into SDRAM'>
      <hr>
  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement'>
      <span itemprop='url'><a rel="prev" itemprop="name" href="1995.html">← previous page</a></span>
  </div>





    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/loading-binary-data-into-sdram/1995?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jul 2023 04:19:36 GMT -->
</html>
