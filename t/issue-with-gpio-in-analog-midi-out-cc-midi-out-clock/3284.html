<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from community.axoloti.com/t/issue-with-gpio-in-analog-midi-out-cc-midi-out-clock/3284 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:20:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock - Software - Axoloti Community</title>
    <meta name="description" content="Hello :slight_smile:  

I am this morning experimenting with external clock and at the same time use the modular thing add on board to control some things. But I am experiencing some odd behaviour when using the midi/out&amp;hellip;">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta3 - https://github.com/discourse/discourse version 13f3de4bf673802eb8ec595d36587b4524773209">
<link rel="icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<link rel="icon" sizes="144x144" href="../../uploads/default/original/1X/ffed196003990f0e5c2a0f8227fc977345cd68be.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="3284.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://community.axoloti.com","potentialAction":{"@type":"SearchAction","target":"http://community.axoloti.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Axoloti Community Search">

        <link href="../../stylesheets/desktop_d93a33ca8617326fe353f80e6ab865188244d48c8e0b.css?__ws=community.axoloti.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56017691-4', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock&#39;" href="3284.rss" />
  <meta property="og:site_name" content="Axoloti Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://community.axoloti.com/uploads/default/optimized/2X/7/7cde35d848115ec4a3c51bad874fd0e2ec73bcba_1_690x439.png" />
<meta property="og:image" content="http://community.axoloti.com/uploads/default/optimized/2X/7/7cde35d848115ec4a3c51bad874fd0e2ec73bcba_1_690x439.png" />
<meta property="og:url" content="http://community.axoloti.com/t/issue-with-gpio-in-analog-midi-out-cc-midi-out-clock/3284" />
<meta name="twitter:url" content="http://community.axoloti.com/t/issue-with-gpio-in-analog-midi-out-cc-midi-out-clock/3284" />
<meta property="og:title" content="Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock" />
<meta name="twitter:title" content="Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock" />
<meta property="og:description" content="Hello ðŸ™‚    I am this morning experimenting with external clock and at the same time use the modular thing add on board to control some things. But I am experiencing some odd behaviour when using the midi/out/clock, midi/out/cc and the gpio/in/analog in same patch. Like this:    [image]  I know this sounds really weird.. But when I connect the gpio/in/analog to the midi/out/cc in the patch... Axolotis clock about drops to half tempo...... + it starts to sound very very bad and super ..." />
<meta name="twitter:description" content="Hello ðŸ™‚    I am this morning experimenting with external clock and at the same time use the modular thing add on board to control some things. But I am experiencing some odd behaviour when using the midi/out/clock, midi/out/cc and the gpio/in/analog in same patch. Like this:    [image]  I know this sounds really weird.. But when I connect the gpio/in/analog to the midi/out/cc in the patch... Axolotis clock about drops to half tempo...... + it starts to sound very very bad and super ..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins ðŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="2 â¤" />


  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html"><img src="../../uploads/default/original/1X/b22e6e9ef608f1e17a1de19b733d043beff77f05.png" alt="Axoloti Community" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="3284.html">Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/software.html" itemprop="url">
        <span itemprop="title">Software</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jaffasplaffa.html'><b itemprop='author'>jaffasplaffa</b></a>
           
           <time datetime='2017-05-04T08:02:44Z' itemprop='datePublished'>
             2017-05-04 08:02:44 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hello <img src="../../images/emoji/emoji_one/slight_smile30f4.png?v=3" title=":slight_smile:" class="emoji" alt=":slight_smile:"> </p>

<p>I am this morning experimenting with external clock and at the same time use the modular thing add on board to control some things. But I am experiencing some odd behaviour when using the midi/out/clock, midi/out/cc and the gpio/in/analog in same patch. Like this:</p>

<p><div class="lightbox-wrapper"><a data-download-href="//community.axoloti.com/uploads/default/7cde35d848115ec4a3c51bad874fd0e2ec73bcba" href="../../uploads/default/original/2X/7/7cde35d848115ec4a3c51bad874fd0e2ec73bcba.png" class="lightbox" title="clock weird.png"><img src="../../uploads/default/optimized/2X/7/7cde35d848115ec4a3c51bad874fd0e2ec73bcba_1_690x439.png" width="690" height="439"><div class="meta">
<span class="filename">clock weird.png</span><span class="informations">900x573 42 KB</span><span class="expand"></span>
</div></a></div></p>

<p>I know this sounds really weird.. But when I connect the gpio/in/analog to the midi/out/cc in the patch... Axolotis clock about drops to half tempo...... + it starts to sound very very bad and super digital. As soon as i disconnect it, it sounds good again and tempo is normal again</p>

<p><strong>Could anyone try this patch and see if you get the same result? I</strong> am thinking it might be my modular thing add on board that is not the best solder job. But I didnt really think it could cause these kinds of issue.</p>

<p><a class="attachment" href="../../uploads/default/original/2X/0/Tempo%20weird.axp">Tempo weird.axp</a> (5.1 KB)</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Blindsmyth.html'><b itemprop='author'>Blindsmyth</b></a>
           
           <time datetime='2017-05-04T11:25:57Z' itemprop='datePublished'>
             2017-05-04 11:25:57 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hey Jaffa tested your patch, has the same issues, tempo drop and digital harshness! Very weird!</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/keyman.html'><b itemprop='author'>keyman</b></a>
           
           <time datetime='2017-05-04T11:59:35Z' itemprop='datePublished'>
             2017-05-04 11:59:35 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Also If you change midi/out/cc from din to other output... din related?</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jaffasplaffa.html'><b itemprop='author'>jaffasplaffa</b></a>
           
           <time datetime='2017-05-04T12:25:27Z' itemprop='datePublished'>
             2017-05-04 12:25:27 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="../../users/blindsmyth.html">@Blindsmyth</a> </p>

<p>Thanks for trying it out. I cant find any logical explanation for this. </p>

<aside class="quote" data-post="3" data-topic="3284" data-full="true"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/keyman/40/49_1.png" class="avatar">keyman:</div>
<blockquote><p>Also If you change midi/out/cc from din to other output... din related?</p></blockquote></aside>

<p><a class="mention" href="../../users/keyman.html">@keyman</a></p>

<p>Just tried changing to USB port. It doesnt happen there., so it might be related to the din only. Weird thing is when I disconnect the gpio/in/analog, but still keeps it in the patch, it doesnt happen. Reconnect it again to the midi cc out, it will happen again.</p>

<p>Anyway I think <a class="mention" href="../../users/thetechnobear.html">@thetechnobear</a> and <a class="mention" href="../../users/johannes.html">@johannes</a> opinions would be nice on this.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/Blindsmyth.html'><b itemprop='author'>Blindsmyth</b></a>
           
           <time datetime='2017-05-04T12:30:12Z' itemprop='datePublished'>
             2017-05-04 12:30:12 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>changing logic change by change speedlim seems to solve it. propably the jitter of the gpio was to much for axoloti's midi engine.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jaffasplaffa.html'><b itemprop='author'>jaffasplaffa</b></a>
           
           <time datetime='2017-05-04T12:32:49Z' itemprop='datePublished'>
             2017-05-04 12:32:49 UTC
           </time>
        </span>
        <span itemprop='position'>#6</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="5" data-topic="3284" data-full="true"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../letter_avatar_proxy/v2/letter/b/2acd7d/40.png" class="avatar">Blindsmyth:</div>
<blockquote><p>changing logic change by change speedlim seems to solve it. propably the jitter of the gpio was to much for axoloti's midi engine</p></blockquote></aside>

<p>Just tried that and it WORKS... Super <img src="../../images/emoji/emoji_one/slight_smile30f4.png?v=3" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>

<p>Anyway, I still think it is a bit strange that a gpio with jitter can affect the whole system to sound "broken! and cause the midi dclock to become unstable</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2017-05-04T15:31:43Z' itemprop='datePublished'>
             2017-05-04 15:31:43 UTC
           </time>
        </span>
        <span itemprop='position'>#7</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="6" data-topic="3284"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../letter_avatar_proxy/v2/letter/j/7ea924/40.png" class="avatar">jaffasplaffa:</div>
<blockquote><p>Anyway, I still think it is a bit strange that a gpio with jitter can affect the whole system to sound "broken! and cause the midi dclock to become unstable</p></blockquote></aside>

<p>Id need to double check, but I suspect, the midi din output is not threaded (unlike USB device midi which is)... this means the IO is being done in the audio thread, which is a bad idea as will lead to audio breakups, if you push it too much.</p>

<p>watching the amount of midi messages goes out is always a good idea, even with the threading of usb midi, this would 'break' since it has a limited ring buffer, which will overflow if too many messages are sent.</p>

<p>the real cause, as you have seen, is analog input will have jitter, how much depends on many things, but its pretty common to be use a filter to smooth it out.</p>

<p>in your scenario, id have probably converted the gpio to an int in range 0...127. then used change on that, since you only need to trig a CC when the resulting cc value changes NOT the float (which is much more accurate)... this is generally true of change, quantise first, then use change.<br>you'll probably still need to filter (or similar) though, since if you get the pot in just the right place, it could jitter around a threshold value, but obviously is much less likely.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/jaffasplaffa.html'><b itemprop='author'>jaffasplaffa</b></a>
           
           <time datetime='2017-05-06T23:02:28Z' itemprop='datePublished'>
             2017-05-06 23:02:28 UTC
           </time>
        </span>
        <span itemprop='position'>#8</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="7" data-topic="3284"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/community.axoloti.com/thetechnobear/40/6_1.html" class="avatar">thetechnobear:</div>
<blockquote><p>the real cause, as you have seen, is analog input will have jitter, how much depends on many things, but its pretty common to be use a filter to smooth it out.</p></blockquote></aside>

<p>blindsmyth suggestion did work, using change speedlim . I put it in a controller object and have it live in every patch and for now it doesnt seem to affect anything.......</p>

<p>Will definatly try the scaling to 0-127.. I dont rememebr right now if it is midi/in or midi/out that has an integer version. Ill check up on that.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../u/thetechnobear.html'><b itemprop='author'>thetechnobear</b></a>
           
           <time datetime='2017-05-07T10:28:23Z' itemprop='datePublished'>
             2017-05-07 10:28:23 UTC
           </time>
        </span>
        <span itemprop='position'>#9</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="8" data-topic="3284"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../letter_avatar_proxy/v2/letter/j/7ea924/40.png" class="avatar">jaffasplaffa:</div>
<blockquote><p>blindsmyth suggestion did work, using change speedlim .</p></blockquote></aside>

<p>of course it works... it just limits sending CC messages to the time you specify.<br>the issue is, because the float value is constantly changing, it will still be sending a stream of CC messages, even though the cc value is not altered.<br>e.g. imagine you set the throttle time to 1 second, and that the gpio is jittering around, 0.4999005 and 0.500005.<br>what will happen is you will be sending CC of value 64 every second, because the float value is jittering around 0.5, not enough to kill the system, but still a waste of resources/io</p>

<p>now if you quantise to 128, ( using a simple shift followed by a bit mask) , the result will constantly be 64 - so the change never triggers, as the (quantised) value has not altered. so no CC are sent saving cpu and io.</p>

<p>it doesn't actually matter if midi/out/cc supports integer of not! you can use your calculation for the trig condition... regardless of what is sent to the value.<br>that is why the trig is separate it allows the patcher to decide on the criteria of when to send updates - as there are a number of potential strategies depending on what is required.</p>

<p>anyway, this is why when working with midi, id always recommend monitoring the input/output when testing , either internally on Axoloti (midi/utils/monitor) or even better using a monitor app. </p>

<p>tip: if you have 2 Axoloti you can use one as a midi monitoring device ... use my thru object, and put the test axo in between patch tested, and device... if the midi light blinks like fury, or when you don't expect, then you know you have to take a closer look at the messages sent</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Issue with gpio/in/analog &amp; midi/out/cc &amp; midi/out/clock'>
      <hr>
  </div>






    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../index.html'>Home</a>
        <a href="../../categories.html">Categories</a>
        <a href="../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../tos.html">Terms of Service</a>
        <a href="../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from community.axoloti.com/t/issue-with-gpio-in-analog-midi-out-cc-midi-out-clock/3284 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jul 2023 16:20:45 GMT -->
</html>
